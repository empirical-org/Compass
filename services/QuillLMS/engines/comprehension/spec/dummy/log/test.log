  [1m[36mActiveRecord::SchemaMigration Load (4.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36m (179.2ms)[0m  [1mDROP DATABASE IF EXISTS "dummy_test"[0m
  [1m[35m (410.9ms)[0m  CREATE DATABASE "dummy_test" ENCODING = 'unicode'
  [1m[36mSQL (1.9ms)[0m  [1mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (11.0ms)[0m  CREATE TABLE "activities" ("id" serial primary key, "name" character varying, "activity_classification_id" integer, "flags" character varying[] DEFAULT '{}' NOT NULL) 
  [1m[36m (5.8ms)[0m  [1mCREATE TABLE "activity_classifications" ("id" serial primary key, "key" character varying) [0m
  [1m[35m (5.0ms)[0m  CREATE TABLE "comprehension_activities" ("id" serial primary key, "title" character varying(100), "parent_activity_id" integer, "target_level" smallint, "scored_level" character varying(100), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "name" character varying) 
  [1m[36m (1.5ms)[0m  [1mCREATE  INDEX  "index_comprehension_activities_on_parent_activity_id" ON "comprehension_activities" USING btree ("parent_activity_id")[0m
  [1m[35m (5.0ms)[0m  CREATE TABLE "comprehension_automl_models" ("id" serial primary key, "automl_model_id" character varying NOT NULL, "name" character varying NOT NULL, "labels" character varying[] DEFAULT '{}', "prompt_id" integer, "state" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (4.4ms)[0m  [1mCREATE TABLE "comprehension_feedbacks" ("id" serial primary key, "rule_id" integer NOT NULL, "text" character varying NOT NULL, "description" character varying, "order" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.9ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_feedbacks_on_rule_id_and_order" ON "comprehension_feedbacks" USING btree ("rule_id", "order")
  [1m[36m (3.9ms)[0m  [1mCREATE TABLE "comprehension_highlights" ("id" serial primary key, "feedback_id" integer NOT NULL, "text" character varying NOT NULL, "highlight_type" character varying NOT NULL, "starting_index" integer, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (4.6ms)[0m  CREATE TABLE "comprehension_labels" ("id" serial primary key, "name" character varying NOT NULL, "rule_id" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (3.6ms)[0m  [1mCREATE TABLE "comprehension_passages" ("id" serial primary key, "activity_id" integer, "text" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "image_link" character varying, "image_alt_text" character varying DEFAULT '') [0m
  [1m[35m (1.7ms)[0m  CREATE  INDEX  "index_comprehension_passages_on_activity_id" ON "comprehension_passages" USING btree ("activity_id")
  [1m[36m (5.0ms)[0m  [1mCREATE TABLE "comprehension_plagiarism_texts" ("id" serial primary key, "rule_id" integer NOT NULL, "text" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.6ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_plagiarism_texts_on_rule_id" ON "comprehension_plagiarism_texts" USING btree ("rule_id")
  [1m[36m (4.9ms)[0m  [1mCREATE TABLE "comprehension_prompts" ("id" serial primary key, "activity_id" integer, "max_attempts" smallint, "conjunction" character varying(20), "text" character varying, "max_attempts_feedback" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.4ms)[0m  CREATE  INDEX  "index_comprehension_prompts_on_activity_id" ON "comprehension_prompts" USING btree ("activity_id")
  [1m[36m (3.5ms)[0m  [1mCREATE TABLE "comprehension_prompts_rules" ("id" serial primary key, "prompt_id" integer NOT NULL, "rule_id" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.2ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_prompts_rules_on_prompt_id_and_rule_id" ON "comprehension_prompts_rules" USING btree ("prompt_id", "rule_id")
  [1m[36m (1.2ms)[0m  [1mCREATE  INDEX  "index_comprehension_prompts_rules_on_rule_id" ON "comprehension_prompts_rules" USING btree ("rule_id")[0m
  [1m[35m (5.0ms)[0m  CREATE TABLE "comprehension_regex_rules" ("id" serial primary key, "regex_text" character varying(200) NOT NULL, "case_sensitive" boolean NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "rule_id" integer, "sequence_type" text DEFAULT 'incorrect' NOT NULL) 
  [1m[36m (1.4ms)[0m  [1mCREATE  INDEX  "index_comprehension_regex_rules_on_rule_id" ON "comprehension_regex_rules" USING btree ("rule_id")[0m
  [1m[35m (4.6ms)[0m  CREATE TABLE "comprehension_rules" ("id" serial primary key, "uid" character varying NOT NULL, "name" character varying NOT NULL, "note" character varying, "universal" boolean NOT NULL, "rule_type" character varying NOT NULL, "optimal" boolean NOT NULL, "suborder" text, "concept_uid" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "state" character varying NOT NULL) 
  [1m[36m (1.6ms)[0m  [1mCREATE UNIQUE INDEX  "index_comprehension_rules_on_uid" ON "comprehension_rules" USING btree ("uid")[0m
  [1m[35m (4.0ms)[0m  CREATE TABLE "comprehension_turking_round_activity_sessions" ("id" serial primary key, "turking_round_id" integer, "activity_session_uid" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.7ms)[0m  [1mCREATE UNIQUE INDEX  "comprehension_turking_sessions_activity_uid" ON "comprehension_turking_round_activity_sessions" USING btree ("activity_session_uid")[0m
  [1m[35m (1.3ms)[0m  CREATE  INDEX  "comprehension_turking_sessions_turking_id" ON "comprehension_turking_round_activity_sessions" USING btree ("turking_round_id")
  [1m[36m (2.9ms)[0m  [1mCREATE TABLE "comprehension_turking_rounds" ("id" serial primary key, "activity_id" integer, "uuid" uuid, "expires_at" timestamp, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.5ms)[0m  CREATE  INDEX  "index_comprehension_turking_rounds_on_activity_id" ON "comprehension_turking_rounds" USING btree ("activity_id")
  [1m[36m (1.5ms)[0m  [1mCREATE UNIQUE INDEX  "index_comprehension_turking_rounds_on_uuid" ON "comprehension_turking_rounds" USING btree ("uuid")[0m
  [1m[35m (2.6ms)[0m  ALTER TABLE "comprehension_automl_models" ADD CONSTRAINT "fk_rails_35c32f80fc"
FOREIGN KEY ("prompt_id")
  REFERENCES "comprehension_prompts" ("id")

  [1m[36m (2.4ms)[0m  [1mALTER TABLE "comprehension_highlights" ADD CONSTRAINT "fk_rails_9d58aa0a3c"
FOREIGN KEY ("feedback_id")
  REFERENCES "comprehension_feedbacks" ("id")
 ON DELETE CASCADE[0m
  [1m[35m (2.1ms)[0m  ALTER TABLE "comprehension_labels" ADD CONSTRAINT "fk_rails_6112e49a74"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE
  [1m[36m (1.7ms)[0m  [1mALTER TABLE "comprehension_plagiarism_texts" ADD CONSTRAINT "fk_rails_bcd03e8630"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE[0m
  [1m[35m (1.5ms)[0m  ALTER TABLE "comprehension_regex_rules" ADD CONSTRAINT "fk_rails_dd1bb7c35b"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE
  [1m[36m (2.1ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL) [0m
  [1m[35m (1.4ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM "schema_migrations"[0m
  [1m[35m (0.6ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20210429144611')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20210317200004')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20210317200005')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20210317200006')[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT "schema_migrations".* FROM "schema_migrations"
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to CreateComprehensionActivities (20200605133641)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (4.0ms)[0m  [1mCREATE TABLE "comprehension_activities" ("id" serial primary key, "title" character varying(100), "parent_activity_id" integer, "target_level" smallint, "scored_level" character varying(100), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (138.2ms)[0m  [1mDROP DATABASE IF EXISTS "dummy_test"[0m
  [1m[35m (274.7ms)[0m  CREATE DATABASE "dummy_test" ENCODING = 'unicode'
  [1m[36mSQL (0.6ms)[0m  [1mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (8.4ms)[0m  CREATE TABLE "activities" ("id" serial primary key, "name" character varying, "activity_classification_id" integer, "flags" character varying[] DEFAULT '{}' NOT NULL) 
  [1m[36m (5.5ms)[0m  [1mCREATE TABLE "activity_classifications" ("id" serial primary key, "key" character varying) [0m
  [1m[35m (5.2ms)[0m  CREATE TABLE "comprehension_activities" ("id" serial primary key, "title" character varying(100), "parent_activity_id" integer, "target_level" smallint, "scored_level" character varying(100), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "name" character varying) 
  [1m[36m (1.7ms)[0m  [1mCREATE  INDEX  "index_comprehension_activities_on_parent_activity_id" ON "comprehension_activities" USING btree ("parent_activity_id")[0m
  [1m[35m (6.1ms)[0m  CREATE TABLE "comprehension_automl_models" ("id" serial primary key, "automl_model_id" character varying NOT NULL, "name" character varying NOT NULL, "labels" character varying[] DEFAULT '{}', "prompt_id" integer, "state" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (5.4ms)[0m  [1mCREATE TABLE "comprehension_feedbacks" ("id" serial primary key, "rule_id" integer NOT NULL, "text" character varying NOT NULL, "description" character varying, "order" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.8ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_feedbacks_on_rule_id_and_order" ON "comprehension_feedbacks" USING btree ("rule_id", "order")
  [1m[36m (5.1ms)[0m  [1mCREATE TABLE "comprehension_highlights" ("id" serial primary key, "feedback_id" integer NOT NULL, "text" character varying NOT NULL, "highlight_type" character varying NOT NULL, "starting_index" integer, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (5.1ms)[0m  CREATE TABLE "comprehension_labels" ("id" serial primary key, "name" character varying NOT NULL, "rule_id" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (6.0ms)[0m  [1mCREATE TABLE "comprehension_passages" ("id" serial primary key, "activity_id" integer, "text" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "image_link" character varying, "image_alt_text" character varying DEFAULT '') [0m
  [1m[35m (1.5ms)[0m  CREATE  INDEX  "index_comprehension_passages_on_activity_id" ON "comprehension_passages" USING btree ("activity_id")
  [1m[36m (4.2ms)[0m  [1mCREATE TABLE "comprehension_plagiarism_texts" ("id" serial primary key, "rule_id" integer NOT NULL, "text" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.4ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_plagiarism_texts_on_rule_id" ON "comprehension_plagiarism_texts" USING btree ("rule_id")
  [1m[36m (5.2ms)[0m  [1mCREATE TABLE "comprehension_prompts" ("id" serial primary key, "activity_id" integer, "max_attempts" smallint, "conjunction" character varying(20), "text" character varying, "max_attempts_feedback" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.6ms)[0m  CREATE  INDEX  "index_comprehension_prompts_on_activity_id" ON "comprehension_prompts" USING btree ("activity_id")
  [1m[36m (2.9ms)[0m  [1mCREATE TABLE "comprehension_prompts_rules" ("id" serial primary key, "prompt_id" integer NOT NULL, "rule_id" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.7ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_prompts_rules_on_prompt_id_and_rule_id" ON "comprehension_prompts_rules" USING btree ("prompt_id", "rule_id")
  [1m[36m (1.5ms)[0m  [1mCREATE  INDEX  "index_comprehension_prompts_rules_on_rule_id" ON "comprehension_prompts_rules" USING btree ("rule_id")[0m
  [1m[35m (4.8ms)[0m  CREATE TABLE "comprehension_regex_rules" ("id" serial primary key, "regex_text" character varying(200) NOT NULL, "case_sensitive" boolean NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "rule_id" integer, "sequence_type" text DEFAULT 'incorrect' NOT NULL) 
  [1m[36m (1.3ms)[0m  [1mCREATE  INDEX  "index_comprehension_regex_rules_on_rule_id" ON "comprehension_regex_rules" USING btree ("rule_id")[0m
  [1m[35m (4.6ms)[0m  CREATE TABLE "comprehension_rules" ("id" serial primary key, "uid" character varying NOT NULL, "name" character varying NOT NULL, "note" character varying, "universal" boolean NOT NULL, "rule_type" character varying NOT NULL, "optimal" boolean NOT NULL, "suborder" integer, "concept_uid" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL, "state" character varying NOT NULL) 
  [1m[36m (2.0ms)[0m  [1mCREATE UNIQUE INDEX  "index_comprehension_rules_on_uid" ON "comprehension_rules" USING btree ("uid")[0m
  [1m[35m (4.7ms)[0m  CREATE TABLE "comprehension_turking_round_activity_sessions" ("id" serial primary key, "turking_round_id" integer, "activity_session_uid" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.4ms)[0m  [1mCREATE UNIQUE INDEX  "comprehension_turking_sessions_activity_uid" ON "comprehension_turking_round_activity_sessions" USING btree ("activity_session_uid")[0m
  [1m[35m (1.6ms)[0m  CREATE  INDEX  "comprehension_turking_sessions_turking_id" ON "comprehension_turking_round_activity_sessions" USING btree ("turking_round_id")
  [1m[36m (3.7ms)[0m  [1mCREATE TABLE "comprehension_turking_rounds" ("id" serial primary key, "activity_id" integer, "uuid" uuid, "expires_at" timestamp, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.4ms)[0m  CREATE  INDEX  "index_comprehension_turking_rounds_on_activity_id" ON "comprehension_turking_rounds" USING btree ("activity_id")
  [1m[36m (1.6ms)[0m  [1mCREATE UNIQUE INDEX  "index_comprehension_turking_rounds_on_uuid" ON "comprehension_turking_rounds" USING btree ("uuid")[0m
  [1m[35m (2.9ms)[0m  ALTER TABLE "comprehension_automl_models" ADD CONSTRAINT "fk_rails_35c32f80fc"
FOREIGN KEY ("prompt_id")
  REFERENCES "comprehension_prompts" ("id")

  [1m[36m (1.8ms)[0m  [1mALTER TABLE "comprehension_highlights" ADD CONSTRAINT "fk_rails_9d58aa0a3c"
FOREIGN KEY ("feedback_id")
  REFERENCES "comprehension_feedbacks" ("id")
 ON DELETE CASCADE[0m
  [1m[35m (1.7ms)[0m  ALTER TABLE "comprehension_labels" ADD CONSTRAINT "fk_rails_6112e49a74"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE
  [1m[36m (1.7ms)[0m  [1mALTER TABLE "comprehension_plagiarism_texts" ADD CONSTRAINT "fk_rails_bcd03e8630"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE[0m
  [1m[35m (1.9ms)[0m  ALTER TABLE "comprehension_regex_rules" ADD CONSTRAINT "fk_rails_dd1bb7c35b"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE
  [1m[36m (2.5ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL) [0m
  [1m[35m (1.3ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36m (0.4ms)[0m  [1mSELECT version FROM "schema_migrations"[0m
  [1m[35m (0.6ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20210511160025')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20210317200004')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20210317200005')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20210317200006')[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36m (0.3ms)[0m  [1mSELECT "schema_migrations"."version" FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to CreateComprehensionActivities (20200605133641)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (2.4ms)[0m  [1mCREATE TABLE "comprehension_activities" ("id" serial primary key, "title" character varying(100), "parent_activity_id" integer, "target_level" smallint, "scored_level" character varying(100), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (3.9ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL) [0m
  [1m[35m (1.5ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to CreateComprehensionActivities (20200605133641)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (3.2ms)[0m  [1mCREATE TABLE "comprehension_activities" ("id" serial primary key, "title" character varying(100), "parent_activity_id" integer, "target_level" smallint, "scored_level" character varying(100), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.0ms)[0m  CREATE  INDEX  "index_comprehension_activities_on_parent_activity_id" ON "comprehension_activities"  ("parent_activity_id")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20200605133641"]]
  [1m[35m (0.3ms)[0m  COMMIT
Migrating to CreateComprehensionPassages (20200608233222)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (3.3ms)[0m  CREATE TABLE "comprehension_passages" ("id" serial primary key, "activity_id" integer, "text" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (0.9ms)[0m  [1mCREATE  INDEX  "index_comprehension_passages_on_activity_id" ON "comprehension_passages"  ("activity_id")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20200608233222"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionPrompts (20200609005839)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (3.9ms)[0m  [1mCREATE TABLE "comprehension_prompts" ("id" serial primary key, "activity_id" integer, "max_attempts" smallint, "conjunction" character varying(20), "text" character varying, "max_attempts_feedback" text, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.0ms)[0m  CREATE  INDEX  "index_comprehension_prompts_on_activity_id" ON "comprehension_prompts"  ("activity_id")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20200609005839"]]
  [1m[35m (0.4ms)[0m  COMMIT
Migrating to CreateComprehensionRuleSets (20200625222938)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (3.3ms)[0m  CREATE TABLE "comprehension_rule_sets" ("id" serial primary key, "activity_id" integer, "prompt_id" integer, "name" character varying(100), "feedback" text, "priority" smallint, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.2ms)[0m  [1mCREATE  INDEX  "index_comprehension_rule_sets_on_activity_id" ON "comprehension_rule_sets"  ("activity_id")[0m
  [1m[35m (1.0ms)[0m  CREATE  INDEX  "index_comprehension_rule_sets_on_prompt_id" ON "comprehension_rule_sets"  ("prompt_id")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20200625222938"]]
  [1m[35m (0.6ms)[0m  COMMIT
Migrating to CreateComprehensionRules (20200626160522)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (3.0ms)[0m  CREATE TABLE "comprehension_rules" ("id" serial primary key, "rule_set_id" integer, "regex_text" character varying(200), "case_sensitive" boolean, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.1ms)[0m  [1mCREATE  INDEX  "index_comprehension_rules_on_rule_set_id" ON "comprehension_rules"  ("rule_set_id")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20200626160522"]]
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionPromptsRuleSetsTable (20200626181312)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (2.4ms)[0m  [1mCREATE TABLE "comprehension_prompts_rule_sets" ("id" serial primary key, "prompt_id" integer, "rule_set_id" integer) [0m
  [1m[35m (1.6ms)[0m  CREATE  INDEX  "index_comprehension_prompts_rule_sets_on_prompt_id" ON "comprehension_prompts_rule_sets"  ("prompt_id")
  [1m[36m (1.0ms)[0m  [1mCREATE  INDEX  "index_comprehension_prompts_rule_sets_on_rule_set_id" ON "comprehension_prompts_rule_sets"  ("rule_set_id")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20200626181312"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionTurkingRounds (20200630161345)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (2.5ms)[0m  [1mCREATE TABLE "comprehension_turking_rounds" ("id" serial primary key, "activity_id" integer, "uuid" uuid, "expires_at" timestamp, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.0ms)[0m  CREATE  INDEX  "index_comprehension_turking_rounds_on_activity_id" ON "comprehension_turking_rounds"  ("activity_id")
  [1m[36m (1.1ms)[0m  [1mCREATE UNIQUE INDEX  "index_comprehension_turking_rounds_on_uuid" ON "comprehension_turking_rounds"  ("uuid")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20200630161345"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionTurkingRoundActivitySessions (20201125161727)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (4.5ms)[0m  [1mCREATE TABLE "comprehension_turking_round_activity_sessions" ("id" serial primary key, "turking_round_id" integer, "activity_session_uid" character varying, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.1ms)[0m  CREATE  INDEX  "comprehension_turking_sessions_turking_id" ON "comprehension_turking_round_activity_sessions"  ("turking_round_id")
  [1m[36m (1.0ms)[0m  [1mCREATE UNIQUE INDEX  "comprehension_turking_sessions_activity_uid" ON "comprehension_turking_round_activity_sessions"  ("activity_session_uid")[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20201125161727"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to AddPlagiarismColumnsToPrompt (20201202224853)
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mALTER TABLE "comprehension_prompts" ADD "plagiarism_text" text[0m
  [1m[35m (0.6ms)[0m  ALTER TABLE "comprehension_prompts" ADD "plagiarism_first_feedback" text
  [1m[36m (0.5ms)[0m  [1mALTER TABLE "comprehension_prompts" ADD "plagiarism_second_feedback" text[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20201202224853"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateRegexRulesTable (20210114154926)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (2.3ms)[0m  [1mCREATE TABLE "comprehension_regex_rules" ("id" serial primary key, "rule_set_id" integer NOT NULL, "regex_text" character varying(200) NOT NULL, "case_sensitive" boolean NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.0ms)[0m  CREATE  INDEX  "index_comprehension_regex_rules_on_rule_set_id" ON "comprehension_regex_rules"  ("rule_set_id")
  [1m[36m (0.5ms)[0m  [1mINSERT INTO comprehension_regex_rules SELECT * FROM comprehension_rules[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210114154926"]]
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Migrating to RemoveRuleTable (20210114164149)
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (1.4ms)[0m  [1mDROP TABLE "comprehension_rules"[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210114164149"]]
  [1m[36m (1.2ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionRulesTable (20210114182832)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (4.1ms)[0m  [1mCREATE TABLE "comprehension_rules" ("id" serial primary key, "uid" character varying NOT NULL, "name" character varying NOT NULL, "description" character varying, "universal" boolean NOT NULL, "rule_type" character varying NOT NULL, "optimal" boolean NOT NULL, "suborder" integer, "concept_uid" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.1ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_rules_on_uid" ON "comprehension_rules"  ("uid")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210114182832"]]
  [1m[35m (0.4ms)[0m  COMMIT
Migrating to CreateComprehensionFeedbacks (20210121200031)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (4.5ms)[0m  CREATE TABLE "comprehension_feedbacks" ("id" serial primary key, "rule_id" integer NOT NULL, "text" character varying NOT NULL, "description" character varying, "order" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.0ms)[0m  [1mCREATE UNIQUE INDEX  "index_comprehension_feedbacks_on_rule_id_and_order" ON "comprehension_feedbacks"  ("rule_id", "order")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210121200031"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionPromptsRules (20210122144228)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (2.5ms)[0m  [1mCREATE TABLE "comprehension_prompts_rules" ("id" serial primary key, "prompt_id" integer NOT NULL, "rule_id" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.1ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_prompts_rules_on_prompt_id_and_rule_id" ON "comprehension_prompts_rules"  ("prompt_id", "rule_id")
  [1m[36m (1.0ms)[0m  [1mCREATE  INDEX  "index_comprehension_prompts_rules_on_rule_id" ON "comprehension_prompts_rules"  ("rule_id")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210122144228"]]
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
Migrating to CreatePlagiarismTextTable (20210122165204)
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (3.9ms)[0m  [1mCREATE TABLE "comprehension_plagiarism_texts" ("id" serial primary key, "rule_id" integer NOT NULL, "text" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (0.9ms)[0m  CREATE UNIQUE INDEX  "index_comprehension_plagiarism_texts_on_rule_id" ON "comprehension_plagiarism_texts"  ("rule_id")
  [1m[36m (2.2ms)[0m  [1mALTER TABLE "comprehension_plagiarism_texts" ADD CONSTRAINT "fk_rails_bcd03e8630"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210122165204"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionHighlights (20210122165328)
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (4.0ms)[0m  [1mCREATE TABLE "comprehension_highlights" ("id" serial primary key, "feedback_id" integer NOT NULL, "text" character varying NOT NULL, "highlight_type" character varying NOT NULL, "starting_index" integer, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.3ms)[0m  ALTER TABLE "comprehension_highlights" ADD CONSTRAINT "fk_rails_9d58aa0a3c"
FOREIGN KEY ("feedback_id")
  REFERENCES "comprehension_feedbacks" ("id")
 ON DELETE CASCADE
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210122165328"]]
  [1m[35m (0.5ms)[0m  COMMIT
Migrating to DropPlagiarismColumnsFromPrompt (20210128152309)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ALTER TABLE "comprehension_prompts" DROP "plagiarism_text"
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "comprehension_prompts" DROP "plagiarism_first_feedback"[0m
  [1m[35m (7.3ms)[0m  ALTER TABLE "comprehension_prompts" DROP "plagiarism_second_feedback"
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210128152309"]]
  [1m[35m (0.4ms)[0m  COMMIT
Migrating to AssociateRegexRuleWithRule (20210128155938)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ALTER TABLE "comprehension_regex_rules" ADD "rule_id" integer
  [1m[36m (1.0ms)[0m  [1mCREATE  INDEX  "index_comprehension_regex_rules_on_rule_id" ON "comprehension_regex_rules"  ("rule_id")[0m
  [1m[35m (1.2ms)[0m  ALTER TABLE "comprehension_regex_rules" ADD CONSTRAINT "fk_rails_dd1bb7c35b"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE
  [1m[36m (0.3ms)[0m  [1mALTER TABLE "comprehension_rules" ALTER COLUMN "concept_uid" TYPE character varying[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "comprehension_rules" ALTER "concept_uid" DROP NOT NULL
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210128155938"]]
  [1m[35m (0.5ms)[0m  COMMIT
Migrating to DeleteRuleSets (20210129184505)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (1.2ms)[0m  DROP TABLE "comprehension_rule_sets"
  [1m[36m (0.8ms)[0m  [1mDROP TABLE "comprehension_prompts_rule_sets"[0m
  [1m[35m (0.4ms)[0m  ALTER TABLE "comprehension_regex_rules" DROP "rule_set_id"
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210129184505"]]
  [1m[35m (2.1ms)[0m  COMMIT
Migrating to CreateComprehensionAutomlModels (20210209200555)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (4.1ms)[0m  CREATE TABLE "comprehension_automl_models" ("id" serial primary key, "automl_model_id" character varying NOT NULL, "name" character varying NOT NULL, "labels" character varying[] DEFAULT '{}', "prompt_id" integer, "state" character varying NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
  [1m[36m (1.9ms)[0m  [1mALTER TABLE "comprehension_automl_models" ADD CONSTRAINT "fk_rails_35c32f80fc"
FOREIGN KEY ("prompt_id")
  REFERENCES "comprehension_prompts" ("id")
[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210209200555"]]
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Migrating to CreateComprehensionLabels (20210212194127)
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (4.3ms)[0m  [1mCREATE TABLE "comprehension_labels" ("id" serial primary key, "name" character varying NOT NULL, "rule_id" integer NOT NULL, "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) [0m
  [1m[35m (1.2ms)[0m  ALTER TABLE "comprehension_labels" ADD CONSTRAINT "fk_rails_6112e49a74"
FOREIGN KEY ("rule_id")
  REFERENCES "comprehension_rules" ("id")
 ON DELETE CASCADE
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210212194127"]]
  [1m[35m (0.4ms)[0m  COMMIT
Migrating to AddStateColumnToRule (20210218195536)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ALTER TABLE "comprehension_rules" ADD "state" character varying
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = 'active'[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "comprehension_rules" ALTER COLUMN "state" TYPE character varying
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "comprehension_rules" ALTER "state" SET NOT NULL[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210218195536"]]
  [1m[36m (0.3ms)[0m  [1mCOMMIT[0m
Migrating to AddSequenceTypeToRegexRules (20210218213618)
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules"
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (5.3ms)[0m  ALTER TABLE "comprehension_regex_rules" ADD "sequence_type" text DEFAULT 'incorrect' NOT NULL
  [1m[36m (4.2ms)[0m  [1mALTER TABLE "comprehension_rules" ALTER COLUMN "suborder" TYPE text[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "comprehension_rules" ALTER "suborder" DROP NOT NULL
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210218213618"]]
  [1m[35m (2.2ms)[0m  COMMIT
Migrating to AddImageLinkAndImageAltTextToPassages (20210219163806)
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.5ms)[0m  ALTER TABLE "comprehension_passages" ADD "image_link" character varying
  [1m[36m (5.1ms)[0m  [1mALTER TABLE "comprehension_passages" ADD "image_alt_text" character varying DEFAULT ''[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210219163806"]]
  [1m[36m (1.8ms)[0m  [1mCOMMIT[0m
Migrating to AddNameToComprehensionActivities (20210316160648)
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (2.1ms)[0m  [1mALTER TABLE "comprehension_activities" ADD "name" character varying[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210316160648"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to AddParentActivity (20210317200004)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (3.7ms)[0m  [1mCREATE TABLE "activities" ("id" serial primary key, "name" character varying, "activity_classification_id" integer) [0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210317200004"]]
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Migrating to AddParentActivityClassification (20210317200005)
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (4.2ms)[0m  [1mCREATE TABLE "activity_classifications" ("id" serial primary key, "key" character varying) [0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210317200005"]]
  [1m[36m (0.6ms)[0m  [1mCOMMIT[0m
Migrating to AddFlagsToActivities (20210317200006)
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (3.9ms)[0m  [1mALTER TABLE "activities" ADD "flags" character varying[] DEFAULT '{}' NOT NULL[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210317200006"]]
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Migrating to RenameRuleDescriptionToRuleNote (20210429144611)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mALTER TABLE "comprehension_rules" RENAME COLUMN "description" TO "note"[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20210429144611"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to UpdateComprehensionRuleSuborderTypeToInteger (20210511160025)
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (4.2ms)[0m  [1mALTER TABLE "comprehension_rules" ALTER COLUMN "suborder" TYPE integer USING CAST(suborder AS integer)[0m
  [1m[35m (0.1ms)[0m  ALTER TABLE "comprehension_rules" ALTER "suborder" DROP NOT NULL
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20210511160025"]]
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (2.9ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'activities'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.5ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'activity_classifications'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.3ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_activities'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.4ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_automl_models'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.3ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_feedbacks'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.6ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_highlights'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.5ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_labels'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.4ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_passages'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.4ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_plagiarism_texts'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.3ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_prompts'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.3ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_prompts_rules'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.5ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_regex_rules'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (2.4ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_rules'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36m (2.4ms)[0m  [1mSELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_turking_round_activity_sessions'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname
[0m
  [1m[35m (3.0ms)[0m  SELECT t2.oid::regclass::text AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confupdtype AS on_update, c.confdeltype AS on_delete
FROM pg_constraint c
JOIN pg_class t1 ON c.conrelid = t1.oid
JOIN pg_class t2 ON c.confrelid = t2.oid
JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
JOIN pg_namespace t3 ON c.connamespace = t3.oid
WHERE c.contype = 'f'
  AND t1.relname = 'comprehension_turking_rounds'
  AND t3.nspname = ANY (current_schemas(false))
ORDER BY c.conname

  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #forbid_automl_model_id_change should not allow automl_model_id to change after create. 
-------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.4ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 1"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 1"]]
  [1m[36mComprehension::Activity Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 1 LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 1"], ["name", "MyString 1"], ["target_level", 1], ["parent_activity_id", 1], ["created_at", "2021-05-12 19:16:46.255538"], ["updated_at", "2021-05-12 19:16:46.255538"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 1], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.258851"], ["updated_at", "2021-05-12 19:16:46.258851"]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 1], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.258851"], ["updated_at", "2021-05-12 19:16:46.258851"], ["id", 1], ["id", 1]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'automl_id' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "automl_id"], ["name", "AutoML-Model-Name"], ["prompt_id", 1], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.265353"], ["updated_at", "2021-05-12 19:16:46.265353"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'some new value' AND "comprehension_automl_models"."id" != 1) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2[0m  [["updated_at", "2021-05-12 19:16:46.267679"], ["id", 1]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.1ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should not be valid if labels is empty. 
-----------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-1' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #forbid_labels_change should not allow labels to change after create. 
-------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 3"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 3"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 2 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 3"], ["name", "MyString 3"], ["target_level", 1], ["parent_activity_id", 2], ["created_at", "2021-05-12 19:16:46.280266"], ["updated_at", "2021-05-12 19:16:46.280266"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 2], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.281636"], ["updated_at", "2021-05-12 19:16:46.281636"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 2], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.281636"], ["updated_at", "2021-05-12 19:16:46.281636"], ["id", 2], ["id", 2]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-2' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-2"], ["name", "AutoML-Model-Name"], ["prompt_id", 2], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.284837"], ["updated_at", "2021-05-12 19:16:46.284837"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-2' AND "comprehension_automl_models"."id" != 2) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2[0m  [["updated_at", "2021-05-12 19:16:46.287447"], ["id", 2]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #populate_from_automl_model_id should set name, labels, and state when called. 
----------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'Test-ID' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should not change state of anything if activate fails. 
--------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 4"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 4"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 3 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 4"], ["name", "MyString 4"], ["target_level", 1], ["parent_activity_id", 3], ["created_at", "2021-05-12 19:16:46.294597"], ["updated_at", "2021-05-12 19:16:46.294597"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 3], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.296227"], ["updated_at", "2021-05-12 19:16:46.296227"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 3], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.296227"], ["updated_at", "2021-05-12 19:16:46.296227"], ["id", 3], ["id", 3]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.7ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 3], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '462a591e-8ef9-4ac2-8900-fe5327f092e5' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "462a591e-8ef9-4ac2-8900-fe5327f092e5"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.324109"], ["updated_at", "2021-05-12 19:16:46.324109"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 3], ["rule_id", 1], ["created_at", "2021-05-12 19:16:46.326017"], ["updated_at", "2021-05-12 19:16:46.326017"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 3], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8bf200e4-6812-4eba-adba-cc3abcc8bb86' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "8bf200e4-6812-4eba-adba-cc3abcc8bb86"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.331007"], ["updated_at", "2021-05-12 19:16:46.331007"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 3], ["rule_id", 2], ["created_at", "2021-05-12 19:16:46.332358"], ["updated_at", "2021-05-12 19:16:46.332358"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 3], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2c508307-e48e-42df-85de-edd424f1bd74' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "2c508307-e48e-42df-85de-edd424f1bd74"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.337337"], ["updated_at", "2021-05-12 19:16:46.337337"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 3], ["rule_id", 3], ["created_at", "2021-05-12 19:16:46.338451"], ["updated_at", "2021-05-12 19:16:46.338451"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 1 LIMIT 1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 3]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 1]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 2]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 3]]
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label1"], ["rule_id", 1], ["created_at", "2021-05-12 19:16:46.351333"], ["updated_at", "2021-05-12 19:16:46.351333"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 2 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label2"], ["rule_id", 2], ["created_at", "2021-05-12 19:16:46.354661"], ["updated_at", "2021-05-12 19:16:46.354661"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 3 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label3"], ["rule_id", 3], ["created_at", "2021-05-12 19:16:46.356942"], ["updated_at", "2021-05-12 19:16:46.356942"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 1 AND "comprehension_labels"."id" != 1) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '462a591e-8ef9-4ac2-8900-fe5327f092e5' AND "comprehension_rules"."id" != 1) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.359688"], ["id", 1]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 2 AND "comprehension_labels"."id" != 2) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '8bf200e4-6812-4eba-adba-cc3abcc8bb86' AND "comprehension_rules"."id" != 2) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.362181"], ["id", 2]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 3], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 1]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 2]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 3]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-3' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-3"], ["name", "AutoML-Model-Name"], ["prompt_id", 3], ["state", "active"], ["labels", "{label1,label2}"], ["created_at", "2021-05-12 19:16:46.366499"], ["updated_at", "2021-05-12 19:16:46.366499"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-4' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-4"], ["name", "AutoML-Model-Name"], ["prompt_id", 3], ["state", "inactive"], ["labels", "{no_rule_for_label}"], ["created_at", "2021-05-12 19:16:46.368542"], ["updated_at", "2021-05-12 19:16:46.368542"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1  [["prompt_id", 3]]
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 3], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 1]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 2]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 3]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-4' AND "comprehension_automl_models"."id" != 4) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 3]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should not be valid if labels is not an array. 
------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-5' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #forbid_name_change should not allow name to change after create. 
---------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 6"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 6"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 4 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 6"], ["name", "MyString 6"], ["target_level", 1], ["parent_activity_id", 4], ["created_at", "2021-05-12 19:16:46.382759"], ["updated_at", "2021-05-12 19:16:46.382759"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 4], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.384471"], ["updated_at", "2021-05-12 19:16:46.384471"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 4], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.384471"], ["updated_at", "2021-05-12 19:16:46.384471"], ["id", 4], ["id", 4]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-6' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-6"], ["name", "name"], ["prompt_id", 4], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.388514"], ["updated_at", "2021-05-12 19:16:46.388514"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-6' AND "comprehension_automl_models"."id" != 5) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2[0m  [["updated_at", "2021-05-12 19:16:46.390842"], ["id", 5]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 5]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #labels_have_associated_rules? should be true if there are matching labels tied to the same prompt as the automl_model. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 7"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 7"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 5 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 7"], ["name", "MyString 7"], ["target_level", 1], ["parent_activity_id", 5], ["created_at", "2021-05-12 19:16:46.397549"], ["updated_at", "2021-05-12 19:16:46.397549"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 5], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.398944"], ["updated_at", "2021-05-12 19:16:46.398944"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 5], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.398944"], ["updated_at", "2021-05-12 19:16:46.398944"], ["id", 5], ["id", 5]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-7' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-7"], ["name", "AutoML-Model-Name"], ["prompt_id", 5], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.401961"], ["updated_at", "2021-05-12 19:16:46.401961"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.3ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 8"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 8"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 6 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 8"], ["name", "MyString 8"], ["target_level", 1], ["parent_activity_id", 6], ["created_at", "2021-05-12 19:16:46.406987"], ["updated_at", "2021-05-12 19:16:46.406987"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 6], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.408456"], ["updated_at", "2021-05-12 19:16:46.408456"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 6], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.408456"], ["updated_at", "2021-05-12 19:16:46.408456"], ["id", 6], ["id", 6]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 6], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3033d246-e269-4f75-8a80-d83f234db17c' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "3033d246-e269-4f75-8a80-d83f234db17c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.414196"], ["updated_at", "2021-05-12 19:16:46.414196"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 6], ["rule_id", 4], ["created_at", "2021-05-12 19:16:46.415153"], ["updated_at", "2021-05-12 19:16:46.415153"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 4 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 6]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 4]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 4], ["created_at", "2021-05-12 19:16:46.419444"], ["updated_at", "2021-05-12 19:16:46.419444"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 5], ["rule_type", "autoML"]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should be valid if labels is an array. 
----------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-8' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #automl_model_full_id should call model_path on the automl_client with specified values. 
--------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 10"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 10"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 7 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 10"], ["name", "MyString 10"], ["target_level", 1], ["parent_activity_id", 7], ["created_at", "2021-05-12 19:16:46.440564"], ["updated_at", "2021-05-12 19:16:46.440564"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 7], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.441995"], ["updated_at", "2021-05-12 19:16:46.441995"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 7], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.441995"], ["updated_at", "2021-05-12 19:16:46.441995"], ["id", 7], ["id", 7]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-9' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-9"], ["name", "AutoML-Model-Name"], ["prompt_id", 7], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.444914"], ["updated_at", "2021-05-12 19:16:46.444914"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations shoulda matchers should require case sensitive unique value for automl_model_id. 
------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 11"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 11"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 8 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 11"], ["name", "MyString 11"], ["target_level", 1], ["parent_activity_id", 8], ["created_at", "2021-05-12 19:16:46.449111"], ["updated_at", "2021-05-12 19:16:46.449111"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 8], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.450526"], ["updated_at", "2021-05-12 19:16:46.450526"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 8], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.450526"], ["updated_at", "2021-05-12 19:16:46.450526"], ["id", 8], ["id", 8]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-10' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-10"], ["name", "AutoML-Model-Name"], ["prompt_id", 8], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.454605"], ["updated_at", "2021-05-12 19:16:46.454605"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.5ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models"  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1
  [1m[36mComprehension::AutomlModel Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-10' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #state_can_be_active should validate state = active if labels_have_associated_rules is true. 
------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 12"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 12"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 9 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 12"], ["name", "MyString 12"], ["target_level", 1], ["parent_activity_id", 9], ["created_at", "2021-05-12 19:16:46.464501"], ["updated_at", "2021-05-12 19:16:46.464501"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 9], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.465782"], ["updated_at", "2021-05-12 19:16:46.465782"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 9], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.465782"], ["updated_at", "2021-05-12 19:16:46.465782"], ["id", 9], ["id", 9]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-11' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-11"], ["name", "AutoML-Model-Name"], ["prompt_id", 9], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.468531"], ["updated_at", "2021-05-12 19:16:46.468531"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-11' AND "comprehension_automl_models"."id" != 9) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should return self and be valid with state active if this item is already the active model. 
---------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 13"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 13"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 10 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 13"], ["name", "MyString 13"], ["target_level", 1], ["parent_activity_id", 10], ["created_at", "2021-05-12 19:16:46.474197"], ["updated_at", "2021-05-12 19:16:46.474197"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 10], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.475526"], ["updated_at", "2021-05-12 19:16:46.475526"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 10], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.475526"], ["updated_at", "2021-05-12 19:16:46.475526"], ["id", 10], ["id", 10]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 10], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b3b23c41-8d40-4dad-88ef-7898c00e0bff' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b3b23c41-8d40-4dad-88ef-7898c00e0bff"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.480477"], ["updated_at", "2021-05-12 19:16:46.480477"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 10], ["rule_id", 5], ["created_at", "2021-05-12 19:16:46.481388"], ["updated_at", "2021-05-12 19:16:46.481388"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 10], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'bb12e4fa-221e-49fb-bbe5-7c584d9e7e74' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "bb12e4fa-221e-49fb-bbe5-7c584d9e7e74"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.486011"], ["updated_at", "2021-05-12 19:16:46.486011"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 10], ["rule_id", 6], ["created_at", "2021-05-12 19:16:46.487054"], ["updated_at", "2021-05-12 19:16:46.487054"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 10], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fba24c13-823a-4c34-9931-fbc12450e44b' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "fba24c13-823a-4c34-9931-fbc12450e44b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.493161"], ["updated_at", "2021-05-12 19:16:46.493161"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 10], ["rule_id", 7], ["created_at", "2021-05-12 19:16:46.494314"], ["updated_at", "2021-05-12 19:16:46.494314"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 5 LIMIT 1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 10]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 5]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 6]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 7]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label1"], ["rule_id", 5], ["created_at", "2021-05-12 19:16:46.498866"], ["updated_at", "2021-05-12 19:16:46.498866"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 6 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label2"], ["rule_id", 6], ["created_at", "2021-05-12 19:16:46.501054"], ["updated_at", "2021-05-12 19:16:46.501054"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 7 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label3"], ["rule_id", 7], ["created_at", "2021-05-12 19:16:46.503115"], ["updated_at", "2021-05-12 19:16:46.503115"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 10], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 5]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 6]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 7]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-12' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-12"], ["name", "AutoML-Model-Name"], ["prompt_id", 10], ["state", "active"], ["labels", "{label1,label2}"], ["created_at", "2021-05-12 19:16:46.508103"], ["updated_at", "2021-05-12 19:16:46.508103"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 10], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 5]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 6]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 7]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-12' AND "comprehension_automl_models"."id" != 10) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1[0m  [["prompt_id", 10]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 10], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 5]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 6]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 7]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-12' AND "comprehension_automl_models"."id" != 10) LIMIT 1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 10], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 5]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 5 AND "comprehension_labels"."id" != 5) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'b3b23c41-8d40-4dad-88ef-7898c00e0bff' AND "comprehension_rules"."id" != 5) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.517451"], ["id", 5]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 6]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 6 AND "comprehension_labels"."id" != 6) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'bb12e4fa-221e-49fb-bbe5-7c584d9e7e74' AND "comprehension_rules"."id" != 6) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.520999"], ["id", 6]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 7]]
  [1m[36mComprehension::Label Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 7 AND "comprehension_labels"."id" != 7) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'fba24c13-823a-4c34-9931-fbc12450e44b' AND "comprehension_rules"."id" != 7) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 10], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 5]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 6]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 7]]
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-12' AND "comprehension_automl_models"."id" != 10) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations shoulda matchers should require automl_model_id to be set. 
--------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 14"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 14"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 11 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 14"], ["name", "MyString 14"], ["target_level", 1], ["parent_activity_id", 11], ["created_at", "2021-05-12 19:16:46.532630"], ["updated_at", "2021-05-12 19:16:46.532630"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 11], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.533910"], ["updated_at", "2021-05-12 19:16:46.533910"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 11], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.533910"], ["updated_at", "2021-05-12 19:16:46.533910"], ["id", 11], ["id", 11]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-13' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-13"], ["name", "AutoML-Model-Name"], ["prompt_id", 11], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.536591"], ["updated_at", "2021-05-12 19:16:46.536591"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should set model and associated rules to state active if valid. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 15"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 15"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 12 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 15"], ["name", "MyString 15"], ["target_level", 1], ["parent_activity_id", 12], ["created_at", "2021-05-12 19:16:46.542414"], ["updated_at", "2021-05-12 19:16:46.542414"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 12], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.543799"], ["updated_at", "2021-05-12 19:16:46.543799"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 12], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.543799"], ["updated_at", "2021-05-12 19:16:46.543799"], ["id", 12], ["id", 12]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 12], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0f18adab-16be-40cd-9106-6c376eee1776' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "0f18adab-16be-40cd-9106-6c376eee1776"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.548517"], ["updated_at", "2021-05-12 19:16:46.548517"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 12], ["rule_id", 8], ["created_at", "2021-05-12 19:16:46.549490"], ["updated_at", "2021-05-12 19:16:46.549490"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 12], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '65852fad-f44d-4739-b12a-0fef06293421' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "65852fad-f44d-4739-b12a-0fef06293421"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.553640"], ["updated_at", "2021-05-12 19:16:46.553640"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 12], ["rule_id", 9], ["created_at", "2021-05-12 19:16:46.554778"], ["updated_at", "2021-05-12 19:16:46.554778"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 12], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8ffeb0fd-4b57-41df-ae2f-7bf468534350' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "8ffeb0fd-4b57-41df-ae2f-7bf468534350"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.559045"], ["updated_at", "2021-05-12 19:16:46.559045"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 12], ["rule_id", 10], ["created_at", "2021-05-12 19:16:46.559923"], ["updated_at", "2021-05-12 19:16:46.559923"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 8 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 12]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 8]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 9]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 10]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 8], ["created_at", "2021-05-12 19:16:46.563501"], ["updated_at", "2021-05-12 19:16:46.563501"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 9 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label2"], ["rule_id", 9], ["created_at", "2021-05-12 19:16:46.566075"], ["updated_at", "2021-05-12 19:16:46.566075"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 10 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label3"], ["rule_id", 10], ["created_at", "2021-05-12 19:16:46.568677"], ["updated_at", "2021-05-12 19:16:46.568677"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-14' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-14"], ["name", "AutoML-Model-Name"], ["prompt_id", 12], ["state", "inactive"], ["labels", "{label1,label2}"], ["created_at", "2021-05-12 19:16:46.570950"], ["updated_at", "2021-05-12 19:16:46.570950"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1[0m  [["prompt_id", 12]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 12], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 8]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 9]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 10]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-14' AND "comprehension_automl_models"."id" != 12) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_automl_models" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_automl_models"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.574859"], ["id", 12]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 12], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 8]]
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 8 AND "comprehension_labels"."id" != 8) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '0f18adab-16be-40cd-9106-6c376eee1776' AND "comprehension_rules"."id" != 8) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.577946"], ["id", 8]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 9]]
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 9 AND "comprehension_labels"."id" != 9) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '65852fad-f44d-4739-b12a-0fef06293421' AND "comprehension_rules"."id" != 9) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.580250"], ["id", 9]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 10]]
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 10 AND "comprehension_labels"."id" != 10) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '8ffeb0fd-4b57-41df-ae2f-7bf468534350' AND "comprehension_rules"."id" != 10) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 8]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 9]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 12], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 8]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 9]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 10]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-14' AND "comprehension_automl_models"."id" != 12) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #serializable_hash should serialize into the expected shape. 
----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 16"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 16"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 13 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 16"], ["name", "MyString 16"], ["target_level", 1], ["parent_activity_id", 13], ["created_at", "2021-05-12 19:16:46.590141"], ["updated_at", "2021-05-12 19:16:46.590141"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 13], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.592025"], ["updated_at", "2021-05-12 19:16:46.592025"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 13], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.592025"], ["updated_at", "2021-05-12 19:16:46.592025"], ["id", 13], ["id", 13]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-15' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-15"], ["name", "AutoML-Model-Name"], ["prompt_id", 13], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.594773"], ["updated_at", "2021-05-12 19:16:46.594773"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:46.594773')  [["prompt_id", 13]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #labels_have_associated_rules? should be false if there are missing labels from the referenced prompt. 
----------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 17"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 17"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 14 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 17"], ["name", "MyString 17"], ["target_level", 1], ["parent_activity_id", 14], ["created_at", "2021-05-12 19:16:46.599510"], ["updated_at", "2021-05-12 19:16:46.599510"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 14], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.600777"], ["updated_at", "2021-05-12 19:16:46.600777"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 14], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.600777"], ["updated_at", "2021-05-12 19:16:46.600777"], ["id", 14], ["id", 14]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-16' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-16"], ["name", "AutoML-Model-Name"], ["prompt_id", 14], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.603525"], ["updated_at", "2021-05-12 19:16:46.603525"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 14], ["rule_type", "autoML"]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-16' AND "comprehension_automl_models"."id" != 14) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations shoulda matchers should require name to be set. 
---------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 18"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 18"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 15 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 18"], ["name", "MyString 18"], ["target_level", 1], ["parent_activity_id", 15], ["created_at", "2021-05-12 19:16:46.608746"], ["updated_at", "2021-05-12 19:16:46.608746"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 15], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.610073"], ["updated_at", "2021-05-12 19:16:46.610073"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 15], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.610073"], ["updated_at", "2021-05-12 19:16:46.610073"], ["id", 15], ["id", 15]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-17' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-17"], ["name", "AutoML-Model-Name"], ["prompt_id", 15], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.612683"], ["updated_at", "2021-05-12 19:16:46.612683"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should set previously active model and unassociated rules to state inactive. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 19"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 19"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 16 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 19"], ["name", "MyString 19"], ["target_level", 1], ["parent_activity_id", 16], ["created_at", "2021-05-12 19:16:46.619969"], ["updated_at", "2021-05-12 19:16:46.619969"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 16], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.621678"], ["updated_at", "2021-05-12 19:16:46.621678"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 16], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.621678"], ["updated_at", "2021-05-12 19:16:46.621678"], ["id", 16], ["id", 16]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 16], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '260e730f-9ac0-4ea2-8e15-426837d93482' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "260e730f-9ac0-4ea2-8e15-426837d93482"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.627361"], ["updated_at", "2021-05-12 19:16:46.627361"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 16], ["rule_id", 11], ["created_at", "2021-05-12 19:16:46.628313"], ["updated_at", "2021-05-12 19:16:46.628313"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 16], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a5a71da0-9e82-4bcb-87b4-1fb635cd5849' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "a5a71da0-9e82-4bcb-87b4-1fb635cd5849"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.631867"], ["updated_at", "2021-05-12 19:16:46.631867"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 16], ["rule_id", 12], ["created_at", "2021-05-12 19:16:46.632713"], ["updated_at", "2021-05-12 19:16:46.632713"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 16], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f70304e1-8f09-4e1c-ad39-a6551c5b51cb' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "f70304e1-8f09-4e1c-ad39-a6551c5b51cb"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.636350"], ["updated_at", "2021-05-12 19:16:46.636350"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 16], ["rule_id", 13], ["created_at", "2021-05-12 19:16:46.637219"], ["updated_at", "2021-05-12 19:16:46.637219"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 11 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 16]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 11]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 12]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 13]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 11], ["created_at", "2021-05-12 19:16:46.640976"], ["updated_at", "2021-05-12 19:16:46.640976"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 12 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label2"], ["rule_id", 12], ["created_at", "2021-05-12 19:16:46.642970"], ["updated_at", "2021-05-12 19:16:46.642970"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 13 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label3"], ["rule_id", 13], ["created_at", "2021-05-12 19:16:46.644752"], ["updated_at", "2021-05-12 19:16:46.644752"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 11 AND "comprehension_labels"."id" != 11) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '260e730f-9ac0-4ea2-8e15-426837d93482' AND "comprehension_rules"."id" != 11) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.646931"], ["id", 11]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 12 AND "comprehension_labels"."id" != 12) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'a5a71da0-9e82-4bcb-87b4-1fb635cd5849' AND "comprehension_rules"."id" != 12) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.649176"], ["id", 12]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 16], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 11]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 12]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 13]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-18' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-18"], ["name", "AutoML-Model-Name"], ["prompt_id", 16], ["state", "active"], ["labels", "{label1,label2}"], ["created_at", "2021-05-12 19:16:46.653716"], ["updated_at", "2021-05-12 19:16:46.653716"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-19' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-19"], ["name", "AutoML-Model-Name"], ["prompt_id", 16], ["state", "inactive"], ["labels", "{label2,label3}"], ["created_at", "2021-05-12 19:16:46.655904"], ["updated_at", "2021-05-12 19:16:46.655904"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 16], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 11]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 12]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 13]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-18' AND "comprehension_automl_models"."id" != 16) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1  [["prompt_id", 16]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 16], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 11]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 12]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 13]]
  [1m[36mComprehension::AutomlModel Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-19' AND "comprehension_automl_models"."id" != 17) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_automl_models" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_automl_models"."id" = $3  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.662952"], ["id", 17]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 16], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 11]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 11 AND "comprehension_labels"."id" != 11) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '260e730f-9ac0-4ea2-8e15-426837d93482' AND "comprehension_rules"."id" != 11) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "inactive"], ["updated_at", "2021-05-12 19:16:46.675317"], ["id", 11]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 12]]
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 12 AND "comprehension_labels"."id" != 12) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'a5a71da0-9e82-4bcb-87b4-1fb635cd5849' AND "comprehension_rules"."id" != 12) LIMIT 1
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 13]]
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 13 AND "comprehension_labels"."id" != 13) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f70304e1-8f09-4e1c-ad39-a6551c5b51cb' AND "comprehension_rules"."id" != 13) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-05-12 19:16:46.679432"], ["id", 13]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 16]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 11]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 12]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #fetch_automl_label should return the highest score label display_name. 
---------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 20"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 20"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 17 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 20"], ["name", "MyString 20"], ["target_level", 1], ["parent_activity_id", 17], ["created_at", "2021-05-12 19:16:46.685492"], ["updated_at", "2021-05-12 19:16:46.685492"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 17], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.687004"], ["updated_at", "2021-05-12 19:16:46.687004"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 17], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.687004"], ["updated_at", "2021-05-12 19:16:46.687004"], ["id", 17], ["id", 17]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-20' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-20"], ["name", "AutoML-Model-Name"], ["prompt_id", 17], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.690356"], ["updated_at", "2021-05-12 19:16:46.690356"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #older_models should be 0 if there are no previous models for the prompt. 
-----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 21"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 21"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 18 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 21"], ["name", "MyString 21"], ["target_level", 1], ["parent_activity_id", 18], ["created_at", "2021-05-12 19:16:46.695019"], ["updated_at", "2021-05-12 19:16:46.695019"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 18], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.696287"], ["updated_at", "2021-05-12 19:16:46.696287"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 18], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.696287"], ["updated_at", "2021-05-12 19:16:46.696287"], ["id", 18], ["id", 18]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-21' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-21"], ["name", "AutoML-Model-Name"], ["prompt_id", 18], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.699039"], ["updated_at", "2021-05-12 19:16:46.699039"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:46.699039')[0m  [["prompt_id", 18]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #older_models should be 1 if there is a single previous model for the prompt. 
---------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 22"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 22"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 19 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 22"], ["name", "MyString 22"], ["target_level", 1], ["parent_activity_id", 19], ["created_at", "2021-05-12 19:16:46.703648"], ["updated_at", "2021-05-12 19:16:46.703648"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 19], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.704975"], ["updated_at", "2021-05-12 19:16:46.704975"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 19], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.704975"], ["updated_at", "2021-05-12 19:16:46.704975"], ["id", 19], ["id", 19]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-22' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-22"], ["name", "AutoML-Model-Name"], ["prompt_id", 19], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.707706"], ["updated_at", "2021-05-12 19:16:46.707706"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-23' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-23"], ["name", "AutoML-Model-Name"], ["prompt_id", 19], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.709552"], ["updated_at", "2021-05-12 19:16:46.709552"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:46.707706')  [["prompt_id", 19]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:46.709552')[0m  [["prompt_id", 19]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: relationships should belong to prompt. 
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should be valid if labels has at least one item in it. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-24' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should return false and not activate if the active state can not be validated because of labels without corresponding rules. 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 24"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 24"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 20 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 24"], ["name", "MyString 24"], ["target_level", 1], ["parent_activity_id", 20], ["created_at", "2021-05-12 19:16:46.717199"], ["updated_at", "2021-05-12 19:16:46.717199"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 20], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.719593"], ["updated_at", "2021-05-12 19:16:46.719593"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 20], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.719593"], ["updated_at", "2021-05-12 19:16:46.719593"], ["id", 20], ["id", 20]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 20], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2d2752b0-174c-417c-aeca-6e22d181662e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "2d2752b0-174c-417c-aeca-6e22d181662e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.725395"], ["updated_at", "2021-05-12 19:16:46.725395"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 20], ["rule_id", 14], ["created_at", "2021-05-12 19:16:46.726266"], ["updated_at", "2021-05-12 19:16:46.726266"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 20], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '42a0c689-7eec-43c7-b24a-9dccd23b559f' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "42a0c689-7eec-43c7-b24a-9dccd23b559f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.729722"], ["updated_at", "2021-05-12 19:16:46.729722"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 20], ["rule_id", 15], ["created_at", "2021-05-12 19:16:46.730573"], ["updated_at", "2021-05-12 19:16:46.730573"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 20], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c729e176-4f33-45c5-a5dc-aa9765a91b88' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "c729e176-4f33-45c5-a5dc-aa9765a91b88"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.734067"], ["updated_at", "2021-05-12 19:16:46.734067"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 20], ["rule_id", 16], ["created_at", "2021-05-12 19:16:46.734925"], ["updated_at", "2021-05-12 19:16:46.734925"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 14 LIMIT 1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 20]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 14]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 15]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 16]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label1"], ["rule_id", 14], ["created_at", "2021-05-12 19:16:46.738805"], ["updated_at", "2021-05-12 19:16:46.738805"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 15 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label2"], ["rule_id", 15], ["created_at", "2021-05-12 19:16:46.740852"], ["updated_at", "2021-05-12 19:16:46.740852"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 16 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label3"], ["rule_id", 16], ["created_at", "2021-05-12 19:16:46.742769"], ["updated_at", "2021-05-12 19:16:46.742769"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-25' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-25"], ["name", "AutoML-Model-Name"], ["prompt_id", 20], ["state", "inactive"], ["labels", "{no_rule_for_label}"], ["created_at", "2021-05-12 19:16:46.744787"], ["updated_at", "2021-05-12 19:16:46.744787"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1  [["prompt_id", 20]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 20], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 14]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 15]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 16]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-25' AND "comprehension_automl_models"."id" != 22) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 22]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #state_can_be_active should not validate state = active if labels_have_associated_rules is false. 
-----------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 25"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 25"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 21 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 25"], ["name", "MyString 25"], ["target_level", 1], ["parent_activity_id", 21], ["created_at", "2021-05-12 19:16:46.753226"], ["updated_at", "2021-05-12 19:16:46.753226"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 21], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.754710"], ["updated_at", "2021-05-12 19:16:46.754710"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 21], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.754710"], ["updated_at", "2021-05-12 19:16:46.754710"], ["id", 21], ["id", 21]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-26' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-26"], ["name", "AutoML-Model-Name"], ["prompt_id", 21], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:46.758677"], ["updated_at", "2021-05-12 19:16:46.758677"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-26' AND "comprehension_automl_models"."id" != 23) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should require text to be set. 
-----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should not remove existing non-universal assignments. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '18711c76-1ff4-4e5f-9803-c20d81b265e2' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "18711c76-1ff4-4e5f-9803-c20d81b265e2"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.766071"], ["updated_at", "2021-05-12 19:16:46.766071"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '18711c76-1ff4-4e5f-9803-c20d81b265e2' AND "comprehension_rules"."id" != 17) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "18711c76-1ff4-4e5f-9803-c20d81b265e2"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.766071"], ["updated_at", "2021-05-12 19:16:46.766071"], ["id", 17], ["id", 17]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5d85be33-54bf-417d-b37a-eb9eedb51dc3' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5d85be33-54bf-417d-b37a-eb9eedb51dc3"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.770426"], ["updated_at", "2021-05-12 19:16:46.770426"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 26"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 26"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 22 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 26"], ["name", "MyString 26"], ["target_level", 1], ["parent_activity_id", 22], ["created_at", "2021-05-12 19:16:46.773638"], ["updated_at", "2021-05-12 19:16:46.773638"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '5d85be33-54bf-417d-b37a-eb9eedb51dc3' AND "comprehension_rules"."id" != 18) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 22], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.776317"], ["updated_at", "2021-05-12 19:16:46.776317"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 18], ["prompt_id", 22], ["created_at", "2021-05-12 19:16:46.777114"], ["updated_at", "2021-05-12 19:16:46.777114"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 22], ["rule_id", 17], ["created_at", "2021-05-12 19:16:46.778887"], ["updated_at", "2021-05-12 19:16:46.778887"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 22], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.776317"], ["updated_at", "2021-05-12 19:16:46.776317"], ["id", 22], ["id", 22]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should ensure text has a length between 10 and 255. 
--------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should belong to activity. 
-----------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should not add non-universal rules. 
------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b246c456-3e2f-443c-8b4d-80d6f8bedcb5' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "b246c456-3e2f-443c-8b4d-80d6f8bedcb5"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.787032"], ["updated_at", "2021-05-12 19:16:46.787032"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'b246c456-3e2f-443c-8b4d-80d6f8bedcb5' AND "comprehension_rules"."id" != 19) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "b246c456-3e2f-443c-8b4d-80d6f8bedcb5"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.787032"], ["updated_at", "2021-05-12 19:16:46.787032"], ["id", 19], ["id", 19]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '35baf2b8-89a1-4529-ae75-50b4b4335cc2' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "35baf2b8-89a1-4529-ae75-50b4b4335cc2"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.792235"], ["updated_at", "2021-05-12 19:16:46.792235"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 27"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 27"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 23 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 27"], ["name", "MyString 27"], ["target_level", 1], ["parent_activity_id", 23], ["created_at", "2021-05-12 19:16:46.795388"], ["updated_at", "2021-05-12 19:16:46.795388"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 23], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.796616"], ["updated_at", "2021-05-12 19:16:46.796616"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."id" = $2 LIMIT 1  [["prompt_id", 23], ["id", 19]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 23], ["rule_id", 19], ["created_at", "2021-05-12 19:16:46.799812"], ["updated_at", "2021-05-12 19:16:46.799812"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 23], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.796616"], ["updated_at", "2021-05-12 19:16:46.796616"], ["id", 23], ["id", 23]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 23]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should require conjunction to be set. 
------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should not duplicate rule assignments if some exist already. 
-------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '937bf794-44fc-49ab-8c4c-9755373815bc' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "937bf794-44fc-49ab-8c4c-9755373815bc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.807407"], ["updated_at", "2021-05-12 19:16:46.807407"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '937bf794-44fc-49ab-8c4c-9755373815bc' AND "comprehension_rules"."id" != 21) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "937bf794-44fc-49ab-8c4c-9755373815bc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.807407"], ["updated_at", "2021-05-12 19:16:46.807407"], ["id", 21], ["id", 21]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f8861637-6f14-4b4e-98ae-64b01facc6a8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f8861637-6f14-4b4e-98ae-64b01facc6a8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.811642"], ["updated_at", "2021-05-12 19:16:46.811642"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f8861637-6f14-4b4e-98ae-64b01facc6a8' AND "comprehension_rules"."id" != 22) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "f8861637-6f14-4b4e-98ae-64b01facc6a8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.811642"], ["updated_at", "2021-05-12 19:16:46.811642"], ["id", 22], ["id", 22]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 28"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 28"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 24 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 28"], ["name", "MyString 28"], ["target_level", 1], ["parent_activity_id", 24], ["created_at", "2021-05-12 19:16:46.816753"], ["updated_at", "2021-05-12 19:16:46.816753"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '937bf794-44fc-49ab-8c4c-9755373815bc' AND "comprehension_rules"."id" != 21) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 24], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.819836"], ["updated_at", "2021-05-12 19:16:46.819836"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 21], ["prompt_id", 24], ["created_at", "2021-05-12 19:16:46.820727"], ["updated_at", "2021-05-12 19:16:46.820727"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 24], ["rule_id", 22], ["created_at", "2021-05-12 19:16:46.822584"], ["updated_at", "2021-05-12 19:16:46.822584"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 24], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.819836"], ["updated_at", "2021-05-12 19:16:46.819836"], ["id", 24], ["id", 24]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should require activity to be set. 
---------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should ensure inclusion of conjunction in ["because", "but", "so"]. 
------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should ensure inclusion of max_attempts in [3, 4, 5, 6]. 
-------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should have many prompts_rules. 
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should have many rules through prompts_rules. 
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should assign all universal rules to new prompts. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0a59e61f-08dd-4356-b355-f02dce48073b' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "0a59e61f-08dd-4356-b355-f02dce48073b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.836058"], ["updated_at", "2021-05-12 19:16:46.836058"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '0a59e61f-08dd-4356-b355-f02dce48073b' AND "comprehension_rules"."id" != 23) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "0a59e61f-08dd-4356-b355-f02dce48073b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.836058"], ["updated_at", "2021-05-12 19:16:46.836058"], ["id", 23], ["id", 23]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8f9202ad-d604-4afb-92e9-bfd74bdf682c' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "8f9202ad-d604-4afb-92e9-bfd74bdf682c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.841149"], ["updated_at", "2021-05-12 19:16:46.841149"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '8f9202ad-d604-4afb-92e9-bfd74bdf682c' AND "comprehension_rules"."id" != 24) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "8f9202ad-d604-4afb-92e9-bfd74bdf682c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:46.841149"], ["updated_at", "2021-05-12 19:16:46.841149"], ["id", 24], ["id", 24]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 29"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 29"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 25 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 29"], ["name", "MyString 29"], ["target_level", 1], ["parent_activity_id", 25], ["created_at", "2021-05-12 19:16:46.846765"], ["updated_at", "2021-05-12 19:16:46.846765"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 25], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.848090"], ["updated_at", "2021-05-12 19:16:46.848090"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."id" = $2 LIMIT 1  [["prompt_id", 25], ["id", 23]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 25], ["rule_id", 23], ["created_at", "2021-05-12 19:16:46.850576"], ["updated_at", "2021-05-12 19:16:46.850576"]]
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."id" = $2 LIMIT 1  [["prompt_id", 25], ["id", 24]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 25], ["rule_id", 24], ["created_at", "2021-05-12 19:16:46.852802"], ["updated_at", "2021-05-12 19:16:46.852802"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 25], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.848090"], ["updated_at", "2021-05-12 19:16:46.848090"], ["id", 25], ["id", 25]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 25]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
----------------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should have many automl_models. 
----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: serializable_hash should fill out hash with all fields. 
--------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "First Activity"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "First Activity"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 26 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 30"], ["target_level", 8], ["scored_level", "4th grade"], ["parent_activity_id", 26], ["created_at", "2021-05-12 19:16:46.860921"], ["updated_at", "2021-05-12 19:16:46.860921"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 26], ["text", "HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHello"], ["created_at", "2021-05-12 19:16:46.868586"], ["updated_at", "2021-05-12 19:16:46.868586"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 26], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "good work!."], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.870751"], ["updated_at", "2021-05-12 19:16:46.870751"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 26], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "good work!."], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.870751"], ["updated_at", "2021-05-12 19:16:46.870751"], ["id", 26], ["id", 26]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 26]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 26]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should require name to be set. 
-------------------------------------------------------------------------------
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 27 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: associations should have many passages dependent => destroy. 
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: associations should have many prompts dependent => destroy. 
------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: before_destroy should expire all associated Turking Rounds before destroy. 
---------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 30"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 30"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 28 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 30"], ["name", "MyString 31"], ["target_level", 1], ["parent_activity_id", 28], ["created_at", "2021-05-12 19:16:46.895110"], ["updated_at", "2021-05-12 19:16:46.895110"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.7ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'd8878fa1-6ce3-479c-96a2-1b932b8c3354' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 27], ["expires_at", "2021-06-12 19:16:46.901444"], ["uuid", "d8878fa1-6ce3-479c-96a2-1b932b8c3354"], ["created_at", "2021-05-12 19:16:46.903470"], ["updated_at", "2021-05-12 19:16:46.903470"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Load (0.2ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1  [["activity_id", 27]]
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" = 'd8878fa1-6ce3-479c-96a2-1b932b8c3354' AND "comprehension_turking_rounds"."id" != 1) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_turking_rounds" SET "expires_at" = $1, "updated_at" = $2 WHERE "comprehension_turking_rounds"."id" = $3  [["expires_at", "2021-05-12 19:16:46.906268"], ["updated_at", "2021-05-12 19:16:46.907126"], ["id", 1]]
  [1m[36mComprehension::Passage Load (0.1ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 27]]
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 27]]
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1[0m  [["id", 27]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.1ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: dependent destroy should destroy dependent prompts. 
----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 31"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 31"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 29 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 31"], ["name", "MyString 32"], ["target_level", 1], ["parent_activity_id", 29], ["created_at", "2021-05-12 19:16:46.912981"], ["updated_at", "2021-05-12 19:16:46.912981"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 28], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.914406"], ["updated_at", "2021-05-12 19:16:46.914406"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 28], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:46.914406"], ["updated_at", "2021-05-12 19:16:46.914406"], ["id", 27], ["id", 27]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1[0m  [["activity_id", 28]]
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 28]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 28]]
  [1m[35mSQL (0.8ms)[0m  DELETE FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1  [["id", 27]]
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1[0m  [["id", 28]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should require title to be set. 
--------------------------------------------------------------------------------
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 30 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should ensure name has a length between 5 and 100. 
---------------------------------------------------------------------------------------------------
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 31 LIMIT 1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 31]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 31 LIMIT 1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 31]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 31 LIMIT 1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 31]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 31 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should ensure scored_level has a length of at most 100. 
--------------------------------------------------------------------------------------------------------
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 32 LIMIT 1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 32]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 32 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: dependent destroy should destroy dependent passages. 
-----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 32"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 32"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 33 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 32"], ["name", "MyString 33"], ["target_level", 1], ["parent_activity_id", 33], ["created_at", "2021-05-12 19:16:46.944683"], ["updated_at", "2021-05-12 19:16:46.944683"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 29], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:46.946086"], ["updated_at", "2021-05-12 19:16:46.946086"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1[0m  [["activity_id", 29]]
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 29]]
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1[0m  [["id", 2]]
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 29]]
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1[0m  [["id", 29]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Passage Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: create parent activity should set the parent_activity_id if passed in Activity does exist. 
-------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "test name"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 34]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 34 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 33"], ["name", "MyString 34"], ["target_level", 1], ["parent_activity_id", 34], ["created_at", "2021-05-12 19:16:46.953876"], ["updated_at", "2021-05-12 19:16:46.953876"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations parent_activity_id should not be valid if not unique. 
------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 35]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 35 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 34"], ["name", "MyString 35"], ["target_level", 1], ["parent_activity_id", 35], ["created_at", "2021-05-12 19:16:46.961664"], ["updated_at", "2021-05-12 19:16:46.961664"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 35]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 35 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should only allow integers for target_level which are greater than or equal to 1 and less than or equal to 12. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 36 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should require target_level to be set. 
---------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 37 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: create parent activity should set the parent_activity_id to nil if passed in Activity does NOT exist. 
------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["title", "MyString 36"], ["name", "MyString 37"], ["target_level", 1], ["created_at", "2021-05-12 19:16:46.987672"], ["updated_at", "2021-05-12 19:16:46.987672"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: create parent activity should create a new LMS activity if the parent_activity_id is not present. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 37"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 37"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 38 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 37"], ["name", "MyString 38"], ["target_level", 1], ["parent_activity_id", 38], ["created_at", "2021-05-12 19:16:46.992246"], ["updated_at", "2021-05-12 19:16:46.992246"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should ensure title has a length between 5 and 100. 
----------------------------------------------------------------------------------------------------
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "xxxx"]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "xxxx"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 39 LIMIT 1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 39]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 39 LIMIT 1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 39]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 39 LIMIT 1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 39]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 39 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: index with activities where one has an archived parent should return with only the unarchived activity. 
--------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name", "flags") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Archived Activity"], ["flags", "{archived}"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "Unarchived Activity"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 40]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 40 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 39"], ["target_level", 8], ["parent_activity_id", 40], ["created_at", "2021-05-12 19:16:47.016905"], ["updated_at", "2021-05-12 19:16:47.016905"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 41]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 41 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "Second Activity"], ["name", "MyString 40"], ["target_level", 5], ["parent_activity_id", 41], ["created_at", "2021-05-12 19:16:47.019635"], ["updated_at", "2021-05-12 19:16:47.019635"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#index as HTML
  [1m[35mComprehension::Activity Load (1.0ms)[0m  SELECT "comprehension_activities".* FROM "comprehension_activities" LEFT JOIN activities ON comprehension_activities.parent_activity_id = activities.id WHERE (parent_activity_id IS NULL OR NOT 'archived' = ANY(activities.flags))  ORDER BY "comprehension_activities"."name" ASC
  [1m[36mComprehension::Passage Load (0.2ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 35]]
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 35]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 1.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should update passage if valid, return nothing. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 41"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.031291"], ["updated_at", "2021-05-12 19:16:47.031291"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 36], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.032885"], ["updated_at", "2021-05-12 19:16:47.032885"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 36], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.034365"], ["updated_at", "2021-05-12 19:16:47.034365"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 36], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.034365"], ["updated_at", "2021-05-12 19:16:47.034365"], ["id", 28], ["id", 28]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"passages_attributes"=>[{"id"=>"3", "text"=>"GoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbye"}]}, "id"=>"36"}
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 36]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Passage Load (0.2ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1 AND "comprehension_passages"."id" = 3[0m  [["activity_id", 36]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_passages" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_passages"."id" = $3  [["text", "GoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbye"], ["updated_at", "2021-05-12 19:16:47.042526"], ["id", 3]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 0.9ms)
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT  "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1 LIMIT 1  [["id", 3]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: show should raise if not found (to be handled by parent app). 
--------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 42"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.046615"], ["updated_at", "2021-05-12 19:16:47.046615"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 37], ["text", "HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHello"], ["created_at", "2021-05-12 19:16:47.048223"], ["updated_at", "2021-05-12 19:16:47.048223"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 37], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.049732"], ["updated_at", "2021-05-12 19:16:47.049732"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 37], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.049732"], ["updated_at", "2021-05-12 19:16:47.049732"], ["id", 29], ["id", 29]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: rules should 404 if activity is invalid. 
-----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 38"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 38"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 42 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 38"], ["name", "MyString 43"], ["target_level", 1], ["parent_activity_id", 42], ["created_at", "2021-05-12 19:16:47.059767"], ["updated_at", "2021-05-12 19:16:47.059767"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 38], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.061318"], ["updated_at", "2021-05-12 19:16:47.061318"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 38], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.061318"], ["updated_at", "2021-05-12 19:16:47.061318"], ["id", 30], ["id", 30]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 30], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3288ee49-263f-4f91-bffe-ad7aa0c76e60' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "3288ee49-263f-4f91-bffe-ad7aa0c76e60"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.065868"], ["updated_at", "2021-05-12 19:16:47.065868"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 30], ["rule_id", 25], ["created_at", "2021-05-12 19:16:47.066737"], ["updated_at", "2021-05-12 19:16:47.066737"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 38], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.068390"], ["updated_at", "2021-05-12 19:16:47.068390"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#rules as HTML
  Parameters: {"id"=>"99999"}
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a valid record with passage attributes. 
-------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1", "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity - Name", "passages_attributes"=>[{"text"=>"Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello "}]}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity - Name"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.079358"], ["updated_at", "2021-05-12 19:16:47.079358"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("text", "activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["text", "Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello "], ["activity_id", 39], ["created_at", "2021-05-12 19:16:47.080134"], ["updated_at", "2021-05-12 19:16:47.080134"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 39]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 39]]
Completed 201 Created in 6ms (Views: 0.1ms | ActiveRecord: 1.1ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_activities"
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 39]]
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT  "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  ORDER BY "comprehension_passages"."id" ASC LIMIT 1  [["activity_id", 39]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should update record if valid, return nothing. 
------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 44"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.089046"], ["updated_at", "2021-05-12 19:16:47.089046"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 40], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.090478"], ["updated_at", "2021-05-12 19:16:47.090478"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 40], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.091899"], ["updated_at", "2021-05-12 19:16:47.091899"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 40], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.091899"], ["updated_at", "2021-05-12 19:16:47.091899"], ["id", 31], ["id", 31]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"2", "scored_level"=>"5th grade", "target_level"=>"9", "title"=>"New title"}, "id"=>"40"}
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 40]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE ("comprehension_activities"."parent_activity_id" = 2 AND "comprehension_activities"."id" != 40) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_activities" SET "title" = $1, "parent_activity_id" = $2, "target_level" = $3, "scored_level" = $4, "updated_at" = $5 WHERE "comprehension_activities"."id" = $6  [["title", "New title"], ["parent_activity_id", 2], ["target_level", 9], ["scored_level", "5th grade"], ["updated_at", "2021-05-12 19:16:47.098726"], ["id", 40]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.9ms)
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 40]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should update prompt if valid, return nothing. 
------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 45"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.102247"], ["updated_at", "2021-05-12 19:16:47.102247"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 41], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.103789"], ["updated_at", "2021-05-12 19:16:47.103789"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 41], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.105208"], ["updated_at", "2021-05-12 19:16:47.105208"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 41], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.105208"], ["updated_at", "2021-05-12 19:16:47.105208"], ["id", 32], ["id", 32]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"prompts_attributes"=>[{"id"=>"32", "text"=>"this is a good thing."}]}, "id"=>"41"}
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 41]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1 AND "comprehension_prompts"."id" = 32[0m  [["activity_id", 41]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_prompts"."id" = $3  [["text", "this is a good thing."], ["updated_at", "2021-05-12 19:16:47.112301"], ["id", 32]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.8ms)
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 32]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a new parent activity and activity if no parent_activity_id is passed. 
--------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"  [["key", "comprehension"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>nil, "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity", "prompts_attributes"=>[{"text"=>"meat is bad for you.", "conjunction"=>"because"}]}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" = $2 LIMIT 1  [["name", "First Activity"], ["activity_classification_id", 3]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name", "activity_classification_id") VALUES ($1, $2) RETURNING "id"[0m  [["name", "First Activity"], ["activity_classification_id", 3]]
  [1m[35mComprehension::Activity Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 43 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity"], ["target_level", 8], ["scored_level", "4th grade"], ["parent_activity_id", 43], ["created_at", "2021-05-12 19:16:47.125787"], ["updated_at", "2021-05-12 19:16:47.125787"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("conjunction", "text", "max_attempts", "activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 42], ["created_at", "2021-05-12 19:16:47.126706"], ["updated_at", "2021-05-12 19:16:47.126706"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "conjunction" = $1, "text" = $2, "max_attempts" = $3, "activity_id" = $4, "created_at" = $5, "updated_at" = $6, "id" = $7 WHERE "comprehension_prompts"."id" = $8  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 42], ["created_at", "2021-05-12 19:16:47.126706"], ["updated_at", "2021-05-12 19:16:47.126706"], ["id", 33], ["id", 33]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 42]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 42]]
Completed 201 Created in 12ms (Views: 0.1ms | ActiveRecord: 2.4ms)
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 LIMIT 1  [["name", "First Activity"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."title" = $1 LIMIT 1[0m  [["title", "First Activity"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: destroy should destroy record at id. 
-------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 39"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 39"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 44 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 39"], ["name", "MyString 46"], ["target_level", 1], ["parent_activity_id", 44], ["created_at", "2021-05-12 19:16:47.135801"], ["updated_at", "2021-05-12 19:16:47.135801"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 43], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.137176"], ["updated_at", "2021-05-12 19:16:47.137176"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#destroy as HTML
  Parameters: {"id"=>"43"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 43]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Load (0.2ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1  [["activity_id", 43]]
  [1m[36mComprehension::Passage Load (0.1ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 43]]
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1  [["id", 9]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 43]]
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1  [["id", 43]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.1ms)
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 43]]
  [1m[36mComprehension::Passage Load (0.2ms)[0m  [1mSELECT  "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1 LIMIT 1[0m  [["id", 9]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should not update record and return errors as json. 
-----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 47"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.156493"], ["updated_at", "2021-05-12 19:16:47.156493"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 44], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.158591"], ["updated_at", "2021-05-12 19:16:47.158591"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 44], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.160038"], ["updated_at", "2021-05-12 19:16:47.160038"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 44], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.160038"], ["updated_at", "2021-05-12 19:16:47.160038"], ["id", 34], ["id", 34]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"2", "scored_level"=>"5th grade", "target_level"=>"99999999", "title"=>"New title"}, "id"=>"44"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 44]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE ("comprehension_activities"."parent_activity_id" = 2 AND "comprehension_activities"."id" != 44) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should not create an invalid record and return errors as json. 
----------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_activities"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: rules should return rules. 
---------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 40"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 40"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 45 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 40"], ["name", "MyString 48"], ["target_level", 1], ["parent_activity_id", 45], ["created_at", "2021-05-12 19:16:47.180604"], ["updated_at", "2021-05-12 19:16:47.180604"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 45], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.182048"], ["updated_at", "2021-05-12 19:16:47.182048"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 45], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.182048"], ["updated_at", "2021-05-12 19:16:47.182048"], ["id", 35], ["id", 35]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 35], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '939f586f-abda-4e26-b172-b0c9775cbd27' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "939f586f-abda-4e26-b172-b0c9775cbd27"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.187372"], ["updated_at", "2021-05-12 19:16:47.187372"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 35], ["rule_id", 26], ["created_at", "2021-05-12 19:16:47.188473"], ["updated_at", "2021-05-12 19:16:47.188473"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 45], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-05-12 19:16:47.190127"], ["updated_at", "2021-05-12 19:16:47.190127"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#rules as HTML
  Parameters: {"id"=>"45"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 45]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 45]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 35]]
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 26]]
  [1m[35mComprehension::PlagiarismText Load (0.4ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 26]]
  [1m[36mComprehension::Feedback Load (0.4ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 26]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 26]]
  [1m[36mComprehension::RegexRule Load (0.5ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 26]]
Completed 200 OK in 16ms (Views: 0.1ms | ActiveRecord: 4.5ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: index should return successfully - no activities. 
--------------------------------------------------------------------------------------------------
Processing by Comprehension::ActivitiesController#index as HTML
  [1m[35mComprehension::Activity Load (0.6ms)[0m  SELECT "comprehension_activities".* FROM "comprehension_activities" LEFT JOIN activities ON comprehension_activities.parent_activity_id = activities.id WHERE (parent_activity_id IS NULL OR NOT 'archived' = ANY(activities.flags))  ORDER BY "comprehension_activities"."name" ASC
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: index with actitivites should return successfully. 
---------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "First Activity"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "First Activity"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 46 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 49"], ["target_level", 8], ["parent_activity_id", 46], ["created_at", "2021-05-12 19:16:47.219733"], ["updated_at", "2021-05-12 19:16:47.219733"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "Second Activity"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Second Activity"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 47 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Second Activity"], ["name", "MyString 50"], ["target_level", 5], ["parent_activity_id", 47], ["created_at", "2021-05-12 19:16:47.223125"], ["updated_at", "2021-05-12 19:16:47.223125"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#index as HTML
  [1m[36mComprehension::Activity Load (0.6ms)[0m  [1mSELECT "comprehension_activities".* FROM "comprehension_activities" LEFT JOIN activities ON comprehension_activities.parent_activity_id = activities.id WHERE (parent_activity_id IS NULL OR NOT 'archived' = ANY(activities.flags))  ORDER BY "comprehension_activities"."name" ASC[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 46]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 46]]
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 47]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 47]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a valid record and return it as json. 
-----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1", "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity - Name"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity - Name"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.236586"], ["updated_at", "2021-05-12 19:16:47.236586"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Passage Load (0.1ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 48]]
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 48]]
Completed 201 Created in 3ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_activities"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a valid record with prompt attributes. 
------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1", "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity - Name", "prompts_attributes"=>[{"text"=>"meat is bad for you.", "conjunction"=>"because"}]}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity - Name"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.245834"], ["updated_at", "2021-05-12 19:16:47.245834"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("conjunction", "text", "max_attempts", "activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 49], ["created_at", "2021-05-12 19:16:47.246560"], ["updated_at", "2021-05-12 19:16:47.246560"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "conjunction" = $1, "text" = $2, "max_attempts" = $3, "activity_id" = $4, "created_at" = $5, "updated_at" = $6, "id" = $7 WHERE "comprehension_prompts"."id" = $8  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 49], ["created_at", "2021-05-12 19:16:47.246560"], ["updated_at", "2021-05-12 19:16:47.246560"], ["id", 36], ["id", 36]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 49]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 49]]
Completed 201 Created in 6ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_activities"
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 49]]
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["activity_id", 49]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: show should return json if found. 
----------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 51"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-05-12 19:16:47.256831"], ["updated_at", "2021-05-12 19:16:47.256831"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 50], ["text", "HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHello"], ["created_at", "2021-05-12 19:16:47.258677"], ["updated_at", "2021-05-12 19:16:47.258677"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 50], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.260237"], ["updated_at", "2021-05-12 19:16:47.260237"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 50], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.260237"], ["updated_at", "2021-05-12 19:16:47.260237"], ["id", 37], ["id", 37]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#show as HTML
  Parameters: {"id"=>"50"}
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 50]]
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 50]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 50]]
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should require text to be set. 
-------------------------------------------------------------------------------
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should ensure text has a length between 10 and 500. 
----------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should require rule to be set. 
-------------------------------------------------------------------------------
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 3 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: relationships should belong to rule. 
-------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should only allow integers for order which are greater than or equal to 0. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Feedback Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = -1 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should require case sensitive unique value for order scoped to rule_id. 
------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Feedback Load (0.5ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks"  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '31a781cb-520c-40a0-9568-949bbc7b4036' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "31a781cb-520c-40a0-9568-949bbc7b4036"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.297722"], ["updated_at", "2021-05-12 19:16:47.297722"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 0], ["rule_id", 27], ["created_at", "2021-05-12 19:16:47.298723"], ["updated_at", "2021-05-12 19:16:47.298723"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 27) LIMIT 1
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks"[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 28]]
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 28) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------
Comprehension::PassageTest: test_: validations should require activity to be set. 
----------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------
Comprehension::PassageTest: test_: validations should ensure text has a length of at least 50. 
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Comprehension::PassageTest: test_: validations should require text to be set. 
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------
Comprehension::PassageTest: test_: relations should belong to activity. 
------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: relationships should belong to turking_round. 
-----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: validations should require turking_round_id to be set. 
--------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.7ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: validations should require case sensitive unique value for activity_session_uid. 
----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  [1mSELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions"  ORDER BY "comprehension_turking_round_activity_sessions"."id" ASC LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_turking_round_activity_sessions" ("activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["activity_session_uid", "a"], ["created_at", "2021-05-12 19:16:47.325003"], ["updated_at", "2021-05-12 19:16:47.325003"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'a' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: validations should require activity_session_uid to be set. 
------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should validate presence of uuid on any update call. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 41"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 41"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 48 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 41"], ["name", "MyString 52"], ["target_level", 1], ["parent_activity_id", 48], ["created_at", "2021-05-12 19:16:47.334521"], ["updated_at", "2021-05-12 19:16:47.334521"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'dca1442f-e708-4966-85a3-b6e72ad89d23' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 51], ["expires_at", "2021-06-12 19:16:47.335689"], ["uuid", "dca1442f-e708-4966-85a3-b6e72ad89d23"], ["created_at", "2021-05-12 19:16:47.337114"], ["updated_at", "2021-05-12 19:16:47.337114"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 42"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 42"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 49 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 42"], ["name", "MyString 53"], ["target_level", 1], ["parent_activity_id", 49], ["created_at", "2021-05-12 19:16:47.340373"], ["updated_at", "2021-05-12 19:16:47.340373"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '5790c4c6-4004-466a-8fd0-b60e3aee8e6d' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 52], ["expires_at", "2021-06-12 19:16:47.341209"], ["uuid", "5790c4c6-4004-466a-8fd0-b60e3aee8e6d"], ["created_at", "2021-05-12 19:16:47.342208"], ["updated_at", "2021-05-12 19:16:47.342208"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" IS NULL AND "comprehension_turking_rounds"."id" != 3) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should require case sensitive unique value for uuid. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 43"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 43"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 50 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 43"], ["name", "MyString 54"], ["target_level", 1], ["parent_activity_id", 50], ["created_at", "2021-05-12 19:16:47.347053"], ["updated_at", "2021-05-12 19:16:47.347053"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'c85c3d13-1e09-4146-a3f4-166eb01918ea' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 53], ["expires_at", "2021-06-12 19:16:47.347891"], ["uuid", "c85c3d13-1e09-4146-a3f4-166eb01918ea"], ["created_at", "2021-05-12 19:16:47.348883"], ["updated_at", "2021-05-12 19:16:47.348883"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.3ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds"  ORDER BY "comprehension_turking_rounds"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'c85c3d13-1e09-4146-a3f4-166eb01918ea' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: relationships should belong to activity. 
---------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should allow updates to expires_at to be in the past even though creates should not. 
-----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 44"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 44"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 51 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 44"], ["name", "MyString 55"], ["target_level", 1], ["parent_activity_id", 51], ["created_at", "2021-05-12 19:16:47.356923"], ["updated_at", "2021-05-12 19:16:47.356923"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '2ee7f5e2-f080-42f8-95d7-36d567942a7f' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 54], ["expires_at", "2021-06-12 19:16:47.358220"], ["uuid", "2ee7f5e2-f080-42f8-95d7-36d567942a7f"], ["created_at", "2021-05-12 19:16:47.359492"], ["updated_at", "2021-05-12 19:16:47.359492"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 45"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 45"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 52 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 45"], ["name", "MyString 56"], ["target_level", 1], ["parent_activity_id", 52], ["created_at", "2021-05-12 19:16:47.362441"], ["updated_at", "2021-05-12 19:16:47.362441"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'd28414a7-f951-469d-9233-c6f15fa8ebec' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 55], ["expires_at", "2021-06-12 19:16:47.363269"], ["uuid", "d28414a7-f951-469d-9233-c6f15fa8ebec"], ["created_at", "2021-05-12 19:16:47.364263"], ["updated_at", "2021-05-12 19:16:47.364263"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" = 'd28414a7-f951-469d-9233-c6f15fa8ebec' AND "comprehension_turking_rounds"."id" != 6) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should set a default uuid when creating a new record. 
----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 46"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 46"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 53 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 46"], ["name", "MyString 57"], ["target_level", 1], ["parent_activity_id", 53], ["created_at", "2021-05-12 19:16:47.368615"], ["updated_at", "2021-05-12 19:16:47.368615"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '9dd6b3aa-95b8-494f-b9ca-c67168c125b1' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 56], ["expires_at", "2021-06-12 19:16:47.369462"], ["uuid", "9dd6b3aa-95b8-494f-b9ca-c67168c125b1"], ["created_at", "2021-05-12 19:16:47.370464"], ["updated_at", "2021-05-12 19:16:47.370464"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 47"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 47"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 54 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 47"], ["name", "MyString 58"], ["target_level", 1], ["parent_activity_id", 54], ["created_at", "2021-05-12 19:16:47.374389"], ["updated_at", "2021-05-12 19:16:47.374389"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'fb3061c1-09b2-47ce-beea-eeff00e911ec' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 57], ["expires_at", "2021-06-12 19:16:47.375363"], ["uuid", "fb3061c1-09b2-47ce-beea-eeff00e911ec"], ["created_at", "2021-05-12 19:16:47.376532"], ["updated_at", "2021-05-12 19:16:47.376532"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should make uuid read-only. 
--------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 48"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 48"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 55 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 48"], ["name", "MyString 59"], ["target_level", 1], ["parent_activity_id", 55], ["created_at", "2021-05-12 19:16:47.380536"], ["updated_at", "2021-05-12 19:16:47.380536"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'ad390c6b-7d8c-47a4-bbeb-f1db3fe0623a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 58], ["expires_at", "2021-06-12 19:16:47.381453"], ["uuid", "ad390c6b-7d8c-47a4-bbeb-f1db3fe0623a"], ["created_at", "2021-05-12 19:16:47.382668"], ["updated_at", "2021-05-12 19:16:47.382668"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should require expires_at to be set. 
-----------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 49"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 49"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 56 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 49"], ["name", "MyString 60"], ["target_level", 1], ["parent_activity_id", 56], ["created_at", "2021-05-12 19:16:47.386945"], ["updated_at", "2021-05-12 19:16:47.386945"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '240303cc-8b93-4ed7-a17a-9b30136a4208' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 59], ["expires_at", "2021-06-12 19:16:47.388035"], ["uuid", "240303cc-8b93-4ed7-a17a-9b30136a4208"], ["created_at", "2021-05-12 19:16:47.389314"], ["updated_at", "2021-05-12 19:16:47.389314"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '2f63a4c1-1f35-4ab2-91a1-aa7d7297fd9f' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should ensure expires_at is a future date on create. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 50"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 50"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 57 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 50"], ["name", "MyString 61"], ["target_level", 1], ["parent_activity_id", 57], ["created_at", "2021-05-12 19:16:47.395477"], ["updated_at", "2021-05-12 19:16:47.395477"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '9b078147-5d7f-4199-a529-c2929eababc4' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 60], ["expires_at", "2021-06-12 19:16:47.396324"], ["uuid", "9b078147-5d7f-4199-a529-c2929eababc4"], ["created_at", "2021-05-12 19:16:47.397422"], ["updated_at", "2021-05-12 19:16:47.397422"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '02db6715-4557-47b9-90e4-abf852e943ec' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should require activity_id to be set. 
------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 52"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 52"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 58 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 52"], ["name", "MyString 63"], ["target_level", 1], ["parent_activity_id", 58], ["created_at", "2021-05-12 19:16:47.402513"], ["updated_at", "2021-05-12 19:16:47.402513"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '28b1657d-08a8-492f-afe5-4f5e5463abe9' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 61], ["expires_at", "2021-06-12 19:16:47.412838"], ["uuid", "28b1657d-08a8-492f-afe5-4f5e5463abe9"], ["created_at", "2021-05-12 19:16:47.414241"], ["updated_at", "2021-05-12 19:16:47.414241"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '77fbc22f-0f1e-4359-bd60-358706705629' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismCheckTest: test_: #feedback_object should return appropriate feedback attributes if there is plagiarism. 
----------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '599f878a-0d6c-4d0b-8800-c023250cf73f' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "599f878a-0d6c-4d0b-8800-c023250cf73f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.420865"], ["updated_at", "2021-05-12 19:16:47.420865"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismCheckTest: test_: #feedback_object should return appropriate feedback when there is no plagiarism. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '24ea6b54-245d-4313-b114-352807464033' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "24ea6b54-245d-4313-b114-352807464033"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.427970"], ["updated_at", "2021-05-12 19:16:47.427970"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '68d1822b-d0e3-44e6-9ac5-74ebc3276294' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "68d1822b-d0e3-44e6-9ac5-74ebc3276294"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "t"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.430365"], ["updated_at", "2021-05-12 19:16:47.430365"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["optimal", "t"], ["rule_type", "plagiarism"]]
  [1m[35m (0.3ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 30]]
  [1m[36mComprehension::PlagiarismText Load (0.2ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 30]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 30]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 30]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 30]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #automl should return 404 if prompt id does not exist. 
-----------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 53"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 53"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 59 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 53"], ["name", "MyString 64"], ["target_level", 1], ["parent_activity_id", 59], ["created_at", "2021-05-12 19:16:47.448751"], ["updated_at", "2021-05-12 19:16:47.448751"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 62], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.450437"], ["updated_at", "2021-05-12 19:16:47.450437"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 62], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.450437"], ["updated_at", "2021-05-12 19:16:47.450437"], ["id", 38], ["id", 38]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6d89a4ad-dc0c-44ca-942b-cd097ad7084c' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "6d89a4ad-dc0c-44ca-942b-cd097ad7084c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.456774"], ["updated_at", "2021-05-12 19:16:47.456774"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fa26083a-d01d-43db-8fb8-93cd723f18ef' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "fa26083a-d01d-43db-8fb8-93cd723f18ef"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.459671"], ["updated_at", "2021-05-12 19:16:47.459671"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 32], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.464763"], ["updated_at", "2021-05-12 19:16:47.464763"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 38], ["rule_id", 31], ["created_at", "2021-05-12 19:16:47.466903"], ["updated_at", "2021-05-12 19:16:47.466903"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 38], ["rule_id", 32], ["created_at", "2021-05-12 19:16:47.468092"], ["updated_at", "2021-05-12 19:16:47.468092"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 31], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.471651"], ["updated_at", "2021-05-12 19:16:47.471651"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 31) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 31], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.474915"], ["updated_at", "2021-05-12 19:16:47.474915"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 31) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 31], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.477109"], ["updated_at", "2021-05-12 19:16:47.477109"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#automl as HTML
  Parameters: {"entry"=>"some text", "prompt_id"=>"1038", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 1038]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 13ms (Views: 11.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: plagiarism should return successfully. 
-------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 54"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 54"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 60 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 54"], ["name", "MyString 65"], ["target_level", 1], ["parent_activity_id", 60], ["created_at", "2021-05-12 19:16:47.498276"], ["updated_at", "2021-05-12 19:16:47.498276"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 63], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.499808"], ["updated_at", "2021-05-12 19:16:47.499808"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 63], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.499808"], ["updated_at", "2021-05-12 19:16:47.499808"], ["id", 39], ["id", 39]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4eda3819-e7fb-4901-b944-d27ee7427558' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "4eda3819-e7fb-4901-b944-d27ee7427558"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.503856"], ["updated_at", "2021-05-12 19:16:47.503856"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3690f6ae-d329-4d69-a7d9-325e30dafa88' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "3690f6ae-d329-4d69-a7d9-325e30dafa88"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.506352"], ["updated_at", "2021-05-12 19:16:47.506352"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 34], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.507874"], ["updated_at", "2021-05-12 19:16:47.507874"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 39], ["rule_id", 33], ["created_at", "2021-05-12 19:16:47.509281"], ["updated_at", "2021-05-12 19:16:47.509281"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 39], ["rule_id", 34], ["created_at", "2021-05-12 19:16:47.510366"], ["updated_at", "2021-05-12 19:16:47.510366"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 33], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.511390"], ["updated_at", "2021-05-12 19:16:47.511390"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 33) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 33], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.513468"], ["updated_at", "2021-05-12 19:16:47.513468"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 33) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 33], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.515312"], ["updated_at", "2021-05-12 19:16:47.515312"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"No plagiarism here.", "prompt_id"=>"39", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 39]]
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["prompt_id", 39], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 33]]
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["prompt_id", 39], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."order" = $2 LIMIT 1  [["rule_id", 33], ["order", 0]]
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 1.4ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: plagiarism should return 404 if prompt id does not exist. 
--------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 55"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 55"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 61 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 55"], ["name", "MyString 66"], ["target_level", 1], ["parent_activity_id", 61], ["created_at", "2021-05-12 19:16:47.528359"], ["updated_at", "2021-05-12 19:16:47.528359"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 64], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.529640"], ["updated_at", "2021-05-12 19:16:47.529640"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 64], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.529640"], ["updated_at", "2021-05-12 19:16:47.529640"], ["id", 40], ["id", 40]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '554d5760-d636-4df2-8a24-a42e6ca4b4cc' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "554d5760-d636-4df2-8a24-a42e6ca4b4cc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.532969"], ["updated_at", "2021-05-12 19:16:47.532969"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8f970009-7442-4535-99ee-9e77a806a515' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "8f970009-7442-4535-99ee-9e77a806a515"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.535351"], ["updated_at", "2021-05-12 19:16:47.535351"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 36], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.537408"], ["updated_at", "2021-05-12 19:16:47.537408"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 40], ["rule_id", 35], ["created_at", "2021-05-12 19:16:47.539106"], ["updated_at", "2021-05-12 19:16:47.539106"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 40], ["rule_id", 36], ["created_at", "2021-05-12 19:16:47.540431"], ["updated_at", "2021-05-12 19:16:47.540431"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 35], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.541877"], ["updated_at", "2021-05-12 19:16:47.541877"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 35) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 35], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.544014"], ["updated_at", "2021-05-12 19:16:47.544014"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 35) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 35], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.545838"], ["updated_at", "2021-05-12 19:16:47.545838"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"No plagiarism here.", "prompt_id"=>"100", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 100]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return successfully. 
--------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 56"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 56"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 62 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 56"], ["name", "MyString 67"], ["target_level", 1], ["parent_activity_id", 62], ["created_at", "2021-05-12 19:16:47.554605"], ["updated_at", "2021-05-12 19:16:47.554605"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 65], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.556270"], ["updated_at", "2021-05-12 19:16:47.556270"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 65], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.556270"], ["updated_at", "2021-05-12 19:16:47.556270"], ["id", 41], ["id", 41]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cf3a46d6-bb0e-4d81-9de9-addf83fdbccf' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "cf3a46d6-bb0e-4d81-9de9-addf83fdbccf"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.559929"], ["updated_at", "2021-05-12 19:16:47.559929"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5c207626-c10a-4ef3-9fc0-dbdff1153cc8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5c207626-c10a-4ef3-9fc0-dbdff1153cc8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.562356"], ["updated_at", "2021-05-12 19:16:47.562356"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 38], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.563936"], ["updated_at", "2021-05-12 19:16:47.563936"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 41], ["rule_id", 37], ["created_at", "2021-05-12 19:16:47.565363"], ["updated_at", "2021-05-12 19:16:47.565363"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 41], ["rule_id", 38], ["created_at", "2021-05-12 19:16:47.566661"], ["updated_at", "2021-05-12 19:16:47.566661"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 37], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.567898"], ["updated_at", "2021-05-12 19:16:47.567898"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 37) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 37], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.569947"], ["updated_at", "2021-05-12 19:16:47.569947"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 37) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 37], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.571844"], ["updated_at", "2021-05-12 19:16:47.571844"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"no regex problems here.", "prompt_id"=>"41", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"rules-based-1"}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 41]]
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 41], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.3ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 38]]
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 41], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 38]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 41], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 38]]
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 41], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 38]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["optimal", "t"], ["rule_type", "rules-based-1"]]
Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 2.9ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #automl should return feedback payloads based on the lib matched_rule value. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 57"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 57"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 63 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 57"], ["name", "MyString 68"], ["target_level", 1], ["parent_activity_id", 63], ["created_at", "2021-05-12 19:16:47.592437"], ["updated_at", "2021-05-12 19:16:47.592437"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 66], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.593715"], ["updated_at", "2021-05-12 19:16:47.593715"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 66], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.593715"], ["updated_at", "2021-05-12 19:16:47.593715"], ["id", 42], ["id", 42]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a9d7cc03-66cd-4e0e-93ce-3c27871f08e7' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "a9d7cc03-66cd-4e0e-93ce-3c27871f08e7"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.597153"], ["updated_at", "2021-05-12 19:16:47.597153"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '790393f4-63f4-409a-8860-3c528b047969' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "790393f4-63f4-409a-8860-3c528b047969"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.599491"], ["updated_at", "2021-05-12 19:16:47.599491"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 40], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.601143"], ["updated_at", "2021-05-12 19:16:47.601143"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 42], ["rule_id", 39], ["created_at", "2021-05-12 19:16:47.602601"], ["updated_at", "2021-05-12 19:16:47.602601"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 42], ["rule_id", 40], ["created_at", "2021-05-12 19:16:47.603730"], ["updated_at", "2021-05-12 19:16:47.603730"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 39], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.605042"], ["updated_at", "2021-05-12 19:16:47.605042"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 39) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 39], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.607300"], ["updated_at", "2021-05-12 19:16:47.607300"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 39) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 39], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.609132"], ["updated_at", "2021-05-12 19:16:47.609132"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#automl as HTML
  Parameters: {"entry"=>"entry", "prompt_id"=>"42", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 42]]
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m  [["prompt_id", 42], ["state", "active"]]
  [1m[35mComprehension::Highlight Load (0.3ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1  [["feedback_id", 10]]
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 2.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #spelling should return 500 if there is an error on the bing API. 
----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 58"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 58"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 64 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 58"], ["name", "MyString 69"], ["target_level", 1], ["parent_activity_id", 64], ["created_at", "2021-05-12 19:16:47.623402"], ["updated_at", "2021-05-12 19:16:47.623402"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 67], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.625305"], ["updated_at", "2021-05-12 19:16:47.625305"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 67], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.625305"], ["updated_at", "2021-05-12 19:16:47.625305"], ["id", 43], ["id", 43]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '203a768e-11dc-40da-9652-b9540a4b9714' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "203a768e-11dc-40da-9652-b9540a4b9714"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.629507"], ["updated_at", "2021-05-12 19:16:47.629507"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '42abcb76-669c-4969-95b7-e5dc71029408' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "42abcb76-669c-4969-95b7-e5dc71029408"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.631969"], ["updated_at", "2021-05-12 19:16:47.631969"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 42], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.633500"], ["updated_at", "2021-05-12 19:16:47.633500"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 43], ["rule_id", 41], ["created_at", "2021-05-12 19:16:47.634898"], ["updated_at", "2021-05-12 19:16:47.634898"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 43], ["rule_id", 42], ["created_at", "2021-05-12 19:16:47.636017"], ["updated_at", "2021-05-12 19:16:47.636017"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 41], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.637061"], ["updated_at", "2021-05-12 19:16:47.637061"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 41) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 41], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.639136"], ["updated_at", "2021-05-12 19:16:47.639136"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 41) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 41], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.641180"], ["updated_at", "2021-05-12 19:16:47.641180"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#spelling as HTML
  Parameters: {"entry"=>"there is no spelling error here", "prompt_id"=>"43", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 43]]
  Rendered text template (0.0ms)
Completed 500 Internal Server Error in 13ms (Views: 0.3ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return successfully when there is regex feedback. 
-------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 59"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 59"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 65 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 59"], ["name", "MyString 70"], ["target_level", 1], ["parent_activity_id", 65], ["created_at", "2021-05-12 19:16:47.662416"], ["updated_at", "2021-05-12 19:16:47.662416"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 68], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.663683"], ["updated_at", "2021-05-12 19:16:47.663683"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 68], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.663683"], ["updated_at", "2021-05-12 19:16:47.663683"], ["id", 44], ["id", 44]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c76ddcfe-e636-40de-bad7-10a6d63ad698' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "c76ddcfe-e636-40de-bad7-10a6d63ad698"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.668078"], ["updated_at", "2021-05-12 19:16:47.668078"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a0deae9f-01f1-4df4-8e0c-58791797e547' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "a0deae9f-01f1-4df4-8e0c-58791797e547"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.670727"], ["updated_at", "2021-05-12 19:16:47.670727"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 44], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.672658"], ["updated_at", "2021-05-12 19:16:47.672658"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 44], ["rule_id", 43], ["created_at", "2021-05-12 19:16:47.674046"], ["updated_at", "2021-05-12 19:16:47.674046"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 44], ["rule_id", 44], ["created_at", "2021-05-12 19:16:47.675191"], ["updated_at", "2021-05-12 19:16:47.675191"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 43], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.676395"], ["updated_at", "2021-05-12 19:16:47.676395"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 43) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 43], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.688094"], ["updated_at", "2021-05-12 19:16:47.688094"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 43) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 43], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.690662"], ["updated_at", "2021-05-12 19:16:47.690662"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"test regex response", "prompt_id"=>"44", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"rules-based-1"}
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 44]]
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 44], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 44]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1[0m  [["rule_id", 44]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return 404 if rule_type does not exist. 
---------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 60"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 60"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 66 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 60"], ["name", "MyString 71"], ["target_level", 1], ["parent_activity_id", 66], ["created_at", "2021-05-12 19:16:47.701534"], ["updated_at", "2021-05-12 19:16:47.701534"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 69], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.702825"], ["updated_at", "2021-05-12 19:16:47.702825"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 69], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.702825"], ["updated_at", "2021-05-12 19:16:47.702825"], ["id", 45], ["id", 45]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '30f52315-c6b8-4279-af32-76a7aa510e6f' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "30f52315-c6b8-4279-af32-76a7aa510e6f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.706691"], ["updated_at", "2021-05-12 19:16:47.706691"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8b813576-96ad-4cff-8850-1ad0bc52a271' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "8b813576-96ad-4cff-8850-1ad0bc52a271"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.709396"], ["updated_at", "2021-05-12 19:16:47.709396"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 46], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.711329"], ["updated_at", "2021-05-12 19:16:47.711329"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 45], ["rule_id", 45], ["created_at", "2021-05-12 19:16:47.712697"], ["updated_at", "2021-05-12 19:16:47.712697"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 45], ["rule_id", 46], ["created_at", "2021-05-12 19:16:47.713819"], ["updated_at", "2021-05-12 19:16:47.713819"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 45], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.714985"], ["updated_at", "2021-05-12 19:16:47.714985"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 45) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 45], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.717494"], ["updated_at", "2021-05-12 19:16:47.717494"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 45) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 45], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.720049"], ["updated_at", "2021-05-12 19:16:47.720049"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"no regex problems here.", "prompt_id"=>"100", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"not-rule-type"}
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 100]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: plagiarism should return successfully when there is plagiarism. 
--------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 61"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 61"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 67 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 61"], ["name", "MyString 72"], ["target_level", 1], ["parent_activity_id", 67], ["created_at", "2021-05-12 19:16:47.728917"], ["updated_at", "2021-05-12 19:16:47.728917"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 70], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.730186"], ["updated_at", "2021-05-12 19:16:47.730186"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 70], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.730186"], ["updated_at", "2021-05-12 19:16:47.730186"], ["id", 46], ["id", 46]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a8492df1-4c34-498b-bfff-1add0ffb7d68' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "a8492df1-4c34-498b-bfff-1add0ffb7d68"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.733583"], ["updated_at", "2021-05-12 19:16:47.733583"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5ac92036-cc36-467d-8ccf-5699dc2dfcf9' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "5ac92036-cc36-467d-8ccf-5699dc2dfcf9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.735967"], ["updated_at", "2021-05-12 19:16:47.735967"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 48], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.737492"], ["updated_at", "2021-05-12 19:16:47.737492"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 46], ["rule_id", 47], ["created_at", "2021-05-12 19:16:47.738814"], ["updated_at", "2021-05-12 19:16:47.738814"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 46], ["rule_id", 48], ["created_at", "2021-05-12 19:16:47.739840"], ["updated_at", "2021-05-12 19:16:47.739840"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 47], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.740955"], ["updated_at", "2021-05-12 19:16:47.740955"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 47) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 47], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.743053"], ["updated_at", "2021-05-12 19:16:47.743053"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 47) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 47], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.745561"], ["updated_at", "2021-05-12 19:16:47.745561"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"bla bla bla do not plagiarize this text please", "prompt_id"=>"46", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 46]]
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["prompt_id", 46], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::PlagiarismText Load (0.2ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 47]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["prompt_id", 46], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."order" = $2 LIMIT 1[0m  [["rule_id", 47], ["order", 0]]
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 1.4ms)
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"bla bla bla do not plagiarize this text please", "prompt_id"=>"46", "session_id"=>"1", "previous_feedback"=>[{"feedback"=>"here is our first feedback", "feedback_type"=>"plagiarism", "optimal"=>false, "response_id"=>"", "entry"=>"bla bla bla do not plagiarize this text please", "concept_uid"=>"ConceptUID", "rule_uid"=>"a8492df1-4c34-498b-bfff-1add0ffb7d68", "highlight"=>[{"type"=>"response", "text"=>"do not plagiarize this text please", "category"=>""}, {"type"=>"passage", "text"=>"do not plagiarize this text please", "category"=>""}]}]}
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 46]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["prompt_id", 46], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 47]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["prompt_id", 46], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."order" = $2 LIMIT 1  [["rule_id", 47], ["order", 1]]
Completed 200 OK in 3ms (Views: 0.0ms | ActiveRecord: 2.5ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #automl should return 404 if prompt has no associated automl_model. 
------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 62"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 62"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 68 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 62"], ["name", "MyString 73"], ["target_level", 1], ["parent_activity_id", 68], ["created_at", "2021-05-12 19:16:47.762761"], ["updated_at", "2021-05-12 19:16:47.762761"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 71], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.764027"], ["updated_at", "2021-05-12 19:16:47.764027"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 71], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.764027"], ["updated_at", "2021-05-12 19:16:47.764027"], ["id", 47], ["id", 47]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd843fd2a-4fa4-463f-ac8c-7ebe4d666ec2' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "d843fd2a-4fa4-463f-ac8c-7ebe4d666ec2"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.767618"], ["updated_at", "2021-05-12 19:16:47.767618"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd7b17ff6-1936-4995-b5e6-6cfb104adecc' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "d7b17ff6-1936-4995-b5e6-6cfb104adecc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.769953"], ["updated_at", "2021-05-12 19:16:47.769953"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 50], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.771541"], ["updated_at", "2021-05-12 19:16:47.771541"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 47], ["rule_id", 49], ["created_at", "2021-05-12 19:16:47.772881"], ["updated_at", "2021-05-12 19:16:47.772881"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 47], ["rule_id", 50], ["created_at", "2021-05-12 19:16:47.774070"], ["updated_at", "2021-05-12 19:16:47.774070"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 49], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.775260"], ["updated_at", "2021-05-12 19:16:47.775260"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 49) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 49], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.777245"], ["updated_at", "2021-05-12 19:16:47.777245"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 49) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 49], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.779179"], ["updated_at", "2021-05-12 19:16:47.779179"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#automl as HTML
  Parameters: {"entry"=>"some text", "prompt_id"=>"47", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 47]]
  [1m[35mComprehension::AutomlModel Load (0.3ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 47], ["state", "active"]]
  Rendered text template (0.0ms)
Completed 404 Not Found in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return 404 if prompt id does not exist. 
---------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 63"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 63"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 69 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 63"], ["name", "MyString 74"], ["target_level", 1], ["parent_activity_id", 69], ["created_at", "2021-05-12 19:16:47.791309"], ["updated_at", "2021-05-12 19:16:47.791309"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 72], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.792911"], ["updated_at", "2021-05-12 19:16:47.792911"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 72], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.792911"], ["updated_at", "2021-05-12 19:16:47.792911"], ["id", 48], ["id", 48]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '96bf72bf-6147-4807-8c02-d9328a728e95' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "96bf72bf-6147-4807-8c02-d9328a728e95"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.796907"], ["updated_at", "2021-05-12 19:16:47.796907"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c2920815-11b8-4ebb-92cd-97c4f36544d6' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "c2920815-11b8-4ebb-92cd-97c4f36544d6"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.799434"], ["updated_at", "2021-05-12 19:16:47.799434"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 52], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.801288"], ["updated_at", "2021-05-12 19:16:47.801288"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 48], ["rule_id", 51], ["created_at", "2021-05-12 19:16:47.802919"], ["updated_at", "2021-05-12 19:16:47.802919"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 48], ["rule_id", 52], ["created_at", "2021-05-12 19:16:47.804091"], ["updated_at", "2021-05-12 19:16:47.804091"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 51], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.805334"], ["updated_at", "2021-05-12 19:16:47.805334"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 51) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 51], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.807358"], ["updated_at", "2021-05-12 19:16:47.807358"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 51) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 51], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.809307"], ["updated_at", "2021-05-12 19:16:47.809307"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"no regex problems here.", "prompt_id"=>"100", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"rules-based-1"}
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 100]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #spelling should return correct spelling feedback when endpoint returns 200. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 64"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 64"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 70 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 64"], ["name", "MyString 75"], ["target_level", 1], ["parent_activity_id", 70], ["created_at", "2021-05-12 19:16:47.818028"], ["updated_at", "2021-05-12 19:16:47.818028"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 73], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.819523"], ["updated_at", "2021-05-12 19:16:47.819523"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 73], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.819523"], ["updated_at", "2021-05-12 19:16:47.819523"], ["id", 49], ["id", 49]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '57da4b05-fa36-4b46-9606-6bd81e8d8145' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "57da4b05-fa36-4b46-9606-6bd81e8d8145"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.823774"], ["updated_at", "2021-05-12 19:16:47.823774"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1032065e-0191-45d8-ac25-bfc31517fe35' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "1032065e-0191-45d8-ac25-bfc31517fe35"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.826223"], ["updated_at", "2021-05-12 19:16:47.826223"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 54], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:47.827799"], ["updated_at", "2021-05-12 19:16:47.827799"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 49], ["rule_id", 53], ["created_at", "2021-05-12 19:16:47.829346"], ["updated_at", "2021-05-12 19:16:47.829346"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 49], ["rule_id", 54], ["created_at", "2021-05-12 19:16:47.830734"], ["updated_at", "2021-05-12 19:16:47.830734"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 53], ["text", "do not plagiarize this text please"], ["created_at", "2021-05-12 19:16:47.832085"], ["updated_at", "2021-05-12 19:16:47.832085"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 53) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 53], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:47.834585"], ["updated_at", "2021-05-12 19:16:47.834585"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 53) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 53], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:47.836785"], ["updated_at", "2021-05-12 19:16:47.836785"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#spelling as HTML
  Parameters: {"entry"=>"test spelin error", "prompt_id"=>"49", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 49]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["rule_type", "spelling"]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #feedback_object should return appropriate error if the endpoint returns an error. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #feedback_object should return appropriate feedback attributes if there is no spelling error. 
---------------------------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["rule_type", "spelling"]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #feedback_object should return appropriate feedback attributes if there is a spelling error. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["rule_type", "spelling"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should require rule to be set. 
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '13da3757-96f2-4479-b2f8-f462fb20e129' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "13da3757-96f2-4479-b2f8-f462fb20e129"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.856029"], ["updated_at", "2021-05-12 19:16:47.856029"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 55 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 55], ["created_at", "2021-05-12 19:16:47.858343"], ["updated_at", "2021-05-12 19:16:47.858343"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------
Comprehension::LabelTest: test_: relationships should belong to rule. 
----------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations #name_unique_for_prompt should not allow a label to be created if its name collides with another on the prompt. 
-------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8999470b-166d-40f7-829d-ec34c67c068c' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "8999470b-166d-40f7-829d-ec34c67c068c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.864072"], ["updated_at", "2021-05-12 19:16:47.864072"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 56 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 56], ["created_at", "2021-05-12 19:16:47.866204"], ["updated_at", "2021-05-12 19:16:47.866204"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 65"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 65"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 71 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 65"], ["name", "MyString 76"], ["target_level", 1], ["parent_activity_id", 71], ["created_at", "2021-05-12 19:16:47.869347"], ["updated_at", "2021-05-12 19:16:47.869347"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 74], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.871038"], ["updated_at", "2021-05-12 19:16:47.871038"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 74], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.871038"], ["updated_at", "2021-05-12 19:16:47.871038"], ["id", 50], ["id", 50]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 56], ["prompt_id", 50], ["created_at", "2021-05-12 19:16:47.874047"], ["updated_at", "2021-05-12 19:16:47.874047"]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 56 AND "comprehension_labels"."id" != 18) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '8999470b-166d-40f7-829d-ec34c67c068c' AND "comprehension_rules"."id" != 56) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 50], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '74ccd4ff-6da8-451a-b08c-27adcc196285' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "74ccd4ff-6da8-451a-b08c-27adcc196285"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.879585"], ["updated_at", "2021-05-12 19:16:47.879585"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 50], ["rule_id", 57], ["created_at", "2021-05-12 19:16:47.880457"], ["updated_at", "2021-05-12 19:16:47.880457"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 57 LIMIT 1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 50]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 56]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 57]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should require case sensitive unique value for rule. 
--------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5d93de08-584c-4a77-b8ec-30426f789d94' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5d93de08-584c-4a77-b8ec-30426f789d94"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.886521"], ["updated_at", "2021-05-12 19:16:47.886521"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 58 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 58], ["created_at", "2021-05-12 19:16:47.889304"], ["updated_at", "2021-05-12 19:16:47.889304"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels"  ORDER BY "comprehension_labels"."id" ASC LIMIT 1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 58]]
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 58 LIMIT 1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1[0m  [["rule_id", 58]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should not allow changes to name after creation. 
----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0bd79e1d-a07b-49f5-8e9c-b30a927cdb37' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "0bd79e1d-a07b-49f5-8e9c-b30a927cdb37"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.896883"], ["updated_at", "2021-05-12 19:16:47.896883"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 59 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 59], ["created_at", "2021-05-12 19:16:47.898862"], ["updated_at", "2021-05-12 19:16:47.898862"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 59 AND "comprehension_labels"."id" != 20) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_labels" SET "updated_at" = $1 WHERE "comprehension_labels"."id" = $2  [["updated_at", "2021-05-12 19:16:47.900633"], ["id", 20]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."id" = $1 LIMIT 1  [["id", 20]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should require name to be set. 
----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e12b3f72-dbbf-4195-95a6-1279f38922d6' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e12b3f72-dbbf-4195-95a6-1279f38922d6"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.904223"], ["updated_at", "2021-05-12 19:16:47.904223"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 60 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 60], ["created_at", "2021-05-12 19:16:47.915245"], ["updated_at", "2021-05-12 19:16:47.915245"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with rules should return successfully. 
----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '84cb9049-ed69-4fa8-ba9b-0dbcf3970f23' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "84cb9049-ed69-4fa8-ba9b-0dbcf3970f23"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.927389"], ["updated_at", "2021-05-12 19:16:47.927389"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#index as HTML
  [1m[35mComprehension::Rule Load (0.8ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules"
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 61]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 61]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 61]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 61]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 61]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.6ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested highlight record when nested in feedback_attributes. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 66"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 66"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 72 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 66"], ["name", "MyString 77"], ["target_level", 1], ["parent_activity_id", 72], ["created_at", "2021-05-12 19:16:47.939219"], ["updated_at", "2021-05-12 19:16:47.939219"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 75], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.940499"], ["updated_at", "2021-05-12 19:16:47.940499"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 75], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.940499"], ["updated_at", "2021-05-12 19:16:47.940499"], ["id", 51], ["id", 51]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_highlights"
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 6 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '275d629b-f030-4a7f-b5d7-bbaaff1f625d' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "275d629b-f030-4a7f-b5d7-bbaaff1f625d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.945152"], ["updated_at", "2021-05-12 19:16:47.945152"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 6], ["rule_id", 62], ["created_at", "2021-05-12 19:16:47.946032"], ["updated_at", "2021-05-12 19:16:47.946032"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "feedbacks_attributes"=>[{"text"=>"Here is some test feedback.", "description"=>"Test description for test feedback record.", "order"=>"6", "highlights_attributes"=>[{"text"=>"Highlight me", "highlight_type"=>"passage", "starting_index"=>"2"}]}]}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 6 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f6abffd7-3b42-43cc-8af8-7f8bf0637f8c' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "f6abffd7-3b42-43cc-8af8-7f8bf0637f8c"], ["created_at", "2021-05-12 19:16:47.958320"], ["updated_at", "2021-05-12 19:16:47.958320"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 6], ["rule_id", 63], ["created_at", "2021-05-12 19:16:47.959468"], ["updated_at", "2021-05-12 19:16:47.959468"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "comprehension_highlights" ("text", "highlight_type", "starting_index", "feedback_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["text", "Highlight me"], ["highlight_type", "passage"], ["starting_index", 2], ["feedback_id", 27], ["created_at", "2021-05-12 19:16:47.960368"], ["updated_at", "2021-05-12 19:16:47.960368"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 63]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 63]]
  [1m[35mComprehension::Highlight Load (0.1ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1  [["feedback_id", 27]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 63]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 63]]
Completed 201 Created in 11ms (Views: 0.1ms | ActiveRecord: 2.5ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_highlights"[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: show should raise if not found (to be handled by parent app). 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '94153ab7-4f1d-4c88-9503-c51010828e89' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "94153ab7-4f1d-4c88-9503-c51010828e89"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:47.968067"], ["updated_at", "2021-05-12 19:16:47.968067"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "99999"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create a valid record with plagiarism_text attributes. 
----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 67"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 67"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 73 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 67"], ["name", "MyString 78"], ["target_level", 1], ["parent_activity_id", 73], ["created_at", "2021-05-12 19:16:47.976802"], ["updated_at", "2021-05-12 19:16:47.976802"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 76], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.978086"], ["updated_at", "2021-05-12 19:16:47.978086"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 76], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.978086"], ["updated_at", "2021-05-12 19:16:47.978086"], ["id", 52], ["id", 52]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "plagiarism_text_attributes"=>{"text"=>"Here is some text to be checked for plagiarism."}}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5afceb48-b7fd-4183-800b-71d95f97c5ce' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "5afceb48-b7fd-4183-800b-71d95f97c5ce"], ["created_at", "2021-05-12 19:16:47.986126"], ["updated_at", "2021-05-12 19:16:47.986126"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("text", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["text", "Here is some text to be checked for plagiarism."], ["rule_id", 65], ["created_at", "2021-05-12 19:16:47.987050"], ["updated_at", "2021-05-12 19:16:47.987050"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 65]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 65]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 65]]
Completed 201 Created in 7ms (Views: 0.1ms | ActiveRecord: 1.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should return an error if plagiarism rule already exists for prompt. 
-----------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 68"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 68"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 74 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 68"], ["name", "MyString 79"], ["target_level", 1], ["parent_activity_id", 74], ["created_at", "2021-05-12 19:16:47.993575"], ["updated_at", "2021-05-12 19:16:47.993575"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 77], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.994944"], ["updated_at", "2021-05-12 19:16:47.994944"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 77], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:47.994944"], ["updated_at", "2021-05-12 19:16:47.994944"], ["id", 53], ["id", 53]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 53
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 53], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 77]]
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b3892f47-c9d0-470c-881b-87dbc851b4e5' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "b3892f47-c9d0-470c-881b-87dbc851b4e5"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.001586"], ["updated_at", "2021-05-12 19:16:48.001586"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 53], ["rule_id", 66], ["created_at", "2021-05-12 19:16:48.002672"], ["updated_at", "2021-05-12 19:16:48.002672"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"b6dc710b-908a-4611-8588-abca913e437a", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "suborder"=>"1", "rule_type"=>"plagiarism", "universal"=>false, "state"=>"active", "prompt_ids"=>["53"]}}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 53
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 53], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 77]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '53360751-aebf-483d-8bf6-d5944c2a1b72' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 5ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: show should return json if found by uid. 
------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '661bb46f-5dec-439b-9b20-87a720eb2f08' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "661bb46f-5dec-439b-9b20-87a720eb2f08"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.014224"], ["updated_at", "2021-05-12 19:16:48.014224"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#show as HTML
  Parameters: {"id"=>"661bb46f-5dec-439b-9b20-87a720eb2f08"}
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "661bb46f-5dec-439b-9b20-87a720eb2f08"]]
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 67]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 67]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 67]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 67]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 67]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should return an error if regex is invalid. 
----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 69"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 69"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 75 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 69"], ["name", "MyString 80"], ["target_level", 1], ["parent_activity_id", 75], ["created_at", "2021-05-12 19:16:48.026428"], ["updated_at", "2021-05-12 19:16:48.026428"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 78], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.027806"], ["updated_at", "2021-05-12 19:16:48.027806"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 78], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.027806"], ["updated_at", "2021-05-12 19:16:48.027806"], ["id", 54], ["id", 54]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 54
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 54], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 78]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '85fb7f80-70d8-4b3c-b549-53030abebc04' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "85fb7f80-70d8-4b3c-b549-53030abebc04"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.033426"], ["updated_at", "2021-05-12 19:16:48.033426"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 54], ["rule_id", 68], ["created_at", "2021-05-12 19:16:48.034299"], ["updated_at", "2021-05-12 19:16:48.034299"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 68], ["regex_text", "MyString"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.035852"], ["updated_at", "2021-05-12 19:16:48.035852"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"regex_rules_attributes"=>[{"id"=>"13", "regex_text"=>"(invalid|"}]}, "id"=>"68"}
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "68"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 68]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1 AND "comprehension_regex_rules"."id" = 13  [["rule_id", 68]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '85fb7f80-70d8-4b3c-b549-53030abebc04' AND "comprehension_rules"."id" != 68) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 4ms (Views: 0.1ms | ActiveRecord: 1.1ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update nested feedback attributes if present. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 70"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 70"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 76 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 70"], ["name", "MyString 81"], ["target_level", 1], ["parent_activity_id", 76], ["created_at", "2021-05-12 19:16:48.047762"], ["updated_at", "2021-05-12 19:16:48.047762"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 79], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.049255"], ["updated_at", "2021-05-12 19:16:48.049255"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 79], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.049255"], ["updated_at", "2021-05-12 19:16:48.049255"], ["id", 55], ["id", 55]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 55[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 55], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 79]]
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ff999bb8-04d5-467b-ae29-54a11651d5bf' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "ff999bb8-04d5-467b-ae29-54a11651d5bf"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.056535"], ["updated_at", "2021-05-12 19:16:48.056535"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 55], ["rule_id", 69], ["created_at", "2021-05-12 19:16:48.057491"], ["updated_at", "2021-05-12 19:16:48.057491"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 8 AND "comprehension_feedbacks"."rule_id" = 69) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 69], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 8], ["created_at", "2021-05-12 19:16:48.059733"], ["updated_at", "2021-05-12 19:16:48.059733"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"feedbacks_attributes"=>[{"id"=>"28", "text"=>"new text for the feedbacks object"}]}, "id"=>"69"}
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "69"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 69]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."id" = 28  [["rule_id", 69]]
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 8 AND "comprehension_feedbacks"."id" != 28 AND "comprehension_feedbacks"."rule_id" = 69) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'ff999bb8-04d5-467b-ae29-54a11651d5bf' AND "comprehension_rules"."id" != 69) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_feedbacks" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_feedbacks"."id" = $3[0m  [["text", "new text for the feedbacks object"], ["updated_at", "2021-05-12 19:16:48.067242"], ["id", 28]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 5ms (ActiveRecord: 1.4ms)
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."id" = $1 LIMIT 1[0m  [["id", 28]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should not create an invalid record and return errors as json. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 71"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 71"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 77 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 71"], ["name", "MyString 82"], ["target_level", 1], ["parent_activity_id", 77], ["created_at", "2021-05-12 19:16:48.072665"], ["updated_at", "2021-05-12 19:16:48.072665"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 80], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.073925"], ["updated_at", "2021-05-12 19:16:48.073925"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 80], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.073925"], ["updated_at", "2021-05-12 19:16:48.073925"], ["id", 56], ["id", 56]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"cd6a2883-048b-49f5-8fd9-4b1da17dd1c7", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>nil, "suborder"=>"-1", "rule_type"=>"rules-based-1", "universal"=>false}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f31a3357-6eac-4d29-b0f0-b5b8c6e44984' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_rules"[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get Rules for the intersection of prompt and rule type when both are provided. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 72"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 72"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 78 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 72"], ["name", "MyString 83"], ["target_level", 1], ["parent_activity_id", 78], ["created_at", "2021-05-12 19:16:48.086986"], ["updated_at", "2021-05-12 19:16:48.086986"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 81], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.088519"], ["updated_at", "2021-05-12 19:16:48.088519"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 81], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.088519"], ["updated_at", "2021-05-12 19:16:48.088519"], ["id", 57], ["id", 57]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 73"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 73"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 79 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 73"], ["name", "MyString 84"], ["target_level", 1], ["parent_activity_id", 79], ["created_at", "2021-05-12 19:16:48.092696"], ["updated_at", "2021-05-12 19:16:48.092696"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 82], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.093916"], ["updated_at", "2021-05-12 19:16:48.093916"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 82], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.093916"], ["updated_at", "2021-05-12 19:16:48.093916"], ["id", 58], ["id", 58]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 57], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '895b3a50-e0f6-4ed7-b16a-4054dc1851aa' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "895b3a50-e0f6-4ed7-b16a-4054dc1851aa"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.098404"], ["updated_at", "2021-05-12 19:16:48.098404"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 57], ["rule_id", 70], ["created_at", "2021-05-12 19:16:48.099282"], ["updated_at", "2021-05-12 19:16:48.099282"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 57], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '06e85f92-63fe-4f81-8660-89e97cb690e2' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "06e85f92-63fe-4f81-8660-89e97cb690e2"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.102910"], ["updated_at", "2021-05-12 19:16:48.102910"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 57], ["rule_id", 71], ["created_at", "2021-05-12 19:16:48.103948"], ["updated_at", "2021-05-12 19:16:48.103948"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 58], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd2c0f305-e9c4-406d-ae61-609161091fd7' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "d2c0f305-e9c4-406d-ae61-609161091fd7"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.107675"], ["updated_at", "2021-05-12 19:16:48.107675"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 58], ["rule_id", 72], ["created_at", "2021-05-12 19:16:48.108521"], ["updated_at", "2021-05-12 19:16:48.108521"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 58], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f649ff80-7fed-4a28-b7f5-a9d1de681300' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "f649ff80-7fed-4a28-b7f5-a9d1de681300"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.111884"], ["updated_at", "2021-05-12 19:16:48.111884"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 58], ["rule_id", 73], ["created_at", "2021-05-12 19:16:48.112710"], ["updated_at", "2021-05-12 19:16:48.112710"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 57], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 58], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5357449f-0a3d-4831-b6de-5d9f7265295b' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5357449f-0a3d-4831-b6de-5d9f7265295b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.117250"], ["updated_at", "2021-05-12 19:16:48.117250"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 57], ["rule_id", 74], ["created_at", "2021-05-12 19:16:48.118350"], ["updated_at", "2021-05-12 19:16:48.118350"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 58], ["rule_id", 74], ["created_at", "2021-05-12 19:16:48.119038"], ["updated_at", "2021-05-12 19:16:48.119038"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"prompt_id"=>"57", "rule_type"=>"autoML"}
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts_rules"."rule_id" = "comprehension_rules"."id" WHERE "comprehension_prompts_rules"."prompt_id" = 57 AND "comprehension_rules"."rule_type" = $1  [["rule_type", "autoML"]]
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 70]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 70]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 70]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 70]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 70]]
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update a valid record with plagiarism_text attributes. 
----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 74"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 74"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 80 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 74"], ["name", "MyString 85"], ["target_level", 1], ["parent_activity_id", 80], ["created_at", "2021-05-12 19:16:48.134616"], ["updated_at", "2021-05-12 19:16:48.134616"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 83], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.135878"], ["updated_at", "2021-05-12 19:16:48.135878"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 83], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.135878"], ["updated_at", "2021-05-12 19:16:48.135878"], ["id", 59], ["id", 59]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 59
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 59], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 83]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2eaeb227-e42a-4822-9161-2faff55db816' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "2eaeb227-e42a-4822-9161-2faff55db816"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.141417"], ["updated_at", "2021-05-12 19:16:48.141417"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 59], ["rule_id", 75], ["created_at", "2021-05-12 19:16:48.142433"], ["updated_at", "2021-05-12 19:16:48.142433"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"plagiarism_text_attributes"=>{"text"=>"New plagiarism text"}}, "id"=>"75"}
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "75"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 75]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.2ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 75]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '2eaeb227-e42a-4822-9161-2faff55db816' AND "comprehension_rules"."id" != 75) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("text", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["text", "New plagiarism text"], ["rule_id", 75], ["created_at", "2021-05-12 19:16:48.158603"], ["updated_at", "2021-05-12 19:16:48.158603"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 13ms (ActiveRecord: 1.2ms)
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 75]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 75]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get unique Rules for specified prompts when provided. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 75"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 75"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 81 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 75"], ["name", "MyString 86"], ["target_level", 1], ["parent_activity_id", 81], ["created_at", "2021-05-12 19:16:48.164084"], ["updated_at", "2021-05-12 19:16:48.164084"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 84], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.165371"], ["updated_at", "2021-05-12 19:16:48.165371"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 84], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.165371"], ["updated_at", "2021-05-12 19:16:48.165371"], ["id", 60], ["id", 60]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 76"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 76"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 82 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 76"], ["name", "MyString 87"], ["target_level", 1], ["parent_activity_id", 82], ["created_at", "2021-05-12 19:16:48.170534"], ["updated_at", "2021-05-12 19:16:48.170534"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 85], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.172229"], ["updated_at", "2021-05-12 19:16:48.172229"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 85], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.172229"], ["updated_at", "2021-05-12 19:16:48.172229"], ["id", 61], ["id", 61]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 60], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '38320073-fde3-4bf8-b8f8-926ecf686bac' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "38320073-fde3-4bf8-b8f8-926ecf686bac"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.177319"], ["updated_at", "2021-05-12 19:16:48.177319"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 60], ["rule_id", 76], ["created_at", "2021-05-12 19:16:48.178198"], ["updated_at", "2021-05-12 19:16:48.178198"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 60], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '64abad69-5243-4531-a888-7bb53da3db09' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "64abad69-5243-4531-a888-7bb53da3db09"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.181649"], ["updated_at", "2021-05-12 19:16:48.181649"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 60], ["rule_id", 77], ["created_at", "2021-05-12 19:16:48.182645"], ["updated_at", "2021-05-12 19:16:48.182645"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 61], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b5b83925-b711-45d2-835f-bc2b4ccc09e8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b5b83925-b711-45d2-835f-bc2b4ccc09e8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.187142"], ["updated_at", "2021-05-12 19:16:48.187142"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 61], ["rule_id", 78], ["created_at", "2021-05-12 19:16:48.188090"], ["updated_at", "2021-05-12 19:16:48.188090"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 61], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0fbe270d-87a7-43f8-b965-f6b9fefb8283' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "0fbe270d-87a7-43f8-b965-f6b9fefb8283"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.192111"], ["updated_at", "2021-05-12 19:16:48.192111"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 61], ["rule_id", 79], ["created_at", "2021-05-12 19:16:48.192984"], ["updated_at", "2021-05-12 19:16:48.192984"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 60], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 61], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1af1fd50-1689-47f8-b9b9-4df8e56aee25' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "1af1fd50-1689-47f8-b9b9-4df8e56aee25"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.197313"], ["updated_at", "2021-05-12 19:16:48.197313"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 60], ["rule_id", 80], ["created_at", "2021-05-12 19:16:48.198472"], ["updated_at", "2021-05-12 19:16:48.198472"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 61], ["rule_id", 80], ["created_at", "2021-05-12 19:16:48.199302"], ["updated_at", "2021-05-12 19:16:48.199302"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"prompt_id"=>"60, 61"}
  [1m[36mComprehension::Rule Load (0.7ms)[0m  [1mSELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts_rules"."rule_id" = "comprehension_rules"."id" WHERE "comprehension_prompts_rules"."prompt_id" IN (60, 61)[0m
  [1m[35m (0.3ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 76]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 76]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 76]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 76]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 76]]
  [1m[36m (0.2ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 77]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 77]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 77]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 77]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 77]]
  [1m[35m (0.2ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 78]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 78]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 78]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 78]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 78]]
  [1m[36m (0.2ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 79]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 79]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 79]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 79]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 79]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 80]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 80]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 80]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 80]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 80]]
Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 3.8ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should return an error if regex is invalid. 
----------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 77"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 77"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 83 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 77"], ["name", "MyString 88"], ["target_level", 1], ["parent_activity_id", 83], ["created_at", "2021-05-12 19:16:48.221252"], ["updated_at", "2021-05-12 19:16:48.221252"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 86], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.222915"], ["updated_at", "2021-05-12 19:16:48.222915"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 86], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.222915"], ["updated_at", "2021-05-12 19:16:48.222915"], ["id", 62], ["id", 62]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"6ca03ca9-c035-4da7-a637-c8c1f3355542", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "state"=>"inactive", "regex_rules_attributes"=>[{"regex_text"=>"(invalid|", "case_sensitive"=>false}]}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '05aa9de7-d5fb-4db2-8404-96aaa69ba18d' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "6ca03ca9-c035-4da7-a637-c8c1f3355542"], ["uid", "05aa9de7-d5fb-4db2-8404-96aaa69ba18d"], ["created_at", "2021-05-12 19:16:48.230789"], ["updated_at", "2021-05-12 19:16:48.230789"]]
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 4ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: destroy should destroy record at id. 
--------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9313a920-240a-44e0-b288-8850c0a0f7b9' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "9313a920-240a-44e0-b288-8850c0a0f7b9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.234486"], ["updated_at", "2021-05-12 19:16:48.234486"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#destroy as HTML
  Parameters: {"id"=>"82"}
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "82"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 82]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 82]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 82]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 82]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 82]]
  [1m[35mSQL (0.4ms)[0m  DELETE FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1  [["id", 82]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.3ms)
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 82]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should not update record and return errors as json. 
------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 78"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 78"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 84 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 78"], ["name", "MyString 89"], ["target_level", 1], ["parent_activity_id", 84], ["created_at", "2021-05-12 19:16:48.246098"], ["updated_at", "2021-05-12 19:16:48.246098"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 87], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.247553"], ["updated_at", "2021-05-12 19:16:48.247553"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 87], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.247553"], ["updated_at", "2021-05-12 19:16:48.247553"], ["id", 63], ["id", 63]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.5ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 63[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 63], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 87]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f71c50f0-c6fe-43c5-ae82-53cf7ad8b3df' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f71c50f0-c6fe-43c5-ae82-53cf7ad8b3df"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.255093"], ["updated_at", "2021-05-12 19:16:48.255093"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 63], ["rule_id", 83], ["created_at", "2021-05-12 19:16:48.256118"], ["updated_at", "2021-05-12 19:16:48.256118"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"-1", "rule_type"=>"rules-based-1", "universal"=>false}, "id"=>"83"}
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "83"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 83]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f71c50f0-c6fe-43c5-ae82-53cf7ad8b3df' AND "comprehension_rules"."id" != 83) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should not update read-only nested label name. 
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 79"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 79"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 85 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 79"], ["name", "MyString 90"], ["target_level", 1], ["parent_activity_id", 85], ["created_at", "2021-05-12 19:16:48.266712"], ["updated_at", "2021-05-12 19:16:48.266712"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 88], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.268033"], ["updated_at", "2021-05-12 19:16:48.268033"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 88], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.268033"], ["updated_at", "2021-05-12 19:16:48.268033"], ["id", 64], ["id", 64]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 64
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 64], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 88]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '591ee921-df3c-4a38-971e-92ec84420238' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "591ee921-df3c-4a38-971e-92ec84420238"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.273945"], ["updated_at", "2021-05-12 19:16:48.273945"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 64], ["rule_id", 84], ["created_at", "2021-05-12 19:16:48.274850"], ["updated_at", "2021-05-12 19:16:48.274850"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 84 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 64]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 84]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 84], ["created_at", "2021-05-12 19:16:48.277831"], ["updated_at", "2021-05-12 19:16:48.277831"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"label_attributes"=>{"id"=>"22", "name"=>"can not be updated"}}, "id"=>"84"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "84"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 84]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 84]]
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 84 AND "comprehension_labels"."id" != 22) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '591ee921-df3c-4a38-971e-92ec84420238' AND "comprehension_rules"."id" != 84) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_labels" SET "updated_at" = $1 WHERE "comprehension_labels"."id" = $2  [["updated_at", "2021-05-12 19:16:48.285381"], ["id", 22]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 5ms (ActiveRecord: 1.4ms)
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."id" = $1 LIMIT 1  [["id", 22]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create a valid record and return it as json. 
------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 80"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 80"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 86 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 80"], ["name", "MyString 91"], ["target_level", 1], ["parent_activity_id", 86], ["created_at", "2021-05-12 19:16:48.291308"], ["updated_at", "2021-05-12 19:16:48.291308"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 89], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.292937"], ["updated_at", "2021-05-12 19:16:48.292937"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 89], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.292937"], ["updated_at", "2021-05-12 19:16:48.292937"], ["id", 65], ["id", 65]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_rules"[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "prompt_ids"=>[]}}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE 1=0
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2a8452eb-f4a6-48e5-8063-4421880bbc5e' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "2a8452eb-f4a6-48e5-8063-4421880bbc5e"], ["created_at", "2021-05-12 19:16:48.302137"], ["updated_at", "2021-05-12 19:16:48.302137"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 85]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 85]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 85]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 85]]
Completed 201 Created in 5ms (Views: 0.1ms | ActiveRecord: 1.3ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_rules"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested feedback record when present in params. 
---------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 81"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 81"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 87 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 81"], ["name", "MyString 92"], ["target_level", 1], ["parent_activity_id", 87], ["created_at", "2021-05-12 19:16:48.308982"], ["updated_at", "2021-05-12 19:16:48.308982"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 90], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.310241"], ["updated_at", "2021-05-12 19:16:48.310241"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 90], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.310241"], ["updated_at", "2021-05-12 19:16:48.310241"], ["id", 66], ["id", 66]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_feedbacks"
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "feedbacks_attributes"=>[{"text"=>"Here is some test feedback.", "description"=>"Test description for test feedback record.", "order"=>"9"}]}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 9 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '29fceee2-a6e5-49cd-afc2-b2baf45db62d' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "29fceee2-a6e5-49cd-afc2-b2baf45db62d"], ["created_at", "2021-05-12 19:16:48.319978"], ["updated_at", "2021-05-12 19:16:48.319978"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 9], ["rule_id", 86], ["created_at", "2021-05-12 19:16:48.320898"], ["updated_at", "2021-05-12 19:16:48.320898"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 86]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 86]]
  [1m[36mComprehension::Highlight Load (0.2ms)[0m  [1mSELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1[0m  [["feedback_id", 29]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 86]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 86]]
Completed 201 Created in 8ms (Views: 0.1ms | ActiveRecord: 1.8ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_feedbacks"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index should return successfully - no rule. 
---------------------------------------------------------------------------------------
Processing by Comprehension::RulesController#index as HTML
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules"[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested regex rule record when present in params. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 82"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 82"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 88 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 82"], ["name", "MyString 93"], ["target_level", 1], ["parent_activity_id", 88], ["created_at", "2021-05-12 19:16:48.333909"], ["updated_at", "2021-05-12 19:16:48.333909"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 91], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.335353"], ["updated_at", "2021-05-12 19:16:48.335353"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 91], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.335353"], ["updated_at", "2021-05-12 19:16:48.335353"], ["id", 67], ["id", 67]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_regex_rules"
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "regex_rules_attributes"=>[{"regex_text"=>"MyString", "case_sensitive"=>false}]}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5b42f282-fe18-400b-a595-508e08f02059' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "5b42f282-fe18-400b-a595-508e08f02059"], ["created_at", "2021-05-12 19:16:48.344538"], ["updated_at", "2021-05-12 19:16:48.344538"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("regex_text", "case_sensitive", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["regex_text", "MyString"], ["case_sensitive", "f"], ["rule_id", 87], ["created_at", "2021-05-12 19:16:48.345410"], ["updated_at", "2021-05-12 19:16:48.345410"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 87]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 87]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 87]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 87]]
Completed 201 Created in 6ms (Views: 0.1ms | ActiveRecord: 1.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_regex_rules"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get Rules for specified rule type when provided. 
---------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 83"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 83"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 89 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 83"], ["name", "MyString 94"], ["target_level", 1], ["parent_activity_id", 89], ["created_at", "2021-05-12 19:16:48.352989"], ["updated_at", "2021-05-12 19:16:48.352989"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 92], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.354362"], ["updated_at", "2021-05-12 19:16:48.354362"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 92], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.354362"], ["updated_at", "2021-05-12 19:16:48.354362"], ["id", 68], ["id", 68]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 84"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 84"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 90 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 84"], ["name", "MyString 95"], ["target_level", 1], ["parent_activity_id", 90], ["created_at", "2021-05-12 19:16:48.359351"], ["updated_at", "2021-05-12 19:16:48.359351"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 93], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.360582"], ["updated_at", "2021-05-12 19:16:48.360582"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 93], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.360582"], ["updated_at", "2021-05-12 19:16:48.360582"], ["id", 69], ["id", 69]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 68], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'eeb5c930-bc1d-4eca-aff1-029e4ced2e31' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "eeb5c930-bc1d-4eca-aff1-029e4ced2e31"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.364968"], ["updated_at", "2021-05-12 19:16:48.364968"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 68], ["rule_id", 88], ["created_at", "2021-05-12 19:16:48.365809"], ["updated_at", "2021-05-12 19:16:48.365809"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 68], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'bbea054b-232c-4ea7-bfb0-29056c5c4df9' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "bbea054b-232c-4ea7-bfb0-29056c5c4df9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.369300"], ["updated_at", "2021-05-12 19:16:48.369300"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 68], ["rule_id", 89], ["created_at", "2021-05-12 19:16:48.370130"], ["updated_at", "2021-05-12 19:16:48.370130"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 69], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '226f15db-54be-436d-9370-534118b180c8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "226f15db-54be-436d-9370-534118b180c8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.374375"], ["updated_at", "2021-05-12 19:16:48.374375"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 69], ["rule_id", 90], ["created_at", "2021-05-12 19:16:48.375344"], ["updated_at", "2021-05-12 19:16:48.375344"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 69], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '95e938dc-2cc7-42ef-930c-395150f12f28' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "95e938dc-2cc7-42ef-930c-395150f12f28"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.387145"], ["updated_at", "2021-05-12 19:16:48.387145"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 69], ["rule_id", 91], ["created_at", "2021-05-12 19:16:48.388479"], ["updated_at", "2021-05-12 19:16:48.388479"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 68], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 69], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1e667abf-2b88-4c48-81ba-5e5008b99abf' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "1e667abf-2b88-4c48-81ba-5e5008b99abf"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.393547"], ["updated_at", "2021-05-12 19:16:48.393547"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 68], ["rule_id", 92], ["created_at", "2021-05-12 19:16:48.394443"], ["updated_at", "2021-05-12 19:16:48.394443"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 69], ["rule_id", 92], ["created_at", "2021-05-12 19:16:48.395101"], ["updated_at", "2021-05-12 19:16:48.395101"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"rule_type"=>"autoML"}
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1[0m  [["rule_type", "autoML"]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 88]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 88]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 88]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 88]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 88]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 90]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 90]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 90]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 90]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 90]]
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get Rules for specified prompt when provided. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 85"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 85"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 91 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 85"], ["name", "MyString 96"], ["target_level", 1], ["parent_activity_id", 91], ["created_at", "2021-05-12 19:16:48.407744"], ["updated_at", "2021-05-12 19:16:48.407744"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 94], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.409579"], ["updated_at", "2021-05-12 19:16:48.409579"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 94], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.409579"], ["updated_at", "2021-05-12 19:16:48.409579"], ["id", 70], ["id", 70]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 86"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 86"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 92 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 86"], ["name", "MyString 97"], ["target_level", 1], ["parent_activity_id", 92], ["created_at", "2021-05-12 19:16:48.414620"], ["updated_at", "2021-05-12 19:16:48.414620"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 95], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.416525"], ["updated_at", "2021-05-12 19:16:48.416525"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 95], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.416525"], ["updated_at", "2021-05-12 19:16:48.416525"], ["id", 71], ["id", 71]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 70], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e553c847-6fd6-47c7-9f27-36be92d2536d' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e553c847-6fd6-47c7-9f27-36be92d2536d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.422596"], ["updated_at", "2021-05-12 19:16:48.422596"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 70], ["rule_id", 93], ["created_at", "2021-05-12 19:16:48.423486"], ["updated_at", "2021-05-12 19:16:48.423486"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 70], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3be64769-01ea-45b0-948e-13f9fea9727a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "3be64769-01ea-45b0-948e-13f9fea9727a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.427180"], ["updated_at", "2021-05-12 19:16:48.427180"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 70], ["rule_id", 94], ["created_at", "2021-05-12 19:16:48.428185"], ["updated_at", "2021-05-12 19:16:48.428185"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 71], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '07e3001e-7a0e-4cda-9837-bbb9a99e4bf1' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "07e3001e-7a0e-4cda-9837-bbb9a99e4bf1"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.431833"], ["updated_at", "2021-05-12 19:16:48.431833"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 71], ["rule_id", 95], ["created_at", "2021-05-12 19:16:48.432832"], ["updated_at", "2021-05-12 19:16:48.432832"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 71], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '205303ae-3d3a-48d3-8296-9a1ab581d943' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "205303ae-3d3a-48d3-8296-9a1ab581d943"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.436432"], ["updated_at", "2021-05-12 19:16:48.436432"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 71], ["rule_id", 96], ["created_at", "2021-05-12 19:16:48.437283"], ["updated_at", "2021-05-12 19:16:48.437283"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 70], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 71], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '28dda4fe-8b1c-4398-801d-3c0ece84b5f4' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "28dda4fe-8b1c-4398-801d-3c0ece84b5f4"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.441776"], ["updated_at", "2021-05-12 19:16:48.441776"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 70], ["rule_id", 97], ["created_at", "2021-05-12 19:16:48.442639"], ["updated_at", "2021-05-12 19:16:48.442639"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 71], ["rule_id", 97], ["created_at", "2021-05-12 19:16:48.443276"], ["updated_at", "2021-05-12 19:16:48.443276"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"prompt_id"=>"70"}
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts_rules"."rule_id" = "comprehension_rules"."id" WHERE "comprehension_prompts_rules"."prompt_id" = 70
  [1m[36m (0.2ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 93]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 93]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 93]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 93]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 93]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 94]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 94]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 94]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 94]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 94]]
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 97]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 97]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 97]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 97]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 97]]
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 2.8ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: show should return json if found by id. 
-----------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '26e508f0-a8b6-4384-98ca-34b073d17845' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "26e508f0-a8b6-4384-98ca-34b073d17845"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.460246"], ["updated_at", "2021-05-12 19:16:48.460246"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#show as HTML
  Parameters: {"id"=>"98"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "98"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 98]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 98]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 98]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 98]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 98]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 98]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested label record when present in params. 
------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 87"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 87"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 93 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 87"], ["name", "MyString 98"], ["target_level", 1], ["parent_activity_id", 93], ["created_at", "2021-05-12 19:16:48.470808"], ["updated_at", "2021-05-12 19:16:48.470808"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 96], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.472283"], ["updated_at", "2021-05-12 19:16:48.472283"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 96], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.472283"], ["updated_at", "2021-05-12 19:16:48.472283"], ["id", 72], ["id", 72]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_labels"[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "label_attributes"=>{"name"=>"some label name"}}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" IS NULL LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2afeeee3-8971-45b6-8d04-2371f3807d81' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "2afeeee3-8971-45b6-8d04-2371f3807d81"], ["created_at", "2021-05-12 19:16:48.481058"], ["updated_at", "2021-05-12 19:16:48.481058"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 99], ["created_at", "2021-05-12 19:16:48.481866"], ["updated_at", "2021-05-12 19:16:48.481866"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 99]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 99]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 99]]
Completed 201 Created in 7ms (Views: 0.1ms | ActiveRecord: 1.4ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_labels"[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update nested regex rule attributes if present. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 88"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 88"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 94 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 88"], ["name", "MyString 99"], ["target_level", 1], ["parent_activity_id", 94], ["created_at", "2021-05-12 19:16:48.489784"], ["updated_at", "2021-05-12 19:16:48.489784"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 97], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.491224"], ["updated_at", "2021-05-12 19:16:48.491224"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 97], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.491224"], ["updated_at", "2021-05-12 19:16:48.491224"], ["id", 73], ["id", 73]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 73
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 73], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 97]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '33fb65a5-c60b-44ea-8524-c82f913519e0' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "33fb65a5-c60b-44ea-8524-c82f913519e0"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.497603"], ["updated_at", "2021-05-12 19:16:48.497603"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 73], ["rule_id", 100], ["created_at", "2021-05-12 19:16:48.498600"], ["updated_at", "2021-05-12 19:16:48.498600"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 100], ["regex_text", "MyString"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.500382"], ["updated_at", "2021-05-12 19:16:48.500382"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"regex_rules_attributes"=>[{"id"=>"15", "regex_text"=>"new regex text"}]}, "id"=>"100"}
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "100"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 100]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1 AND "comprehension_regex_rules"."id" = 15  [["rule_id", 100]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '33fb65a5-c60b-44ea-8524-c82f913519e0' AND "comprehension_rules"."id" != 100) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_regex_rules" SET "regex_text" = $1, "updated_at" = $2 WHERE "comprehension_regex_rules"."id" = $3  [["regex_text", "new regex text"], ["updated_at", "2021-05-12 19:16:48.507598"], ["id", 15]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 1.1ms)
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT  "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."id" = $1 LIMIT 1  [["id", 15]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update nested highlight attributes in feedback if present. 
--------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 89"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 89"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 95 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 89"], ["name", "MyString 100"], ["target_level", 1], ["parent_activity_id", 95], ["created_at", "2021-05-12 19:16:48.513088"], ["updated_at", "2021-05-12 19:16:48.513088"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 98], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.514366"], ["updated_at", "2021-05-12 19:16:48.514366"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 98], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.514366"], ["updated_at", "2021-05-12 19:16:48.514366"], ["id", 74], ["id", 74]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 74[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 74], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 98]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ea190c8e-0a4d-4d79-ad46-7eebede61f59' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "ea190c8e-0a4d-4d79-ad46-7eebede61f59"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.521181"], ["updated_at", "2021-05-12 19:16:48.521181"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 74], ["rule_id", 101], ["created_at", "2021-05-12 19:16:48.522387"], ["updated_at", "2021-05-12 19:16:48.522387"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 10 AND "comprehension_feedbacks"."rule_id" = 101) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 101], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 10], ["created_at", "2021-05-12 19:16:48.524981"], ["updated_at", "2021-05-12 19:16:48.524981"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_highlights" ("feedback_id", "text", "highlight_type", "starting_index", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["feedback_id", 30], ["text", "Highlight me"], ["highlight_type", "passage"], ["starting_index", 0], ["created_at", "2021-05-12 19:16:48.526328"], ["updated_at", "2021-05-12 19:16:48.526328"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"feedbacks_attributes"=>[{"id"=>"30", "highlights_attributes"=>[{"id"=>"2", "text"=>"New text to highlight"}]}]}, "id"=>"101"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "101"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 101]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."id" = 30[0m  [["rule_id", 101]]
  [1m[35mComprehension::Highlight Load (0.2ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1 AND "comprehension_highlights"."id" = 2  [["feedback_id", 30]]
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 10 AND "comprehension_feedbacks"."id" != 30 AND "comprehension_feedbacks"."rule_id" = 101) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'ea190c8e-0a4d-4d79-ad46-7eebede61f59' AND "comprehension_rules"."id" != 101) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "comprehension_highlights" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_highlights"."id" = $3[0m  [["text", "New text to highlight"], ["updated_at", "2021-05-12 19:16:48.534921"], ["id", 2]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 6ms (ActiveRecord: 1.6ms)
  [1m[36mComprehension::Highlight Load (0.3ms)[0m  [1mSELECT  "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update record if valid, return nothing. 
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 90"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 90"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 96 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 90"], ["name", "MyString 101"], ["target_level", 1], ["parent_activity_id", 96], ["created_at", "2021-05-12 19:16:48.541846"], ["updated_at", "2021-05-12 19:16:48.541846"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 99], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.543180"], ["updated_at", "2021-05-12 19:16:48.543180"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 99], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.543180"], ["updated_at", "2021-05-12 19:16:48.543180"], ["id", 75], ["id", 75]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 75
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 75], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 99]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cc91ca0d-8dbc-49aa-aa38-dae05e491cab' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "cc91ca0d-8dbc-49aa-aa38-dae05e491cab"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.548798"], ["updated_at", "2021-05-12 19:16:48.548798"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 75], ["rule_id", 102], ["created_at", "2021-05-12 19:16:48.549813"], ["updated_at", "2021-05-12 19:16:48.549813"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 91"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 91"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 97 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 91"], ["name", "MyString 102"], ["target_level", 1], ["parent_activity_id", 97], ["created_at", "2021-05-12 19:16:48.553892"], ["updated_at", "2021-05-12 19:16:48.553892"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 100], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.555462"], ["updated_at", "2021-05-12 19:16:48.555462"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 100], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.555462"], ["updated_at", "2021-05-12 19:16:48.555462"], ["id", 76], ["id", 76]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "prompt_ids"=>["76"]}, "id"=>"102"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "102"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 102]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 76[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 102]]
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "comprehension_prompts_rules" WHERE "comprehension_prompts_rules"."rule_id" = $1 AND "comprehension_prompts_rules"."prompt_id" = 75[0m  [["rule_id", 102]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 102], ["prompt_id", 76], ["created_at", "2021-05-12 19:16:48.564944"], ["updated_at", "2021-05-12 19:16:48.564944"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'cc91ca0d-8dbc-49aa-aa38-dae05e491cab' AND "comprehension_rules"."id" != 102) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 6ms (ActiveRecord: 1.6ms)
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 102]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 102]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------
Comprehension::PromptsRuleTest: test_: relationships should belong to prompt. 
------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------
Comprehension::PromptsRuleTest: test_: relationships should belong to rule. 
----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: relationships should belong to feedback. 
------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should ensure inclusion of highlight_type in ["passage", "response", "prompt"]. 
---------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should ensure text has a length between 1 and 5000. 
-----------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should only allow integers for starting_index which are greater than or equal to 0. 
-------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should require text to be set. 
--------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should require highlight_type to be set. 
------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be true if sequence_type is incorrect and entry does not match the regex text. 
----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '042741b1-b88e-4839-8192-68657251fc63' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "042741b1-b88e-4839-8192-68657251fc63"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.597544"], ["updated_at", "2021-05-12 19:16:48.597544"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 103], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.599295"], ["updated_at", "2021-05-12 19:16:48.599295"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 103]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should require case sensitive unique value for uid. 
------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules"  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.605109"], ["updated_at", "2021-05-12 19:16:48.605109"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be false if sequence_type is incorrect and entry matches regex text. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'db10cbd2-3a3a-4166-be85-0852e91f1fc3' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "db10cbd2-3a3a-4166-be85-0852e91f1fc3"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.611043"], ["updated_at", "2021-05-12 19:16:48.611043"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 105], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.612760"], ["updated_at", "2021-05-12 19:16:48.612760"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 105]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #after_create #assign_to_all_prompts should not assign newly created rule to all prompts if the rule is not universal. 
-------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 92"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 92"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 98 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 92"], ["name", "MyString 103"], ["target_level", 1], ["parent_activity_id", 98], ["created_at", "2021-05-12 19:16:48.618975"], ["updated_at", "2021-05-12 19:16:48.618975"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 101], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.620522"], ["updated_at", "2021-05-12 19:16:48.620522"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 101], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.620522"], ["updated_at", "2021-05-12 19:16:48.620522"], ["id", 77], ["id", 77]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '36deea4a-958b-4851-adf7-e34a683dc7fd' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "36deea4a-958b-4851-adf7-e34a683dc7fd"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.624683"], ["updated_at", "2021-05-12 19:16:48.624683"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 77]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should only allow integers for suborder which are greater than or equal to 0. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '71d4a219-0780-48cc-90df-33118b9134e5' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '71d4a219-0780-48cc-90df-33118b9134e5' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '71d4a219-0780-48cc-90df-33118b9134e5' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '71d4a219-0780-48cc-90df-33118b9134e5' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '71d4a219-0780-48cc-90df-33118b9134e5' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '71d4a219-0780-48cc-90df-33118b9134e5' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should require name to be set. 
---------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2a973432-da66-401f-8496-72149911d3de' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many prompts through prompts_rules. 
----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: before_validation assign_uid_if_missing should set new uid if missing. 
-------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1bed987b-b247-4684-8445-cf7af261dd75' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be false if sequence_type is required and entry does not match regex text. 
------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '99ec5b3a-0522-4791-9a1a-a0e675754c84' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "99ec5b3a-0522-4791-9a1a-a0e675754c84"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.641414"], ["updated_at", "2021-05-12 19:16:48.641414"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 107], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.643105"], ["updated_at", "2021-05-12 19:16:48.643105"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "sequence_type", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 107], ["regex_text", "you need this sequence"], ["case_sensitive", "f"], ["sequence_type", "required"], ["created_at", "2021-05-12 19:16:48.644494"], ["updated_at", "2021-05-12 19:16:48.644494"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 107]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: serializable_hash should fill out hash with all fields. 
----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 93"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 93"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 99 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 93"], ["name", "MyString 104"], ["target_level", 1], ["parent_activity_id", 99], ["created_at", "2021-05-12 19:16:48.649146"], ["updated_at", "2021-05-12 19:16:48.649146"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 102], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.650725"], ["updated_at", "2021-05-12 19:16:48.650725"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 102], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.650725"], ["updated_at", "2021-05-12 19:16:48.650725"], ["id", 78], ["id", 78]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1ad3c917-b3de-4085-a63d-050f02fe82bc' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "1ad3c917-b3de-4085-a63d-050f02fe82bc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.654542"], ["updated_at", "2021-05-12 19:16:48.654542"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 78], ["rule_id", 108], ["created_at", "2021-05-12 19:16:48.656340"], ["updated_at", "2021-05-12 19:16:48.656340"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 108]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 108]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 108]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 108]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many prompts_rules. 
------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should ensure inclusion of rule_type in ["autoML", "grammar", "opinion", "plagiarism", "rules-based-1", "rules-based-2", "rules-based-3", "spelling"]. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b556c7ee-6ca5-4bc2-bf11-83c2bea1d862' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many regex_rules dependent => destroy. 
-------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have one label. 
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #determine_feedback_from_history should fetch lowest order feedback with text not matched from history. 
----------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '74af92c2-52b9-41c9-9a27-498cc2c71804' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "74af92c2-52b9-41c9-9a27-498cc2c71804"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.670821"], ["updated_at", "2021-05-12 19:16:48.670821"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 109) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 109], ["text", "Example feedback 1"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:48.673211"], ["updated_at", "2021-05-12 19:16:48.673211"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 109) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 109], ["text", "Example feedback 2"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:48.675180"], ["updated_at", "2021-05-12 19:16:48.675180"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" = 109) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 109], ["text", "Example feedback 3"], ["description", "Test description for test feedback record."], ["order", 2], ["created_at", "2021-05-12 19:16:48.676963"], ["updated_at", "2021-05-12 19:16:48.676963"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND ("comprehension_feedbacks"."text" != 'Example feedback 1')  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1  [["rule_id", 109]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: before_validation assign_uid_if_missing should keep existing uid if already set. 
-----------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4130a5b5-3451-460c-8e33-c326859946c7' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have one plagiarism_text. 
-------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #determine_feedback_from_history should fetch highest order if all feedbacks have text matched from history. 
---------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd4cc8f20-d2f6-4fa1-804e-e4f26c2f8a56' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "d4cc8f20-d2f6-4fa1-804e-e4f26c2f8a56"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.683543"], ["updated_at", "2021-05-12 19:16:48.683543"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 110) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 110], ["text", "Example feedback 1"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:48.686343"], ["updated_at", "2021-05-12 19:16:48.686343"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 110) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 110], ["text", "Example feedback 2"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:48.688652"], ["updated_at", "2021-05-12 19:16:48.688652"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" = 110) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 110], ["text", "Example feedback 3"], ["description", "Test description for test feedback record."], ["order", 2], ["created_at", "2021-05-12 19:16:48.690964"], ["updated_at", "2021-05-12 19:16:48.690964"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND ("comprehension_feedbacks"."text" NOT IN ('Example feedback 1', 'Example feedback 2', 'Example feedback 3'))  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1  [["rule_id", 110]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."order" DESC LIMIT 1[0m  [["rule_id", 110]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #after_create #assign_to_all_prompts should not assign newly created rules to prompts that somehow already have them assigned. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 94"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 94"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 100 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 94"], ["name", "MyString 105"], ["target_level", 1], ["parent_activity_id", 100], ["created_at", "2021-05-12 19:16:48.696273"], ["updated_at", "2021-05-12 19:16:48.696273"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 103], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.697520"], ["updated_at", "2021-05-12 19:16:48.697520"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 103], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.697520"], ["updated_at", "2021-05-12 19:16:48.697520"], ["id", 79], ["id", 79]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 79], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '982f77d8-48c6-43a9-8ab0-1fb531516e01' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "982f77d8-48c6-43a9-8ab0-1fb531516e01"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.702867"], ["updated_at", "2021-05-12 19:16:48.702867"]]
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '982f77d8-48c6-43a9-8ab0-1fb531516e01' AND "comprehension_rules"."id" != 111) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "982f77d8-48c6-43a9-8ab0-1fb531516e01"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.702867"], ["updated_at", "2021-05-12 19:16:48.702867"], ["id", 111], ["id", 111]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 79], ["rule_id", 111], ["created_at", "2021-05-12 19:16:48.706487"], ["updated_at", "2021-05-12 19:16:48.706487"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 79]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should ensure inclusion of optimal in [true, false]. 
-------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7833d59e-71a4-4016-b48b-f559fe03eac5' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7833d59e-71a4-4016-b48b-f559fe03eac5' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: display_name should correspond to the correct display name. 
--------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b8b9d381-94be-46aa-9ad6-fa57017b841e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b8b9d381-94be-46aa-9ad6-fa57017b841e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-2"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.712582"], ["updated_at", "2021-05-12 19:16:48.712582"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #after_create #assign_to_all_prompts should assign newly created rule to all prompts if the rule is universal. 
-----------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 95"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 95"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 101 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 95"], ["name", "MyString 106"], ["target_level", 1], ["parent_activity_id", 101], ["created_at", "2021-05-12 19:16:48.717207"], ["updated_at", "2021-05-12 19:16:48.717207"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 104], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.718825"], ["updated_at", "2021-05-12 19:16:48.718825"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 104], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.718825"], ["updated_at", "2021-05-12 19:16:48.718825"], ["id", 80], ["id", 80]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'bd6474de-d4fc-45cd-af69-b359683e4fb3' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "bd6474de-d4fc-45cd-af69-b359683e4fb3"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.722780"], ["updated_at", "2021-05-12 19:16:48.722780"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 113], ["prompt_id", 80], ["created_at", "2021-05-12 19:16:48.724748"], ["updated_at", "2021-05-12 19:16:48.724748"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'bd6474de-d4fc-45cd-af69-b359683e4fb3' AND "comprehension_rules"."id" != 113) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "bd6474de-d4fc-45cd-af69-b359683e4fb3"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.722780"], ["updated_at", "2021-05-12 19:16:48.722780"], ["id", 113], ["id", 113]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 80]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be true if entry does not match the regex text. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1f59d37c-e3c9-4ff8-8bd3-d664048c2da6' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "1f59d37c-e3c9-4ff8-8bd3-d664048c2da6"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.729913"], ["updated_at", "2021-05-12 19:16:48.729913"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 114], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.731524"], ["updated_at", "2021-05-12 19:16:48.731524"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 114]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should does not create plagiarism rule if plagiarism rule already exists for prompt. 
-----------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 96"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 96"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 102 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 96"], ["name", "MyString 107"], ["target_level", 1], ["parent_activity_id", 102], ["created_at", "2021-05-12 19:16:48.735955"], ["updated_at", "2021-05-12 19:16:48.735955"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 105], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.737219"], ["updated_at", "2021-05-12 19:16:48.737219"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 105], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.737219"], ["updated_at", "2021-05-12 19:16:48.737219"], ["id", 81], ["id", 81]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 97"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 97"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 103 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 97"], ["name", "MyString 108"], ["target_level", 1], ["parent_activity_id", 103], ["created_at", "2021-05-12 19:16:48.742068"], ["updated_at", "2021-05-12 19:16:48.742068"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 106], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.743436"], ["updated_at", "2021-05-12 19:16:48.743436"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 106], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.743436"], ["updated_at", "2021-05-12 19:16:48.743436"], ["id", 82], ["id", 82]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 81[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 81], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 105]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'addc98f4-8c6d-467f-ba9b-55b7983924b0' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "addc98f4-8c6d-467f-ba9b-55b7983924b0"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.749715"], ["updated_at", "2021-05-12 19:16:48.749715"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 81], ["rule_id", 115], ["created_at", "2021-05-12 19:16:48.751002"], ["updated_at", "2021-05-12 19:16:48.751002"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 81[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 81], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 105]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5779e153-dfd1-4344-9d8f-c1c7628d7e6f' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should ensure inclusion of universal in [true, false]. 
---------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '12aeca48-696e-4ff2-8706-54f5fb2fe741' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '12aeca48-696e-4ff2-8706-54f5fb2fe741' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should ensure name has a length of at most 250. 
--------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1bf60147-bc14-4db2-a714-4e531a6167ef' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1bf60147-bc14-4db2-a714-4e531a6167ef' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should creates subsequent plagiarism rule for different prompt. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 98"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 98"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 104 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 98"], ["name", "MyString 109"], ["target_level", 1], ["parent_activity_id", 104], ["created_at", "2021-05-12 19:16:48.765181"], ["updated_at", "2021-05-12 19:16:48.765181"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 107], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.766608"], ["updated_at", "2021-05-12 19:16:48.766608"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 107], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.766608"], ["updated_at", "2021-05-12 19:16:48.766608"], ["id", 83], ["id", 83]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 99"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 99"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 105 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 99"], ["name", "MyString 110"], ["target_level", 1], ["parent_activity_id", 105], ["created_at", "2021-05-12 19:16:48.770608"], ["updated_at", "2021-05-12 19:16:48.770608"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 108], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.771882"], ["updated_at", "2021-05-12 19:16:48.771882"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 108], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.771882"], ["updated_at", "2021-05-12 19:16:48.771882"], ["id", 84], ["id", 84]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 83[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 83], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 107]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '579f0e3d-1e08-4796-9324-2eceeb459bde' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "579f0e3d-1e08-4796-9324-2eceeb459bde"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.777620"], ["updated_at", "2021-05-12 19:16:48.777620"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 83], ["rule_id", 116], ["created_at", "2021-05-12 19:16:48.778503"], ["updated_at", "2021-05-12 19:16:48.778503"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 84[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 84], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 108]]
  [1m[35mComprehension::Rule Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5dd40609-76cd-495a-be2d-072218465d96' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #determine_feedback_from_history should fetch lowest order feedback if feedback history is empty. 
----------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '61a56e84-9a7b-40e2-a796-4d479770da55' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "61a56e84-9a7b-40e2-a796-4d479770da55"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.788221"], ["updated_at", "2021-05-12 19:16:48.788221"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 117) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 117], ["text", "Example feedback 1"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-05-12 19:16:48.790537"], ["updated_at", "2021-05-12 19:16:48.790537"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 117) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 117], ["text", "Example feedback 2"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-05-12 19:16:48.792453"], ["updated_at", "2021-05-12 19:16:48.792453"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" = 117) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 117], ["text", "Example feedback 3"], ["description", "Test description for test feedback record."], ["order", 2], ["created_at", "2021-05-12 19:16:48.794349"], ["updated_at", "2021-05-12 19:16:48.794349"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND (1=1)  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1[0m  [["rule_id", 117]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should creates plagiarism rule if first rule for prompt. 
-------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 100"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 100"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 106 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 100"], ["name", "MyString 111"], ["target_level", 1], ["parent_activity_id", 106], ["created_at", "2021-05-12 19:16:48.798791"], ["updated_at", "2021-05-12 19:16:48.798791"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 109], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.800118"], ["updated_at", "2021-05-12 19:16:48.800118"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 109], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.800118"], ["updated_at", "2021-05-12 19:16:48.800118"], ["id", 85], ["id", 85]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 101"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 101"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 107 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 101"], ["name", "MyString 112"], ["target_level", 1], ["parent_activity_id", 107], ["created_at", "2021-05-12 19:16:48.811886"], ["updated_at", "2021-05-12 19:16:48.811886"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 110], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.813175"], ["updated_at", "2021-05-12 19:16:48.813175"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 110], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.813175"], ["updated_at", "2021-05-12 19:16:48.813175"], ["id", 86], ["id", 86]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 85
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 85], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 109]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '977d7da1-f4fe-4c63-acfc-eb038b076d96' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "977d7da1-f4fe-4c63-acfc-eb038b076d96"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.819787"], ["updated_at", "2021-05-12 19:16:48.819787"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 85], ["rule_id", 118], ["created_at", "2021-05-12 19:16:48.820981"], ["updated_at", "2021-05-12 19:16:48.820981"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '977d7da1-f4fe-4c63-acfc-eb038b076d96' AND "comprehension_rules"."id" != 118) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many feedbacks. 
--------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should ensure inclusion of state in ["active", "inactive"]. 
--------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '36fab7ee-cb11-41ec-8076-029f340ae434' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '36fab7ee-cb11-41ec-8076-029f340ae434' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '36fab7ee-cb11-41ec-8076-029f340ae434' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be true if sequence_type is required and entry matches regex text. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ac22adc7-9b59-4a21-af30-cdc21239ce08' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "ac22adc7-9b59-4a21-af30-cdc21239ce08"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:48.831359"], ["updated_at", "2021-05-12 19:16:48.831359"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 119], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:48.833137"], ["updated_at", "2021-05-12 19:16:48.833137"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "sequence_type", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 119], ["regex_text", "you need this sequence"], ["case_sensitive", "f"], ["sequence_type", "required"], ["created_at", "2021-05-12 19:16:48.834597"], ["updated_at", "2021-05-12 19:16:48.834597"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 119]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: show should return json if found. 
-------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 102"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 102"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 108 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 102"], ["name", "MyString 113"], ["target_level", 1], ["parent_activity_id", 108], ["created_at", "2021-05-12 19:16:48.844689"], ["updated_at", "2021-05-12 19:16:48.844689"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '003fbf41-32f1-4019-b416-1cc35bf4bf43' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 111], ["expires_at", "2021-06-12 19:16:48.845600"], ["uuid", "003fbf41-32f1-4019-b416-1cc35bf4bf43"], ["created_at", "2021-05-12 19:16:48.846684"], ["updated_at", "2021-05-12 19:16:48.846684"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#show as HTML
  Parameters: {"id"=>"13"}
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 13]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: show should raise if not found (to be handled by parent app). 
-----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 103"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 103"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 109 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 103"], ["name", "MyString 114"], ["target_level", 1], ["parent_activity_id", 109], ["created_at", "2021-05-12 19:16:48.856384"], ["updated_at", "2021-05-12 19:16:48.856384"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'fe47261b-fc75-44c3-aa19-4303122e4ddc' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 112], ["expires_at", "2021-06-12 19:16:48.857554"], ["uuid", "fe47261b-fc75-44c3-aa19-4303122e4ddc"], ["created_at", "2021-05-12 19:16:48.858644"], ["updated_at", "2021-05-12 19:16:48.858644"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: create should not create an invalid record and return errors as json. 
-------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 104"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 104"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 110 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 104"], ["name", "MyString 115"], ["target_level", 1], ["parent_activity_id", 110], ["created_at", "2021-05-12 19:16:48.867252"], ["updated_at", "2021-05-12 19:16:48.867252"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#create as HTML
  Parameters: {"turking_round"=>{"activity_id"=>nil, "expires_at"=>nil}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '77084fd7-99a5-4e9b-997f-4c58a7461126' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_turking_rounds"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: destroy should destroy record at id. 
----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 105"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 105"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 111 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 105"], ["name", "MyString 116"], ["target_level", 1], ["parent_activity_id", 111], ["created_at", "2021-05-12 19:16:48.877651"], ["updated_at", "2021-05-12 19:16:48.877651"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '213ddc8f-2248-4546-a52b-488f5f06a577' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 114], ["expires_at", "2021-06-12 19:16:48.878542"], ["uuid", "213ddc8f-2248-4546-a52b-488f5f06a577"], ["created_at", "2021-05-12 19:16:48.879555"], ["updated_at", "2021-05-12 19:16:48.879555"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#destroy as HTML
  Parameters: {"id"=>"15"}
  [1m[36mComprehension::TurkingRound Load (0.4ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 15]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1[0m  [["id", 15]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 2ms (ActiveRecord: 0.8ms)
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 15]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: update should update record if valid, return nothing. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 106"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 106"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 112 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 106"], ["name", "MyString 117"], ["target_level", 1], ["parent_activity_id", 112], ["created_at", "2021-05-12 19:16:48.890134"], ["updated_at", "2021-05-12 19:16:48.890134"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '8a8e8b98-6803-4658-952e-66ccc5a37a9a' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 115], ["expires_at", "2021-06-12 19:16:48.891280"], ["uuid", "8a8e8b98-6803-4658-952e-66ccc5a37a9a"], ["created_at", "2021-05-12 19:16:48.892421"], ["updated_at", "2021-05-12 19:16:48.892421"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 107"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 107"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 113 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 107"], ["name", "MyString 118"], ["target_level", 1], ["parent_activity_id", 113], ["created_at", "2021-05-12 19:16:48.895295"], ["updated_at", "2021-05-12 19:16:48.895295"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#update as HTML
  Parameters: {"turking_round"=>{"activity_id"=>"116", "expires_at"=>"2021-05-12T19:16:48+00:00"}, "id"=>"16"}
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 16]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" = '8a8e8b98-6803-4658-952e-66ccc5a37a9a' AND "comprehension_turking_rounds"."id" != 16) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_turking_rounds" SET "activity_id" = $1, "expires_at" = $2, "updated_at" = $3 WHERE "comprehension_turking_rounds"."id" = $4[0m  [["activity_id", 116], ["expires_at", "2021-05-12 19:16:48.000000"], ["updated_at", "2021-05-12 19:16:48.901336"], ["id", 16]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 4ms (ActiveRecord: 1.0ms)
  [1m[36mComprehension::TurkingRound Load (0.1ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 16]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: index should return successfully - no turking_round. 
--------------------------------------------------------------------------------------------------------
Processing by Comprehension::TurkingRoundsController#index as HTML
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: index with turking_rounds should return successfully. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 108"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 108"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 114 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 108"], ["name", "MyString 119"], ["target_level", 1], ["parent_activity_id", 114], ["created_at", "2021-05-12 19:16:48.911703"], ["updated_at", "2021-05-12 19:16:48.911703"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'df9f70f8-df31-4206-bc9b-900271c4cd1f' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 117], ["expires_at", "2021-06-12 19:16:48.912588"], ["uuid", "df9f70f8-df31-4206-bc9b-900271c4cd1f"], ["created_at", "2021-05-12 19:16:48.913688"], ["updated_at", "2021-05-12 19:16:48.913688"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#index as HTML
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: update should not update record and return errors as json. 
--------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 109"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 109"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 115 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 109"], ["name", "MyString 120"], ["target_level", 1], ["parent_activity_id", 115], ["created_at", "2021-05-12 19:16:48.922901"], ["updated_at", "2021-05-12 19:16:48.922901"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '86ed0710-ca93-4435-99b7-7d9c0a54c695' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 118], ["expires_at", "2021-06-12 19:16:48.923996"], ["uuid", "86ed0710-ca93-4435-99b7-7d9c0a54c695"], ["created_at", "2021-05-12 19:16:48.925126"], ["updated_at", "2021-05-12 19:16:48.925126"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#update as HTML
  Parameters: {"turking_round"=>{"activity_id"=>nil, "uuid"=>nil, "expires_at"=>nil}, "id"=>"18"}
  [1m[35mComprehension::TurkingRound Load (0.2ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 18]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" IS NULL AND "comprehension_turking_rounds"."id" != 18) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: create should create a valid record and return it as json. 
--------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 110"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 110"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 116 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 110"], ["name", "MyString 121"], ["target_level", 1], ["parent_activity_id", 116], ["created_at", "2021-05-12 19:16:48.934538"], ["updated_at", "2021-05-12 19:16:48.934538"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#create as HTML
  Parameters: {"turking_round"=>{"activity_id"=>"119", "uuid"=>"05c1ddb9-7672-4e24-90a6-5597920c70b3", "expires_at"=>"2021-06-12T19:16:48.935Z"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '05c1ddb9-7672-4e24-90a6-5597920c70b3' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "uuid", "expires_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 119], ["uuid", "05c1ddb9-7672-4e24-90a6-5597920c70b3"], ["expires_at", "2021-06-12 19:16:48.935000"], ["created_at", "2021-05-12 19:16:48.940105"], ["updated_at", "2021-05-12 19:16:48.940105"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 201 Created in 5ms (Views: 2.9ms | ActiveRecord: 0.6ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_turking_rounds"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: activate should return a 422 with the unmodified object if activation fails. 
-------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 111"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 111"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 117 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 111"], ["name", "MyString 122"], ["target_level", 1], ["parent_activity_id", 117], ["created_at", "2021-05-12 19:16:48.954883"], ["updated_at", "2021-05-12 19:16:48.954883"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 120], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.957046"], ["updated_at", "2021-05-12 19:16:48.957046"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 120], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.957046"], ["updated_at", "2021-05-12 19:16:48.957046"], ["id", 87], ["id", 87]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-27' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-27"], ["name", "AutoML-Model-Name"], ["prompt_id", 87], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:48.959945"], ["updated_at", "2021-05-12 19:16:48.959945"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#activate as HTML
  Parameters: {"id"=>"24"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 24]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:48.959945')[0m  [["prompt_id", 87]]
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: destroy should destroy record at id. 
---------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 112"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 112"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 118 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 112"], ["name", "MyString 123"], ["target_level", 1], ["parent_activity_id", 118], ["created_at", "2021-05-12 19:16:48.969456"], ["updated_at", "2021-05-12 19:16:48.969456"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 121], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.970714"], ["updated_at", "2021-05-12 19:16:48.970714"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 121], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.970714"], ["updated_at", "2021-05-12 19:16:48.970714"], ["id", 88], ["id", 88]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-28' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-28"], ["name", "AutoML-Model-Name"], ["prompt_id", 88], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:48.973402"], ["updated_at", "2021-05-12 19:16:48.973402"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#destroy as HTML
  Parameters: {"id"=>"25"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 25]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1  [["id", 25]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.5ms)
  [1m[35mComprehension::AutomlModel Load (0.1ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 25]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: index should return successfully - no automl_model. 
------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#index as HTML
  [1m[36mComprehension::AutomlModel Load (0.4ms)[0m  [1mSELECT "comprehension_automl_models".* FROM "comprehension_automl_models"[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: activate should return an empty 200 response if activation is successful. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 113"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 113"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 119 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 113"], ["name", "MyString 124"], ["target_level", 1], ["parent_activity_id", 119], ["created_at", "2021-05-12 19:16:48.988578"], ["updated_at", "2021-05-12 19:16:48.988578"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 122], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.990199"], ["updated_at", "2021-05-12 19:16:48.990199"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 122], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:48.990199"], ["updated_at", "2021-05-12 19:16:48.990199"], ["id", 89], ["id", 89]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-29' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-29"], ["name", "AutoML-Model-Name"], ["prompt_id", 89], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:48.993162"], ["updated_at", "2021-05-12 19:16:48.993162"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#activate as HTML
  Parameters: {"id"=>"26"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 26]]
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: show should raise if not found (to be handled by parent app). 
----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 114"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 114"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 120 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 114"], ["name", "MyString 125"], ["target_level", 1], ["parent_activity_id", 120], ["created_at", "2021-05-12 19:16:49.001117"], ["updated_at", "2021-05-12 19:16:49.001117"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 123], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.002381"], ["updated_at", "2021-05-12 19:16:49.002381"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 123], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.002381"], ["updated_at", "2021-05-12 19:16:49.002381"], ["id", 90], ["id", 90]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-30' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-30"], ["name", "AutoML-Model-Name"], ["prompt_id", 90], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:49.005147"], ["updated_at", "2021-05-12 19:16:49.005147"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[36mComprehension::AutomlModel Load (0.1ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 99999]]
Completed 404 Not Found in 0ms (ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: update should not update read-only attributes return empty 204. 
------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 115"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 115"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 121 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 115"], ["name", "MyString 126"], ["target_level", 1], ["parent_activity_id", 121], ["created_at", "2021-05-12 19:16:49.012727"], ["updated_at", "2021-05-12 19:16:49.012727"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 124], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.013986"], ["updated_at", "2021-05-12 19:16:49.013986"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 124], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.013986"], ["updated_at", "2021-05-12 19:16:49.013986"], ["id", 91], ["id", 91]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-31' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-31"], ["name", "AutoML-Model-Name"], ["prompt_id", 91], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:49.017312"], ["updated_at", "2021-05-12 19:16:49.017312"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#update as HTML
  Parameters: {"automl_model"=>{"automl_model_id"=>"anything", "name"=>"anything", "labels"=>["anything"]}, "id"=>"28"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 28]]
Unpermitted parameters: name, labels
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'anything' AND "comprehension_automl_models"."id" != 28) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2[0m  [["updated_at", "2021-05-12 19:16:49.023815"], ["id", 28]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 4ms (ActiveRecord: 1.2ms)
  [1m[36mComprehension::AutomlModel Load (0.1ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 28]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: create should not create an invalid record and return errors as json. 
------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#create as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil, "automl_model_id"=>""}}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = '' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: create should create new records with state = inactive no matter what is passed in. 
--------------------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#create as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil, "automl_model_id"=>"MODEL-ID-33", "state"=>"active"}}
Unpermitted parameter: state
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-33' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "labels", "state", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["automl_model_id", "MODEL-ID-33"], ["name", "AutoML-Model-Name"], ["labels", "{label1}"], ["state", "inactive"], ["created_at", "2021-05-12 19:16:49.038649"], ["updated_at", "2021-05-12 19:16:49.038649"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" IS NULL AND (created_at < '2021-05-12 19:16:49.038649')
Completed 201 Created in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models"[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: show should return json if found. 
------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 118"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 118"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 122 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 118"], ["name", "MyString 129"], ["target_level", 1], ["parent_activity_id", 122], ["created_at", "2021-05-12 19:16:49.044655"], ["updated_at", "2021-05-12 19:16:49.044655"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 125], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.045902"], ["updated_at", "2021-05-12 19:16:49.045902"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 125], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.045902"], ["updated_at", "2021-05-12 19:16:49.045902"], ["id", 92], ["id", 92]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-34' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-34"], ["name", "AutoML-Model-Name"], ["prompt_id", 92], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:49.048771"], ["updated_at", "2021-05-12 19:16:49.048771"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#show as HTML
  Parameters: {"id"=>"30"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 30]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:49.048771')[0m  [["prompt_id", 92]]
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: update should update record if valid, return nothing. 
--------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 119"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 119"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 123 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 119"], ["name", "MyString 130"], ["target_level", 1], ["parent_activity_id", 123], ["created_at", "2021-05-12 19:16:49.059142"], ["updated_at", "2021-05-12 19:16:49.059142"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 126], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.060420"], ["updated_at", "2021-05-12 19:16:49.060420"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 126], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.060420"], ["updated_at", "2021-05-12 19:16:49.060420"], ["id", 93], ["id", 93]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-35' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-35"], ["name", "AutoML-Model-Name"], ["prompt_id", 93], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:49.063100"], ["updated_at", "2021-05-12 19:16:49.063100"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 120"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 120"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 124 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 120"], ["name", "MyString 131"], ["target_level", 1], ["parent_activity_id", 124], ["created_at", "2021-05-12 19:16:49.067852"], ["updated_at", "2021-05-12 19:16:49.067852"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 127], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.070047"], ["updated_at", "2021-05-12 19:16:49.070047"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 127], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.070047"], ["updated_at", "2021-05-12 19:16:49.070047"], ["id", 94], ["id", 94]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#update as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil}, "id"=>"31"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 31]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-35' AND "comprehension_automl_models"."id" != 31) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_automl_models" SET "prompt_id" = $1, "updated_at" = $2 WHERE "comprehension_automl_models"."id" = $3[0m  [["prompt_id", nil], ["updated_at", "2021-05-12 19:16:49.077277"], ["id", 31]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 3ms (ActiveRecord: 0.8ms)
  [1m[36mComprehension::AutomlModel Load (0.1ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 31]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: create should create a valid record and return it as json. 
-------------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#create as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil, "automl_model_id"=>"MODEL-ID-36"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-36' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "labels", "state", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["automl_model_id", "MODEL-ID-36"], ["name", "AutoML-Model-Name"], ["labels", "{label1}"], ["state", "inactive"], ["created_at", "2021-05-12 19:16:49.085170"], ["updated_at", "2021-05-12 19:16:49.085170"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" IS NULL AND (created_at < '2021-05-12 19:16:49.085170')
Completed 201 Created in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: index with automl_models should return successfully. 
-------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 122"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 122"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 125 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 122"], ["name", "MyString 133"], ["target_level", 1], ["parent_activity_id", 125], ["created_at", "2021-05-12 19:16:49.092084"], ["updated_at", "2021-05-12 19:16:49.092084"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 128], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.093345"], ["updated_at", "2021-05-12 19:16:49.093345"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 128], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.093345"], ["updated_at", "2021-05-12 19:16:49.093345"], ["id", 95], ["id", 95]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-37' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-37"], ["name", "AutoML-Model-Name"], ["prompt_id", 95], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-05-12 19:16:49.096081"], ["updated_at", "2021-05-12 19:16:49.096081"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#index as HTML
  [1m[35mComprehension::AutomlModel Load (0.3ms)[0m  SELECT "comprehension_automl_models".* FROM "comprehension_automl_models"
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-05-12 19:16:49.096081')[0m  [["prompt_id", 95]]
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: validations should require text to be set. 
-------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: validations should require rule to be set. 
-------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: serializable_hash should fill out hash with all fields. 
--------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c547797c-c989-4a57-beff-12bc68b97468' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "c547797c-c989-4a57-beff-12bc68b97468"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.118021"], ["updated_at", "2021-05-12 19:16:49.118021"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 120], ["text", "This is the passage of text that we want to use to check for plagiarism."], ["created_at", "2021-05-12 19:16:49.119712"], ["updated_at", "2021-05-12 19:16:49.119712"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: relations should belong to rule. 
---------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #feedback_object should return optimal blank feedback when there is no regex match. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 123"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 123"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 126 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 123"], ["name", "MyString 134"], ["target_level", 1], ["parent_activity_id", 126], ["created_at", "2021-05-12 19:16:49.125408"], ["updated_at", "2021-05-12 19:16:49.125408"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 129], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.126726"], ["updated_at", "2021-05-12 19:16:49.126726"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 129], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.126726"], ["updated_at", "2021-05-12 19:16:49.126726"], ["id", 96], ["id", 96]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 96], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '05695245-7f28-40dd-bca2-7f608169327d' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "05695245-7f28-40dd-bca2-7f608169327d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.131450"], ["updated_at", "2021-05-12 19:16:49.131450"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 96], ["rule_id", 121], ["created_at", "2021-05-12 19:16:49.132333"], ["updated_at", "2021-05-12 19:16:49.132333"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 121], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:49.133958"], ["updated_at", "2021-05-12 19:16:49.133958"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 11 AND "comprehension_feedbacks"."rule_id" = 121) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 121], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 11], ["created_at", "2021-05-12 19:16:49.136109"], ["updated_at", "2021-05-12 19:16:49.136109"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e1c415bd-943f-4eda-b455-0af4a31aafc9' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "e1c415bd-943f-4eda-b455-0af4a31aafc9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "t"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.138738"], ["updated_at", "2021-05-12 19:16:49.138738"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 96], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 121]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 96], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 121]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 96], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 121]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 96], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 121]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["optimal", "t"], ["rule_type", "rules-based-1"]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #feedback_object should return the highest priority feedback when two feedbacks exist. 
-----------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 124"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 124"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 127 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 124"], ["name", "MyString 135"], ["target_level", 1], ["parent_activity_id", 127], ["created_at", "2021-05-12 19:16:49.148383"], ["updated_at", "2021-05-12 19:16:49.148383"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 130], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.150275"], ["updated_at", "2021-05-12 19:16:49.150275"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 130], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.150275"], ["updated_at", "2021-05-12 19:16:49.150275"], ["id", 97], ["id", 97]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 97], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd932e5dd-cbc9-4f67-9440-e24b122b4e56' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "d932e5dd-cbc9-4f67-9440-e24b122b4e56"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.156264"], ["updated_at", "2021-05-12 19:16:49.156264"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 97], ["rule_id", 123], ["created_at", "2021-05-12 19:16:49.157242"], ["updated_at", "2021-05-12 19:16:49.157242"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 123], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:49.158768"], ["updated_at", "2021-05-12 19:16:49.158768"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 12 AND "comprehension_feedbacks"."rule_id" = 123) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 123], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 12], ["created_at", "2021-05-12 19:16:49.160710"], ["updated_at", "2021-05-12 19:16:49.160710"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 97], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f102364d-e1c5-4ad4-b8b7-f0be153167cc' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "f102364d-e1c5-4ad4-b8b7-f0be153167cc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.164216"], ["updated_at", "2021-05-12 19:16:49.164216"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 97], ["rule_id", 124], ["created_at", "2021-05-12 19:16:49.165076"], ["updated_at", "2021-05-12 19:16:49.165076"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 124], ["regex_text", "^Testing"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:49.166683"], ["updated_at", "2021-05-12 19:16:49.166683"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 97], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 123]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1[0m  [["rule_id", 123]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #feedback_object should be false when there is a regex match. 
----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 125"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 125"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 128 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 125"], ["name", "MyString 136"], ["target_level", 1], ["parent_activity_id", 128], ["created_at", "2021-05-12 19:16:49.172279"], ["updated_at", "2021-05-12 19:16:49.172279"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 131], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.173533"], ["updated_at", "2021-05-12 19:16:49.173533"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 131], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.173533"], ["updated_at", "2021-05-12 19:16:49.173533"], ["id", 98], ["id", 98]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 98], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7de08e42-5b68-44a5-9022-b5cc35c5386a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "7de08e42-5b68-44a5-9022-b5cc35c5386a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.178207"], ["updated_at", "2021-05-12 19:16:49.178207"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 98], ["rule_id", 125], ["created_at", "2021-05-12 19:16:49.179071"], ["updated_at", "2021-05-12 19:16:49.179071"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 125], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:49.181088"], ["updated_at", "2021-05-12 19:16:49.181088"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 13 AND "comprehension_feedbacks"."rule_id" = 125) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 125], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 13], ["created_at", "2021-05-12 19:16:49.183693"], ["updated_at", "2021-05-12 19:16:49.183693"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 98], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 125]]
  [1m[36mComprehension::Feedback Load (0.5ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1[0m  [["rule_id", 125]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #initialize should should have working accessor methods for all initialized fields. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 126"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 126"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 129 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 126"], ["name", "MyString 137"], ["target_level", 1], ["parent_activity_id", 129], ["created_at", "2021-05-12 19:16:49.192843"], ["updated_at", "2021-05-12 19:16:49.192843"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 132], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.194352"], ["updated_at", "2021-05-12 19:16:49.194352"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 132], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.194352"], ["updated_at", "2021-05-12 19:16:49.194352"], ["id", 99], ["id", 99]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 99], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '96279584-4b3d-45e6-9135-aa57c0df3ace' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "96279584-4b3d-45e6-9135-aa57c0df3ace"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.199650"], ["updated_at", "2021-05-12 19:16:49.199650"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 99], ["rule_id", 126], ["created_at", "2021-05-12 19:16:49.200535"], ["updated_at", "2021-05-12 19:16:49.200535"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 126], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:49.202053"], ["updated_at", "2021-05-12 19:16:49.202053"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 14 AND "comprehension_feedbacks"."rule_id" = 126) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 126], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 14], ["created_at", "2021-05-12 19:16:49.204026"], ["updated_at", "2021-05-12 19:16:49.204026"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: update should update record if valid, return nothing. 
------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 127"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 127"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 130 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 127"], ["name", "MyString 138"], ["target_level", 1], ["parent_activity_id", 130], ["created_at", "2021-05-12 19:16:49.214009"], ["updated_at", "2021-05-12 19:16:49.214009"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'b0eec42a-e83d-47a1-a795-670b4a313092' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 133], ["expires_at", "2021-06-12 19:16:49.214902"], ["uuid", "b0eec42a-e83d-47a1-a795-670b4a313092"], ["created_at", "2021-05-12 19:16:49.216094"], ["updated_at", "2021-05-12 19:16:49.216094"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '3e928fcb-0f3b-48ac-aff4-0cc88de8cd14' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 20], ["activity_session_uid", "3e928fcb-0f3b-48ac-aff4-0cc88de8cd14"], ["created_at", "2021-05-12 19:16:49.218469"], ["updated_at", "2021-05-12 19:16:49.218469"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#update as HTML
  Parameters: {"turking_round_activity_session"=>{"activity_session_uid"=>"353815b6-2dcd-4966-860e-8b91e9106e5c"}, "id"=>"2"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.2ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 2]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE ("comprehension_turking_round_activity_sessions"."activity_session_uid" = '353815b6-2dcd-4966-860e-8b91e9106e5c' AND "comprehension_turking_round_activity_sessions"."id" != 2) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_turking_round_activity_sessions" SET "activity_session_uid" = $1, "updated_at" = $2 WHERE "comprehension_turking_round_activity_sessions"."id" = $3[0m  [["activity_session_uid", "353815b6-2dcd-4966-860e-8b91e9106e5c"], ["updated_at", "2021-05-12 19:16:49.225686"], ["id", 2]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 3ms (ActiveRecord: 0.8ms)
  [1m[36mComprehension::TurkingRoundActivitySession Load (0.2ms)[0m  [1mSELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: index should return successfully - no turking_round_activity_session. 
----------------------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::TurkingRoundActivitySessionsController#index as HTML
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: create should create a valid record and return it as json. 
-----------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 129"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 129"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 131 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 129"], ["name", "MyString 140"], ["target_level", 1], ["parent_activity_id", 131], ["created_at", "2021-05-12 19:16:49.236663"], ["updated_at", "2021-05-12 19:16:49.236663"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '672cea0a-7634-478a-9e1c-a6d4e2f65aff' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 134], ["expires_at", "2021-06-12 19:16:49.237571"], ["uuid", "672cea0a-7634-478a-9e1c-a6d4e2f65aff"], ["created_at", "2021-05-12 19:16:49.238697"], ["updated_at", "2021-05-12 19:16:49.238697"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#create as HTML
  Parameters: {"turking_round_activity_session"=>{"turking_round_id"=>"21", "activity_session_uid"=>"afab2415-c744-46ae-bd12-3ae6a0705f6f"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'afab2415-c744-46ae-bd12-3ae6a0705f6f' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 21], ["activity_session_uid", "afab2415-c744-46ae-bd12-3ae6a0705f6f"], ["created_at", "2021-05-12 19:16:49.243607"], ["updated_at", "2021-05-12 19:16:49.243607"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 2ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_turking_round_activity_sessions"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: destroy should destroy record at id. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 130"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 130"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 132 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 130"], ["name", "MyString 141"], ["target_level", 1], ["parent_activity_id", 132], ["created_at", "2021-05-12 19:16:49.248548"], ["updated_at", "2021-05-12 19:16:49.248548"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '59e727b7-7c4f-444f-9616-b8cf9da0b4e9' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 135], ["expires_at", "2021-06-12 19:16:49.249603"], ["uuid", "59e727b7-7c4f-444f-9616-b8cf9da0b4e9"], ["created_at", "2021-05-12 19:16:49.251043"], ["updated_at", "2021-05-12 19:16:49.251043"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'a5a1578b-1155-46dd-b1cf-8bb91fa47067' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 22], ["activity_session_uid", "a5a1578b-1155-46dd-b1cf-8bb91fa47067"], ["created_at", "2021-05-12 19:16:49.253004"], ["updated_at", "2021-05-12 19:16:49.253004"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#destroy as HTML
  Parameters: {"id"=>"4"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 4]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1  [["id", 4]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.6ms)
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.2ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 4]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: show should raise if not found (to be handled by parent app). 
--------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 131"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 131"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 133 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 131"], ["name", "MyString 142"], ["target_level", 1], ["parent_activity_id", 133], ["created_at", "2021-05-12 19:16:49.263187"], ["updated_at", "2021-05-12 19:16:49.263187"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '1932e700-941b-4ad1-80da-1e3345e35e07' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 136], ["expires_at", "2021-06-12 19:16:49.264077"], ["uuid", "1932e700-941b-4ad1-80da-1e3345e35e07"], ["created_at", "2021-05-12 19:16:49.265113"], ["updated_at", "2021-05-12 19:16:49.265113"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '0751ae7e-18fd-4404-a713-33768cd3075e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 23], ["activity_session_uid", "0751ae7e-18fd-4404-a713-33768cd3075e"], ["created_at", "2021-05-12 19:16:49.266816"], ["updated_at", "2021-05-12 19:16:49.266816"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: create should not create an invalid record and return errors as json. 
----------------------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::TurkingRoundActivitySessionsController#create as HTML
  Parameters: {"turking_round_activity_session"=>{"activity_session_uid"=>nil}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_turking_round_activity_sessions"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: index with turking_round_activity_sessions should return successfully. 
-----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 133"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 133"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 134 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 133"], ["name", "MyString 144"], ["target_level", 1], ["parent_activity_id", 134], ["created_at", "2021-05-12 19:16:49.282097"], ["updated_at", "2021-05-12 19:16:49.282097"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'adfad00f-914a-4cf8-bd6b-d955db7b7039' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 137], ["expires_at", "2021-06-12 19:16:49.283087"], ["uuid", "adfad00f-914a-4cf8-bd6b-d955db7b7039"], ["created_at", "2021-05-12 19:16:49.284638"], ["updated_at", "2021-05-12 19:16:49.284638"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '94199407-617a-4ddb-a1a6-3086a8456780' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 24], ["activity_session_uid", "94199407-617a-4ddb-a1a6-3086a8456780"], ["created_at", "2021-05-12 19:16:49.286616"], ["updated_at", "2021-05-12 19:16:49.286616"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#index as HTML
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: show should return json if found. 
----------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 134"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 134"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 135 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 134"], ["name", "MyString 145"], ["target_level", 1], ["parent_activity_id", 135], ["created_at", "2021-05-12 19:16:49.295738"], ["updated_at", "2021-05-12 19:16:49.295738"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '6eb9b4f7-c203-4239-a396-0a0d4f30b917' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 138], ["expires_at", "2021-06-12 19:16:49.296595"], ["uuid", "6eb9b4f7-c203-4239-a396-0a0d4f30b917"], ["created_at", "2021-05-12 19:16:49.297778"], ["updated_at", "2021-05-12 19:16:49.297778"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '252882b7-be0d-49c8-a56c-20877ba35001' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 25], ["activity_session_uid", "252882b7-be0d-49c8-a56c-20877ba35001"], ["created_at", "2021-05-12 19:16:49.299539"], ["updated_at", "2021-05-12 19:16:49.299539"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#show as HTML
  Parameters: {"id"=>"7"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 7]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: update should not update record and return errors as json. 
-----------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 135"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 135"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 136 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 135"], ["name", "MyString 146"], ["target_level", 1], ["parent_activity_id", 136], ["created_at", "2021-05-12 19:16:49.307840"], ["updated_at", "2021-05-12 19:16:49.307840"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'b6b144ab-c5d9-4ae6-a2a3-1ee6602b02da' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 139], ["expires_at", "2021-06-12 19:16:49.308771"], ["uuid", "b6b144ab-c5d9-4ae6-a2a3-1ee6602b02da"], ["created_at", "2021-05-12 19:16:49.310141"], ["updated_at", "2021-05-12 19:16:49.310141"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '0e3efbeb-f229-4856-8f7e-eef512988369' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 26], ["activity_session_uid", "0e3efbeb-f229-4856-8f7e-eef512988369"], ["created_at", "2021-05-12 19:16:49.312348"], ["updated_at", "2021-05-12 19:16:49.312348"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#update as HTML
  Parameters: {"turking_round_activity_session"=>{"activity_session_uid"=>nil}, "id"=>"8"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 8]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE ("comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL AND "comprehension_turking_round_activity_sessions"."id" != 8) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should include highlight data when the feedback object has highlights. 
-------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 136"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 136"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 137 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 136"], ["name", "MyString 147"], ["target_level", 1], ["parent_activity_id", 137], ["created_at", "2021-05-12 19:16:49.323440"], ["updated_at", "2021-05-12 19:16:49.323440"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 140], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.324853"], ["updated_at", "2021-05-12 19:16:49.324853"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 140], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.324853"], ["updated_at", "2021-05-12 19:16:49.324853"], ["id", 100], ["id", 100]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 100], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '35afda17-857d-424b-a5b8-47b3e20907bb' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "35afda17-857d-424b-a5b8-47b3e20907bb"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.329595"], ["updated_at", "2021-05-12 19:16:49.329595"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 100], ["rule_id", 127], ["created_at", "2021-05-12 19:16:49.330470"], ["updated_at", "2021-05-12 19:16:49.330470"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 127 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 100]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 127]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 127], ["created_at", "2021-05-12 19:16:49.333672"], ["updated_at", "2021-05-12 19:16:49.333672"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 15 AND "comprehension_feedbacks"."rule_id" = 127) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 127], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 15], ["created_at", "2021-05-12 19:16:49.335713"], ["updated_at", "2021-05-12 19:16:49.335713"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 100], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 127]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-38' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-38"], ["name", "AutoML-Model-Name"], ["prompt_id", 100], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-05-12 19:16:49.338879"], ["updated_at", "2021-05-12 19:16:49.338879"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_highlights" ("feedback_id", "text", "highlight_type", "starting_index", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["feedback_id", 44], ["text", "Highlight me"], ["highlight_type", "passage"], ["starting_index", 0], ["created_at", "2021-05-12 19:16:49.340385"], ["updated_at", "2021-05-12 19:16:49.340385"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m  [["prompt_id", 100], ["state", "active"]]
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_labels" ON "comprehension_labels"."rule_id" = "comprehension_rules"."id" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_labels"."name" = 'some label name' LIMIT 1  [["prompt_id", 100]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND (1=1)  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1[0m  [["rule_id", 127]]
  [1m[35mComprehension::Highlight Load (0.1ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1  [["feedback_id", 44]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #initialize should should have working accessor methods for all initialized fields. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 137"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 137"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 138 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 137"], ["name", "MyString 148"], ["target_level", 1], ["parent_activity_id", 138], ["created_at", "2021-05-12 19:16:49.347842"], ["updated_at", "2021-05-12 19:16:49.347842"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 141], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.349277"], ["updated_at", "2021-05-12 19:16:49.349277"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 141], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.349277"], ["updated_at", "2021-05-12 19:16:49.349277"], ["id", 101], ["id", 101]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 101], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a024432d-63e1-4830-99ba-c81984075e95' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "a024432d-63e1-4830-99ba-c81984075e95"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.363835"], ["updated_at", "2021-05-12 19:16:49.363835"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 101], ["rule_id", 128], ["created_at", "2021-05-12 19:16:49.364741"], ["updated_at", "2021-05-12 19:16:49.364741"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 128 LIMIT 1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 101]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 128]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 128], ["created_at", "2021-05-12 19:16:49.367708"], ["updated_at", "2021-05-12 19:16:49.367708"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 16 AND "comprehension_feedbacks"."rule_id" = 128) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 128], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 16], ["created_at", "2021-05-12 19:16:49.369784"], ["updated_at", "2021-05-12 19:16:49.369784"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 101], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 128]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-39' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-39"], ["name", "AutoML-Model-Name"], ["prompt_id", 101], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-05-12 19:16:49.373244"], ["updated_at", "2021-05-12 19:16:49.373244"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m  [["prompt_id", 101], ["state", "active"]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should return the feedback payload when there is a label match. 
------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 138"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 138"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 139 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 138"], ["name", "MyString 149"], ["target_level", 1], ["parent_activity_id", 139], ["created_at", "2021-05-12 19:16:49.378187"], ["updated_at", "2021-05-12 19:16:49.378187"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 142], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.379454"], ["updated_at", "2021-05-12 19:16:49.379454"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 142], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.379454"], ["updated_at", "2021-05-12 19:16:49.379454"], ["id", 102], ["id", 102]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 102], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2e0b83ab-bfe3-4a56-bacf-59050f4ed48f' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "2e0b83ab-bfe3-4a56-bacf-59050f4ed48f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.384786"], ["updated_at", "2021-05-12 19:16:49.384786"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 102], ["rule_id", 129], ["created_at", "2021-05-12 19:16:49.385803"], ["updated_at", "2021-05-12 19:16:49.385803"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 129 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 102]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 129]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 129], ["created_at", "2021-05-12 19:16:49.389273"], ["updated_at", "2021-05-12 19:16:49.389273"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 17 AND "comprehension_feedbacks"."rule_id" = 129) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 129], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 17], ["created_at", "2021-05-12 19:16:49.391634"], ["updated_at", "2021-05-12 19:16:49.391634"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 102], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 129]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-40' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-40"], ["name", "AutoML-Model-Name"], ["prompt_id", 102], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-05-12 19:16:49.394553"], ["updated_at", "2021-05-12 19:16:49.394553"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 102], ["state", "active"]]
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_labels" ON "comprehension_labels"."rule_id" = "comprehension_rules"."id" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_labels"."name" = 'some label name' LIMIT 1[0m  [["prompt_id", 102]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND (1=1)  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1  [["rule_id", 129]]
  [1m[36mComprehension::Highlight Load (0.1ms)[0m  [1mSELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1[0m  [["feedback_id", 46]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should return nil if there is no automl_model associated with the provided prompt. 
-------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 139"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 139"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 140 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 139"], ["name", "MyString 150"], ["target_level", 1], ["parent_activity_id", 140], ["created_at", "2021-05-12 19:16:49.402251"], ["updated_at", "2021-05-12 19:16:49.402251"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 143], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.403668"], ["updated_at", "2021-05-12 19:16:49.403668"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 143], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.403668"], ["updated_at", "2021-05-12 19:16:49.403668"], ["id", 103], ["id", 103]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 103], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8d5d5f1d-8d28-41c0-8152-486bcf6c1774' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "8d5d5f1d-8d28-41c0-8152-486bcf6c1774"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.409089"], ["updated_at", "2021-05-12 19:16:49.409089"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 103], ["rule_id", 130], ["created_at", "2021-05-12 19:16:49.410183"], ["updated_at", "2021-05-12 19:16:49.410183"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 130 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 103]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 130]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 130], ["created_at", "2021-05-12 19:16:49.413569"], ["updated_at", "2021-05-12 19:16:49.413569"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 18 AND "comprehension_feedbacks"."rule_id" = 130) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 130], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 18], ["created_at", "2021-05-12 19:16:49.415780"], ["updated_at", "2021-05-12 19:16:49.415780"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 103], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 130]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-41' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-41"], ["name", "AutoML-Model-Name"], ["prompt_id", 103], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-05-12 19:16:49.419532"], ["updated_at", "2021-05-12 19:16:49.419532"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1[0m  [["id", 37]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m  [["prompt_id", 103], ["state", "active"]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should return nil if there is no matched rule. 
-------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 140"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 140"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 141 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 140"], ["name", "MyString 151"], ["target_level", 1], ["parent_activity_id", 141], ["created_at", "2021-05-12 19:16:49.425908"], ["updated_at", "2021-05-12 19:16:49.425908"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 144], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.427210"], ["updated_at", "2021-05-12 19:16:49.427210"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 144], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-05-12 19:16:49.427210"], ["updated_at", "2021-05-12 19:16:49.427210"], ["id", 104], ["id", 104]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 104], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1b49cc79-6fee-4781-bdd7-b7f73ac795e4' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "1b49cc79-6fee-4781-bdd7-b7f73ac795e4"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.432052"], ["updated_at", "2021-05-12 19:16:49.432052"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 104], ["rule_id", 131], ["created_at", "2021-05-12 19:16:49.433066"], ["updated_at", "2021-05-12 19:16:49.433066"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 131 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 104]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 131]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 131], ["created_at", "2021-05-12 19:16:49.436113"], ["updated_at", "2021-05-12 19:16:49.436113"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 19 AND "comprehension_feedbacks"."rule_id" = 131) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 131], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 19], ["created_at", "2021-05-12 19:16:49.438230"], ["updated_at", "2021-05-12 19:16:49.438230"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 104], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 131]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-42' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-42"], ["name", "AutoML-Model-Name"], ["prompt_id", 104], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-05-12 19:16:49.441800"], ["updated_at", "2021-05-12 19:16:49.441800"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.1ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 104], ["state", "active"]]
  [1m[36mComprehension::Rule Load (0.6ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_labels" ON "comprehension_labels"."rule_id" = "comprehension_rules"."id" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_labels"."name" = 'NOTsome label name' LIMIT 1[0m  [["prompt_id", 104]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: custom validations should validate the presence of "case_sensitive". 
----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '14ec5ba8-ce84-49ea-8763-11924a8b5a2e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "14ec5ba8-ce84-49ea-8763-11924a8b5a2e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.447811"], ["updated_at", "2021-05-12 19:16:49.447811"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 132], ["regex_text", "test regex"], ["case_sensitive", "t"], ["created_at", "2021-05-12 19:16:49.449499"], ["updated_at", "2021-05-12 19:16:49.449499"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should require regex_text to be set. 
--------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: relationships should belong to rule. 
--------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should require rule to be set. 
--------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: custom validations should provide a default value for "case_sensitive". 
-------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4d7d3818-57ad-4c09-94e1-330f99962596' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "4d7d3818-57ad-4c09-94e1-330f99962596"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.458521"], ["updated_at", "2021-05-12 19:16:49.458521"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 133], ["regex_text", "test regex"], ["case_sensitive", "t"], ["created_at", "2021-05-12 19:16:49.459947"], ["updated_at", "2021-05-12 19:16:49.459947"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should ensure regex_text has a length of at most 200. 
-------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should ensure inclusion of case_sensitive in [true, false]. 
-------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should ensure inclusion of sequence_type in ["incorrect", "required"]. 
------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: custom validations should not override a "case_sensitive" with the default if one is provided. 
------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2d261098-ad1f-4c3b-ac5d-329b074dab7c' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "2d261098-ad1f-4c3b-ac5d-329b074dab7c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-05-12 19:16:49.467404"], ["updated_at", "2021-05-12 19:16:49.467404"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 134], ["regex_text", "test regex"], ["case_sensitive", "t"], ["created_at", "2021-05-12 19:16:49.468828"], ["updated_at", "2021-05-12 19:16:49.468828"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 134], ["regex_text", "test regex"], ["case_sensitive", "f"], ["created_at", "2021-05-12 19:16:49.469970"], ["updated_at", "2021-05-12 19:16:49.469970"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------
ComprehensionTest: test_: Comprehension should be a module. 
------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (2.6ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: create should create new records with state = inactive no matter what is passed in. 
--------------------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#create as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil, "automl_model_id"=>"MODEL-ID-1", "state"=>"active"}}
Unpermitted parameter: state
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (3.6ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-1' LIMIT 1
  [1m[36mSQL (5.4ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "labels", "state", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-1"], ["name", "AutoML-Model-Name"], ["labels", "{label1}"], ["state", "inactive"], ["created_at", "2021-06-01 16:58:40.519072"], ["updated_at", "2021-06-01 16:58:40.519072"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.5ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" IS NULL AND (created_at < '2021-06-01 16:58:40.519072')[0m
Completed 201 Created in 30ms (Views: 0.1ms | ActiveRecord: 11.0ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models"
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: create should not create an invalid record and return errors as json. 
------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#create as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil, "automl_model_id"=>""}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = '' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: index with automl_models should return successfully. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (3.0ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (1.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 3"]]
  [1m[35mSQL (2.6ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 3"]]
  [1m[36mComprehension::Activity Exists (2.7ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 142 LIMIT 1[0m
  [1m[35mSQL (1.6ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 3"], ["name", "MyString 3"], ["target_level", 1], ["parent_activity_id", 142], ["created_at", "2021-06-01 16:58:40.567050"], ["updated_at", "2021-06-01 16:58:40.567050"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (4.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 145], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.571830"], ["updated_at", "2021-06-01 16:58:40.571830"]]
  [1m[35mComprehension::Rule Load (1.9ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 145], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.571830"], ["updated_at", "2021-06-01 16:58:40.571830"], ["id", 105], ["id", 105]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-3' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-3"], ["name", "AutoML-Model-Name"], ["prompt_id", 105], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.586132"], ["updated_at", "2021-06-01 16:58:40.586132"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#index as HTML
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT "comprehension_automl_models".* FROM "comprehension_automl_models"[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:40.586132')  [["prompt_id", 105]]
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: create should create a valid record and return it as json. 
-------------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#create as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil, "automl_model_id"=>"MODEL-ID-4"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-4' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "labels", "state", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-4"], ["name", "AutoML-Model-Name"], ["labels", "{label1}"], ["state", "inactive"], ["created_at", "2021-06-01 16:58:40.599153"], ["updated_at", "2021-06-01 16:58:40.599153"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" IS NULL AND (created_at < '2021-06-01 16:58:40.599153')[0m
Completed 201 Created in 4ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: activate should return a 422 with the unmodified object if activation fails. 
-------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 5"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 5"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 143 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 5"], ["name", "MyString 5"], ["target_level", 1], ["parent_activity_id", 143], ["created_at", "2021-06-01 16:58:40.607124"], ["updated_at", "2021-06-01 16:58:40.607124"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 146], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.609221"], ["updated_at", "2021-06-01 16:58:40.609221"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 146], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.609221"], ["updated_at", "2021-06-01 16:58:40.609221"], ["id", 106], ["id", 106]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-5' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-5"], ["name", "AutoML-Model-Name"], ["prompt_id", 106], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.612474"], ["updated_at", "2021-06-01 16:58:40.612474"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#activate as HTML
  Parameters: {"id"=>"42"}
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 42]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:40.612474')  [["prompt_id", 106]]
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.4ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: update should not update read-only attributes return empty 204. 
------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 6"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 6"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 144 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 6"], ["name", "MyString 6"], ["target_level", 1], ["parent_activity_id", 144], ["created_at", "2021-06-01 16:58:40.623284"], ["updated_at", "2021-06-01 16:58:40.623284"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 147], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.624869"], ["updated_at", "2021-06-01 16:58:40.624869"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 147], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.624869"], ["updated_at", "2021-06-01 16:58:40.624869"], ["id", 107], ["id", 107]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-6' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-6"], ["name", "AutoML-Model-Name"], ["prompt_id", 107], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.628456"], ["updated_at", "2021-06-01 16:58:40.628456"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#update as HTML
  Parameters: {"automl_model"=>{"automl_model_id"=>"anything", "name"=>"anything", "labels"=>["anything"]}, "id"=>"43"}
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 43]]
Unpermitted parameters: name, labels
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'anything' AND "comprehension_automl_models"."id" != 43) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2  [["updated_at", "2021-06-01 16:58:40.636896"], ["id", 43]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 4ms (ActiveRecord: 1.2ms)
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 43]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: show should raise if not found (to be handled by parent app). 
----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 7"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 7"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 145 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 7"], ["name", "MyString 7"], ["target_level", 1], ["parent_activity_id", 145], ["created_at", "2021-06-01 16:58:40.642891"], ["updated_at", "2021-06-01 16:58:40.642891"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 148], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.644270"], ["updated_at", "2021-06-01 16:58:40.644270"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 148], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.644270"], ["updated_at", "2021-06-01 16:58:40.644270"], ["id", 108], ["id", 108]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-7' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-7"], ["name", "AutoML-Model-Name"], ["prompt_id", 108], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.647542"], ["updated_at", "2021-06-01 16:58:40.647542"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: update should update record if valid, return nothing. 
--------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 8"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 8"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 146 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 8"], ["name", "MyString 8"], ["target_level", 1], ["parent_activity_id", 146], ["created_at", "2021-06-01 16:58:40.656652"], ["updated_at", "2021-06-01 16:58:40.656652"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 149], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.658110"], ["updated_at", "2021-06-01 16:58:40.658110"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 149], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.658110"], ["updated_at", "2021-06-01 16:58:40.658110"], ["id", 109], ["id", 109]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-8' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-8"], ["name", "AutoML-Model-Name"], ["prompt_id", 109], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.660996"], ["updated_at", "2021-06-01 16:58:40.660996"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.4ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.6ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 9"]]
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 9"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 147 LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 9"], ["name", "MyString 9"], ["target_level", 1], ["parent_activity_id", 147], ["created_at", "2021-06-01 16:58:40.668654"], ["updated_at", "2021-06-01 16:58:40.668654"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 150], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.673422"], ["updated_at", "2021-06-01 16:58:40.673422"]]
  [1m[36mComprehension::Rule Load (0.9ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.7ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 150], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.673422"], ["updated_at", "2021-06-01 16:58:40.673422"], ["id", 110], ["id", 110]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#update as HTML
  Parameters: {"automl_model"=>{"prompt_id"=>nil}, "id"=>"45"}
  [1m[35mComprehension::AutomlModel Load (0.5ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 45]]
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-8' AND "comprehension_automl_models"."id" != 45) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "comprehension_automl_models" SET "prompt_id" = $1, "updated_at" = $2 WHERE "comprehension_automl_models"."id" = $3[0m  [["prompt_id", nil], ["updated_at", "2021-06-01 16:58:40.690093"], ["id", 45]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 6ms (ActiveRecord: 1.7ms)
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 45]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: index should return successfully - no automl_model. 
------------------------------------------------------------------------------------------------------
Processing by Comprehension::AutomlModelsController#index as HTML
  [1m[35mComprehension::AutomlModel Load (0.3ms)[0m  SELECT "comprehension_automl_models".* FROM "comprehension_automl_models"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: show should return json if found. 
------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 10"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 10"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 148 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 10"], ["name", "MyString 10"], ["target_level", 1], ["parent_activity_id", 148], ["created_at", "2021-06-01 16:58:40.709657"], ["updated_at", "2021-06-01 16:58:40.709657"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 151], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.711767"], ["updated_at", "2021-06-01 16:58:40.711767"]]
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 151], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.711767"], ["updated_at", "2021-06-01 16:58:40.711767"], ["id", 111], ["id", 111]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-9' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-9"], ["name", "AutoML-Model-Name"], ["prompt_id", 111], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.717781"], ["updated_at", "2021-06-01 16:58:40.717781"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#show as HTML
  Parameters: {"id"=>"46"}
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 46]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:40.717781')  [["prompt_id", 111]]
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: destroy should destroy record at id. 
---------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 11"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 11"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 149 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 11"], ["name", "MyString 11"], ["target_level", 1], ["parent_activity_id", 149], ["created_at", "2021-06-01 16:58:40.729811"], ["updated_at", "2021-06-01 16:58:40.729811"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 152], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.731421"], ["updated_at", "2021-06-01 16:58:40.731421"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 152], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.731421"], ["updated_at", "2021-06-01 16:58:40.731421"], ["id", 112], ["id", 112]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-10' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-10"], ["name", "AutoML-Model-Name"], ["prompt_id", 112], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.734731"], ["updated_at", "2021-06-01 16:58:40.734731"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::AutomlModelsController#destroy as HTML
  Parameters: {"id"=>"47"}
  [1m[36mComprehension::AutomlModel Load (0.4ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 47]]
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mDELETE FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1[0m  [["id", 47]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 3ms (ActiveRecord: 1.0ms)
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 47]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelsControllerTest: test_: activate should return an empty 200 response if activation is successful. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 12"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 12"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 150 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 12"], ["name", "MyString 12"], ["target_level", 1], ["parent_activity_id", 150], ["created_at", "2021-06-01 16:58:40.753718"], ["updated_at", "2021-06-01 16:58:40.753718"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 153], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.755207"], ["updated_at", "2021-06-01 16:58:40.755207"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 153], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.755207"], ["updated_at", "2021-06-01 16:58:40.755207"], ["id", 113], ["id", 113]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-11' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-11"], ["name", "AutoML-Model-Name"], ["prompt_id", 113], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:40.758050"], ["updated_at", "2021-06-01 16:58:40.758050"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::AutomlModelsController#activate as HTML
  Parameters: {"id"=>"48"}
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 48]]
Completed 204 No Content in 1ms (ActiveRecord: 0.2ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should validate that :order is case-sensitively unique within the scope of :rule_id. 
-------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Feedback Load (4.6ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks"  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (1.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2be72b4d-15a2-4eab-bf5d-03d7db7c7a62' LIMIT 1[0m
  [1m[35mSQL (2.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "2be72b4d-15a2-4eab-bf5d-03d7db7c7a62"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:40.790247"], ["updated_at", "2021-06-01 16:58:40.790247"]]
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 1], ["rule_id", 135], ["created_at", "2021-06-01 16:58:40.794457"], ["updated_at", "2021-06-01 16:58:40.794457"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 135]]
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 135) LIMIT 1
  [1m[36mComprehension::Feedback Load (0.3ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks"[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 136]]
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 136) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should validate that :rule cannot be empty/falsy. 
--------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should validate that :order looks like an integer greater than or equal to 0. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Feedback Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = -1 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should validate that :text cannot be empty/falsy. 
--------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Feedback Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 4 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: validations should validate that the length of :text is between 10 and 500. 
----------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Feedback Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 5 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 5 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Feedback Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 5 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 5 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Comprehension::FeedbackTest: test_: relationships should belong to rule. 
-------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested regex rule record when present in params. 
-----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.3ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 13"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 13"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 151 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 13"], ["name", "MyString 13"], ["target_level", 1], ["parent_activity_id", 151], ["created_at", "2021-06-01 16:58:40.845981"], ["updated_at", "2021-06-01 16:58:40.845981"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 154], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.861331"], ["updated_at", "2021-06-01 16:58:40.861331"]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 154], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.861331"], ["updated_at", "2021-06-01 16:58:40.861331"], ["id", 114], ["id", 114]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (2.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_regex_rules"[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "regex_rules_attributes"=>[{"regex_text"=>"MyString", "case_sensitive"=>false}]}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c8a3620d-9e23-4433-9bc9-2da824fd01be' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "c8a3620d-9e23-4433-9bc9-2da824fd01be"], ["created_at", "2021-06-01 16:58:40.888881"], ["updated_at", "2021-06-01 16:58:40.888881"]]
  [1m[36mSQL (1.8ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("regex_text", "case_sensitive", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["regex_text", "MyString"], ["case_sensitive", "f"], ["rule_id", 136], ["created_at", "2021-06-01 16:58:40.890093"], ["updated_at", "2021-06-01 16:58:40.890093"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (3.0ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 136]]
  [1m[35mComprehension::PlagiarismText Load (2.0ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 136]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 136]]
  [1m[35mComprehension::Label Load (1.0ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 136]]
  [1m[36mComprehension::RegexRule Load (0.2ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 136]]
Completed 201 Created in 42ms (Views: 0.1ms | ActiveRecord: 11.8ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_regex_rules"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: show should return json if found by uid. 
------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '07c8b648-80c5-4cb2-95dd-f2d2b8d42e13' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "07c8b648-80c5-4cb2-95dd-f2d2b8d42e13"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:40.924847"], ["updated_at", "2021-06-01 16:58:40.924847"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#show as HTML
  Parameters: {"id"=>"07c8b648-80c5-4cb2-95dd-f2d2b8d42e13"}
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "07c8b648-80c5-4cb2-95dd-f2d2b8d42e13"]]
  [1m[35m (0.4ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 137]]
  [1m[36mComprehension::PlagiarismText Load (0.2ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 137]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 137]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 137]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 137]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested highlight record when nested in feedback_attributes. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 14"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 14"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 152 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 14"], ["name", "MyString 14"], ["target_level", 1], ["parent_activity_id", 152], ["created_at", "2021-06-01 16:58:40.937266"], ["updated_at", "2021-06-01 16:58:40.937266"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 155], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.938569"], ["updated_at", "2021-06-01 16:58:40.938569"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 155], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.938569"], ["updated_at", "2021-06-01 16:58:40.938569"], ["id", 115], ["id", 115]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (1.4ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_highlights"[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 6 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e6f39d24-599b-4c34-a671-cc02e9e53b8f' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e6f39d24-599b-4c34-a671-cc02e9e53b8f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:40.946089"], ["updated_at", "2021-06-01 16:58:40.946089"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 6], ["rule_id", 138], ["created_at", "2021-06-01 16:58:40.947132"], ["updated_at", "2021-06-01 16:58:40.947132"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "feedbacks_attributes"=>[{"text"=>"Here is some test feedback.", "description"=>"Test description for test feedback record.", "order"=>"6", "highlights_attributes"=>[{"text"=>"Highlight me", "highlight_type"=>"passage", "starting_index"=>"2"}]}]}}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 6 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4a2467d6-e75e-4234-9e52-4691811fba42' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "4a2467d6-e75e-4234-9e52-4691811fba42"], ["created_at", "2021-06-01 16:58:40.959369"], ["updated_at", "2021-06-01 16:58:40.959369"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 6], ["rule_id", 139], ["created_at", "2021-06-01 16:58:40.960434"], ["updated_at", "2021-06-01 16:58:40.960434"]]
  [1m[36mSQL (1.4ms)[0m  [1mINSERT INTO "comprehension_highlights" ("text", "highlight_type", "starting_index", "feedback_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Highlight me"], ["highlight_type", "passage"], ["starting_index", 2], ["feedback_id", 51], ["created_at", "2021-06-01 16:58:40.961213"], ["updated_at", "2021-06-01 16:58:40.961213"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 139]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 139]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 139]]
  [1m[35mComprehension::Highlight Load (0.2ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1  [["feedback_id", 51]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 139]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 139]]
Completed 201 Created in 14ms (Views: 0.1ms | ActiveRecord: 4.1ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_highlights"[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update nested feedback attributes if present. 
-------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 15"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 15"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 153 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 15"], ["name", "MyString 15"], ["target_level", 1], ["parent_activity_id", 153], ["created_at", "2021-06-01 16:58:40.974719"], ["updated_at", "2021-06-01 16:58:40.974719"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 156], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.976253"], ["updated_at", "2021-06-01 16:58:40.976253"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 156], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:40.976253"], ["updated_at", "2021-06-01 16:58:40.976253"], ["id", 116], ["id", 116]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 116
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 156]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '92bccfb3-528a-41b0-b2ff-4734986e07c0' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "92bccfb3-528a-41b0-b2ff-4734986e07c0"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:40.985378"], ["updated_at", "2021-06-01 16:58:40.985378"]]
  [1m[36mSQL (2.0ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 116], ["rule_id", 140], ["created_at", "2021-06-01 16:58:40.986376"], ["updated_at", "2021-06-01 16:58:40.986376"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 8 AND "comprehension_feedbacks"."rule_id" = 140) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 140], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 8], ["created_at", "2021-06-01 16:58:40.990819"], ["updated_at", "2021-06-01 16:58:40.990819"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"feedbacks_attributes"=>[{"id"=>"52", "text"=>"new text for the feedbacks object"}]}, "id"=>"140"}
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "140"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 140]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."id" = 52  [["rule_id", 140]]
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 8 AND "comprehension_feedbacks"."id" != 52 AND "comprehension_feedbacks"."rule_id" = 140) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '92bccfb3-528a-41b0-b2ff-4734986e07c0' AND "comprehension_rules"."id" != 140) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_feedbacks" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_feedbacks"."id" = $3[0m  [["text", "new text for the feedbacks object"], ["updated_at", "2021-06-01 16:58:40.999544"], ["id", 52]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 6ms (ActiveRecord: 1.6ms)
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."id" = $1 LIMIT 1[0m  [["id", 52]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: destroy should destroy record at id. 
--------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '884b8748-e46f-4353-9ee9-f29e1fe2a5ca' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "884b8748-e46f-4353-9ee9-f29e1fe2a5ca"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.003540"], ["updated_at", "2021-06-01 16:58:41.003540"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#destroy as HTML
  Parameters: {"id"=>"141"}
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "141"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 141]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Load (0.3ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 141]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 141]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 141]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 141]]
  [1m[36mSQL (0.5ms)[0m  [1mDELETE FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1[0m  [["id", 141]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 5ms (ActiveRecord: 2.0ms)
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 141]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update nested highlight attributes in feedback if present. 
--------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 16"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 16"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 154 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 16"], ["name", "MyString 16"], ["target_level", 1], ["parent_activity_id", 154], ["created_at", "2021-06-01 16:58:41.019795"], ["updated_at", "2021-06-01 16:58:41.019795"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 157], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.021185"], ["updated_at", "2021-06-01 16:58:41.021185"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 157], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.021185"], ["updated_at", "2021-06-01 16:58:41.021185"], ["id", 117], ["id", 117]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 117
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 157]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8c6432b9-90a9-43e7-aada-aa31e7462f6e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "8c6432b9-90a9-43e7-aada-aa31e7462f6e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.027346"], ["updated_at", "2021-06-01 16:58:41.027346"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 117], ["rule_id", 142], ["created_at", "2021-06-01 16:58:41.028267"], ["updated_at", "2021-06-01 16:58:41.028267"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 9 AND "comprehension_feedbacks"."rule_id" = 142) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 142], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 9], ["created_at", "2021-06-01 16:58:41.030681"], ["updated_at", "2021-06-01 16:58:41.030681"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "comprehension_highlights" ("feedback_id", "text", "highlight_type", "starting_index", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["feedback_id", 53], ["text", "Highlight me"], ["highlight_type", "passage"], ["starting_index", 0], ["created_at", "2021-06-01 16:58:41.032431"], ["updated_at", "2021-06-01 16:58:41.032431"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"feedbacks_attributes"=>[{"id"=>"53", "highlights_attributes"=>[{"id"=>"5", "text"=>"New text to highlight"}]}]}, "id"=>"142"}
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "142"]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 142]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."id" = 53[0m  [["rule_id", 142]]
  [1m[35mComprehension::Highlight Load (0.1ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1 AND "comprehension_highlights"."id" = 5  [["feedback_id", 53]]
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 9 AND "comprehension_feedbacks"."id" != 53 AND "comprehension_feedbacks"."rule_id" = 142) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '8c6432b9-90a9-43e7-aada-aa31e7462f6e' AND "comprehension_rules"."id" != 142) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_highlights" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_highlights"."id" = $3[0m  [["text", "New text to highlight"], ["updated_at", "2021-06-01 16:58:41.044283"], ["id", 5]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 7ms (ActiveRecord: 2.1ms)
  [1m[36mComprehension::Highlight Load (0.3ms)[0m  [1mSELECT  "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."id" = $1 LIMIT 1[0m  [["id", 5]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested feedback record when present in params. 
---------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 17"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 17"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 155 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 17"], ["name", "MyString 17"], ["target_level", 1], ["parent_activity_id", 155], ["created_at", "2021-06-01 16:58:41.050764"], ["updated_at", "2021-06-01 16:58:41.050764"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 158], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.052327"], ["updated_at", "2021-06-01 16:58:41.052327"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.6ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 158], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.052327"], ["updated_at", "2021-06-01 16:58:41.052327"], ["id", 118], ["id", 118]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_feedbacks"
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "feedbacks_attributes"=>[{"text"=>"Here is some test feedback.", "description"=>"Test description for test feedback record.", "order"=>"10"}]}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 10 AND "comprehension_feedbacks"."rule_id" IS NULL) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '290f1ec0-213c-491c-ab8d-11e4a00a281e' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "290f1ec0-213c-491c-ab8d-11e4a00a281e"], ["created_at", "2021-06-01 16:58:41.065642"], ["updated_at", "2021-06-01 16:58:41.065642"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("text", "description", "order", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 10], ["rule_id", 143], ["created_at", "2021-06-01 16:58:41.066975"], ["updated_at", "2021-06-01 16:58:41.066975"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 143]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 143]]
  [1m[36mComprehension::Feedback Load (0.3ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 143]]
  [1m[35mComprehension::Highlight Load (0.4ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1  [["feedback_id", 54]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 143]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 143]]
Completed 201 Created in 11ms (Views: 0.1ms | ActiveRecord: 3.1ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_feedbacks"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should not update record and return errors as json. 
------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 18"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 18"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 156 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 18"], ["name", "MyString 18"], ["target_level", 1], ["parent_activity_id", 156], ["created_at", "2021-06-01 16:58:41.078392"], ["updated_at", "2021-06-01 16:58:41.078392"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 159], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.080386"], ["updated_at", "2021-06-01 16:58:41.080386"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 159], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.080386"], ["updated_at", "2021-06-01 16:58:41.080386"], ["id", 119], ["id", 119]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 119
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Load (0.3ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 159]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6cec6a38-6981-4068-9f0e-ee2767a2f1cc' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "6cec6a38-6981-4068-9f0e-ee2767a2f1cc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.085944"], ["updated_at", "2021-06-01 16:58:41.085944"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 119], ["rule_id", 144], ["created_at", "2021-06-01 16:58:41.087248"], ["updated_at", "2021-06-01 16:58:41.087248"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"-1", "rule_type"=>"rules-based-1", "universal"=>false}, "id"=>"144"}
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "144"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 144]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '6cec6a38-6981-4068-9f0e-ee2767a2f1cc' AND "comprehension_rules"."id" != 144) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index should return successfully - no rule. 
---------------------------------------------------------------------------------------
Processing by Comprehension::RulesController#index as HTML
  [1m[35mComprehension::Rule Load (2.6ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules"
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 2.6ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create a valid record with plagiarism_text attributes. 
----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 19"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 19"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 157 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 19"], ["name", "MyString 19"], ["target_level", 1], ["parent_activity_id", 157], ["created_at", "2021-06-01 16:58:41.106406"], ["updated_at", "2021-06-01 16:58:41.106406"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 160], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.107691"], ["updated_at", "2021-06-01 16:58:41.107691"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 160], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.107691"], ["updated_at", "2021-06-01 16:58:41.107691"], ["id", 120], ["id", 120]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "plagiarism_text_attributes"=>{"text"=>"Here is some text to be checked for plagiarism."}}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8e3fbfa7-06a1-4e5d-9d23-0c91812b6d78' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "8e3fbfa7-06a1-4e5d-9d23-0c91812b6d78"], ["created_at", "2021-06-01 16:58:41.119939"], ["updated_at", "2021-06-01 16:58:41.119939"]]
  [1m[35mSQL (1.7ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("text", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["text", "Here is some text to be checked for plagiarism."], ["rule_id", 145], ["created_at", "2021-06-01 16:58:41.120853"], ["updated_at", "2021-06-01 16:58:41.120853"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 145]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 145]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 145]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 145]]
Completed 201 Created in 11ms (Views: 0.1ms | ActiveRecord: 3.9ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should return an error if plagiarism rule already exists for prompt. 
-----------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 20"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 20"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 158 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 20"], ["name", "MyString 20"], ["target_level", 1], ["parent_activity_id", 158], ["created_at", "2021-06-01 16:58:41.130051"], ["updated_at", "2021-06-01 16:58:41.130051"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 161], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.131374"], ["updated_at", "2021-06-01 16:58:41.131374"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 161], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.131374"], ["updated_at", "2021-06-01 16:58:41.131374"], ["id", 121], ["id", 121]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.4ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 121
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 121], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 161]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '95693666-37b7-4ed9-a0f9-a9f42677c917' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "95693666-37b7-4ed9-a0f9-a9f42677c917"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.141115"], ["updated_at", "2021-06-01 16:58:41.141115"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 121], ["rule_id", 146], ["created_at", "2021-06-01 16:58:41.142157"], ["updated_at", "2021-06-01 16:58:41.142157"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"8a8f22a6-5f98-45c9-81fc-4e925f2f6dba", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "suborder"=>"1", "rule_type"=>"plagiarism", "universal"=>false, "state"=>"active", "prompt_ids"=>["121"]}}
  [1m[35mComprehension::Prompt Load (0.4ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 121
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 121], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 161]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '81b7cb42-5042-4b07-8803-a209af833c04' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 6ms (Views: 0.1ms | ActiveRecord: 1.7ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get unique Rules for specified prompts when provided. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 21"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 21"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 159 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 21"], ["name", "MyString 21"], ["target_level", 1], ["parent_activity_id", 159], ["created_at", "2021-06-01 16:58:41.156957"], ["updated_at", "2021-06-01 16:58:41.156957"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 162], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.158364"], ["updated_at", "2021-06-01 16:58:41.158364"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 162], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.158364"], ["updated_at", "2021-06-01 16:58:41.158364"], ["id", 122], ["id", 122]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 22"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 22"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 160 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 22"], ["name", "MyString 22"], ["target_level", 1], ["parent_activity_id", 160], ["created_at", "2021-06-01 16:58:41.173765"], ["updated_at", "2021-06-01 16:58:41.173765"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 163], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.175419"], ["updated_at", "2021-06-01 16:58:41.175419"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 163], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.175419"], ["updated_at", "2021-06-01 16:58:41.175419"], ["id", 123], ["id", 123]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'dafaa001-fa91-42c0-8a43-c6abc3d9df9d' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "dafaa001-fa91-42c0-8a43-c6abc3d9df9d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.179624"], ["updated_at", "2021-06-01 16:58:41.179624"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 122], ["rule_id", 147], ["created_at", "2021-06-01 16:58:41.180857"], ["updated_at", "2021-06-01 16:58:41.180857"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd072a6dd-26f5-4e89-8c21-c85c9131253b' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "d072a6dd-26f5-4e89-8c21-c85c9131253b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.185802"], ["updated_at", "2021-06-01 16:58:41.185802"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 122], ["rule_id", 148], ["created_at", "2021-06-01 16:58:41.187625"], ["updated_at", "2021-06-01 16:58:41.187625"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8a4ac5ed-7590-4e70-bc87-0eac10475fc8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "8a4ac5ed-7590-4e70-bc87-0eac10475fc8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.191476"], ["updated_at", "2021-06-01 16:58:41.191476"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 123], ["rule_id", 149], ["created_at", "2021-06-01 16:58:41.192561"], ["updated_at", "2021-06-01 16:58:41.192561"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cecd45b8-366e-4cf1-ad70-823d50353769' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "cecd45b8-366e-4cf1-ad70-823d50353769"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.196073"], ["updated_at", "2021-06-01 16:58:41.196073"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 123], ["rule_id", 150], ["created_at", "2021-06-01 16:58:41.197231"], ["updated_at", "2021-06-01 16:58:41.197231"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b46003f5-1f24-4874-9e3f-bf7638d1b0fa' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b46003f5-1f24-4874-9e3f-bf7638d1b0fa"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.201950"], ["updated_at", "2021-06-01 16:58:41.201950"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 122], ["rule_id", 151], ["created_at", "2021-06-01 16:58:41.203051"], ["updated_at", "2021-06-01 16:58:41.203051"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 123], ["rule_id", 151], ["created_at", "2021-06-01 16:58:41.203763"], ["updated_at", "2021-06-01 16:58:41.203763"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"prompt_id"=>"122, 123"}
  [1m[35mComprehension::Rule Load (1.1ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts_rules"."rule_id" = "comprehension_rules"."id" WHERE "comprehension_prompts_rules"."prompt_id" IN (122, 123)
  [1m[36m (0.4ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 147]]
  [1m[35mComprehension::PlagiarismText Load (0.3ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 147]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 147]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 147]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 147]]
  [1m[35m (0.2ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 148]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 148]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 148]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 148]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 148]]
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 149]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 149]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 149]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 149]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 149]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 150]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 150]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 150]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 150]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 150]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 151]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 151]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 151]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 151]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 151]]
Completed 200 OK in 18ms (Views: 0.1ms | ActiveRecord: 4.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should not create an invalid record and return errors as json. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 23"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 23"]]
  [1m[35mComprehension::Activity Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 161 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 23"], ["name", "MyString 23"], ["target_level", 1], ["parent_activity_id", 161], ["created_at", "2021-06-01 16:58:41.233799"], ["updated_at", "2021-06-01 16:58:41.233799"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 164], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.235753"], ["updated_at", "2021-06-01 16:58:41.235753"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 164], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.235753"], ["updated_at", "2021-06-01 16:58:41.235753"], ["id", 124], ["id", 124]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"3238d835-85cb-4ca2-b106-022c36578e0a", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>nil, "suborder"=>"-1", "rule_type"=>"rules-based-1", "universal"=>false}}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8d933bba-df49-498e-a14a-d128f210d51b' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 3ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_rules"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create nested label record when present in params. 
------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 24"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 24"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 162 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 24"], ["name", "MyString 24"], ["target_level", 1], ["parent_activity_id", 162], ["created_at", "2021-06-01 16:58:41.251359"], ["updated_at", "2021-06-01 16:58:41.251359"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 165], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.252948"], ["updated_at", "2021-06-01 16:58:41.252948"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 165], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.252948"], ["updated_at", "2021-06-01 16:58:41.252948"], ["id", 125], ["id", 125]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_labels"
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "label_attributes"=>{"name"=>"some label name"}}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" IS NULL LIMIT 1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '646c2c72-b709-48fe-beca-46d686eb0b78' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "646c2c72-b709-48fe-beca-46d686eb0b78"], ["created_at", "2021-06-01 16:58:41.266284"], ["updated_at", "2021-06-01 16:58:41.266284"]]
  [1m[36mSQL (1.9ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 152], ["created_at", "2021-06-01 16:58:41.267700"], ["updated_at", "2021-06-01 16:58:41.267700"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.2ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 152]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 152]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 152]]
Completed 201 Created in 11ms (Views: 0.1ms | ActiveRecord: 3.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_labels"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update record if valid, return nothing. 
-------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 25"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 25"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 163 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 25"], ["name", "MyString 25"], ["target_level", 1], ["parent_activity_id", 163], ["created_at", "2021-06-01 16:58:41.277378"], ["updated_at", "2021-06-01 16:58:41.277378"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 166], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.278942"], ["updated_at", "2021-06-01 16:58:41.278942"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 166], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.278942"], ["updated_at", "2021-06-01 16:58:41.278942"], ["id", 126], ["id", 126]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 126[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 166]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9bd378e0-fa08-4cc2-a9d0-ad54df1ef565' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "9bd378e0-fa08-4cc2-a9d0-ad54df1ef565"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.284026"], ["updated_at", "2021-06-01 16:58:41.284026"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 126], ["rule_id", 153], ["created_at", "2021-06-01 16:58:41.284913"], ["updated_at", "2021-06-01 16:58:41.284913"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 26"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 26"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 164 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 26"], ["name", "MyString 26"], ["target_level", 1], ["parent_activity_id", 164], ["created_at", "2021-06-01 16:58:41.288283"], ["updated_at", "2021-06-01 16:58:41.288283"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 167], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.289520"], ["updated_at", "2021-06-01 16:58:41.289520"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 167], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.289520"], ["updated_at", "2021-06-01 16:58:41.289520"], ["id", 127], ["id", 127]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "prompt_ids"=>["127"]}, "id"=>"153"}
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "153"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 153]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 127[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 153]]
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "comprehension_prompts_rules" WHERE "comprehension_prompts_rules"."rule_id" = $1 AND "comprehension_prompts_rules"."prompt_id" = 126[0m  [["rule_id", 153]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 153], ["prompt_id", 127], ["created_at", "2021-06-01 16:58:41.299121"], ["updated_at", "2021-06-01 16:58:41.299121"]]
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '9bd378e0-fa08-4cc2-a9d0-ad54df1ef565' AND "comprehension_rules"."id" != 153) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 8ms (ActiveRecord: 2.1ms)
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 153]]
  [1m[35m (0.3ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 153]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get Rules for the intersection of prompt and rule type when both are provided. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 27"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 27"]]
  [1m[36mComprehension::Activity Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 165 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 27"], ["name", "MyString 27"], ["target_level", 1], ["parent_activity_id", 165], ["created_at", "2021-06-01 16:58:41.312150"], ["updated_at", "2021-06-01 16:58:41.312150"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 168], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.314382"], ["updated_at", "2021-06-01 16:58:41.314382"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 168], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.314382"], ["updated_at", "2021-06-01 16:58:41.314382"], ["id", 128], ["id", 128]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 28"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 28"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 166 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 28"], ["name", "MyString 28"], ["target_level", 1], ["parent_activity_id", 166], ["created_at", "2021-06-01 16:58:41.320482"], ["updated_at", "2021-06-01 16:58:41.320482"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 169], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.322048"], ["updated_at", "2021-06-01 16:58:41.322048"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 169], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.322048"], ["updated_at", "2021-06-01 16:58:41.322048"], ["id", 129], ["id", 129]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '91dbf709-578b-490b-8048-03e6794019b3' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "91dbf709-578b-490b-8048-03e6794019b3"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.326127"], ["updated_at", "2021-06-01 16:58:41.326127"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 128], ["rule_id", 154], ["created_at", "2021-06-01 16:58:41.326994"], ["updated_at", "2021-06-01 16:58:41.326994"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '54e91880-3b84-4b84-aba8-ac2f051f1707' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "54e91880-3b84-4b84-aba8-ac2f051f1707"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.329794"], ["updated_at", "2021-06-01 16:58:41.329794"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 128], ["rule_id", 155], ["created_at", "2021-06-01 16:58:41.330636"], ["updated_at", "2021-06-01 16:58:41.330636"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'deb5de21-74d9-4f25-9105-44caa5e2a56a' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "deb5de21-74d9-4f25-9105-44caa5e2a56a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.334486"], ["updated_at", "2021-06-01 16:58:41.334486"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 129], ["rule_id", 156], ["created_at", "2021-06-01 16:58:41.335902"], ["updated_at", "2021-06-01 16:58:41.335902"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5254d2c6-a1a8-4949-9bba-98e902d5e133' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5254d2c6-a1a8-4949-9bba-98e902d5e133"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.339186"], ["updated_at", "2021-06-01 16:58:41.339186"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 129], ["rule_id", 157], ["created_at", "2021-06-01 16:58:41.340227"], ["updated_at", "2021-06-01 16:58:41.340227"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ef51eece-cb09-4ad5-9e1f-ab95f3652888' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "ef51eece-cb09-4ad5-9e1f-ab95f3652888"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.344094"], ["updated_at", "2021-06-01 16:58:41.344094"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 128], ["rule_id", 158], ["created_at", "2021-06-01 16:58:41.345262"], ["updated_at", "2021-06-01 16:58:41.345262"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 129], ["rule_id", 158], ["created_at", "2021-06-01 16:58:41.346181"], ["updated_at", "2021-06-01 16:58:41.346181"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"prompt_id"=>"128", "rule_type"=>"autoML"}
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts_rules"."rule_id" = "comprehension_rules"."id" WHERE "comprehension_prompts_rules"."prompt_id" = 128 AND "comprehension_rules"."rule_type" = $1[0m  [["rule_type", "autoML"]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 154]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 154]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 154]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 154]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 154]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.1ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: show should return json if found by id. 
-----------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '88570976-ca07-4a6a-b41f-877715226a78' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "88570976-ca07-4a6a-b41f-877715226a78"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.357364"], ["updated_at", "2021-06-01 16:58:41.357364"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#show as HTML
  Parameters: {"id"=>"159"}
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "159"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 159]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 159]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 159]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 159]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 159]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 159]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get Rules for specified rule type when provided. 
---------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 29"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 29"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 167 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 29"], ["name", "MyString 29"], ["target_level", 1], ["parent_activity_id", 167], ["created_at", "2021-06-01 16:58:41.369802"], ["updated_at", "2021-06-01 16:58:41.369802"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 170], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.371341"], ["updated_at", "2021-06-01 16:58:41.371341"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 170], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.371341"], ["updated_at", "2021-06-01 16:58:41.371341"], ["id", 130], ["id", 130]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 30"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 30"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 168 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 30"], ["name", "MyString 30"], ["target_level", 1], ["parent_activity_id", 168], ["created_at", "2021-06-01 16:58:41.376830"], ["updated_at", "2021-06-01 16:58:41.376830"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 171], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.378264"], ["updated_at", "2021-06-01 16:58:41.378264"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 171], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.378264"], ["updated_at", "2021-06-01 16:58:41.378264"], ["id", 131], ["id", 131]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5af51c9d-7184-4888-a4ab-20ef5d1445a1' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5af51c9d-7184-4888-a4ab-20ef5d1445a1"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.382796"], ["updated_at", "2021-06-01 16:58:41.382796"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 130], ["rule_id", 160], ["created_at", "2021-06-01 16:58:41.383710"], ["updated_at", "2021-06-01 16:58:41.383710"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '52dacb11-7a7e-456d-8a71-ca7d13e437cb' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "52dacb11-7a7e-456d-8a71-ca7d13e437cb"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.386634"], ["updated_at", "2021-06-01 16:58:41.386634"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 130], ["rule_id", 161], ["created_at", "2021-06-01 16:58:41.387466"], ["updated_at", "2021-06-01 16:58:41.387466"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '02ad7593-228b-4269-bc85-c7adc28ba18e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "02ad7593-228b-4269-bc85-c7adc28ba18e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.390468"], ["updated_at", "2021-06-01 16:58:41.390468"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 131], ["rule_id", 162], ["created_at", "2021-06-01 16:58:41.391394"], ["updated_at", "2021-06-01 16:58:41.391394"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '10ebec91-920f-4486-bbf6-b9a9d8b23cbc' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "10ebec91-920f-4486-bbf6-b9a9d8b23cbc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.394281"], ["updated_at", "2021-06-01 16:58:41.394281"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 131], ["rule_id", 163], ["created_at", "2021-06-01 16:58:41.395443"], ["updated_at", "2021-06-01 16:58:41.395443"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '66fa491b-8600-499f-a4f6-9368d09c61c5' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "66fa491b-8600-499f-a4f6-9368d09c61c5"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.399532"], ["updated_at", "2021-06-01 16:58:41.399532"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 130], ["rule_id", 164], ["created_at", "2021-06-01 16:58:41.400865"], ["updated_at", "2021-06-01 16:58:41.400865"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 131], ["rule_id", 164], ["created_at", "2021-06-01 16:58:41.401932"], ["updated_at", "2021-06-01 16:58:41.401932"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"rule_type"=>"autoML"}
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  [["rule_type", "autoML"]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 160]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 160]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 160]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 160]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 160]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 162]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 162]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 162]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 162]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 162]]
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 1.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should not update read-only nested label name. 
-------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 31"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 31"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 169 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 31"], ["name", "MyString 31"], ["target_level", 1], ["parent_activity_id", 169], ["created_at", "2021-06-01 16:58:41.415447"], ["updated_at", "2021-06-01 16:58:41.415447"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 172], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.425524"], ["updated_at", "2021-06-01 16:58:41.425524"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 172], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.425524"], ["updated_at", "2021-06-01 16:58:41.425524"], ["id", 132], ["id", 132]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 132[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 172]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f34879bc-b81e-4828-8bf8-7e0db5d59688' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "f34879bc-b81e-4828-8bf8-7e0db5d59688"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.430630"], ["updated_at", "2021-06-01 16:58:41.430630"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 132], ["rule_id", 165], ["created_at", "2021-06-01 16:58:41.431524"], ["updated_at", "2021-06-01 16:58:41.431524"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 165 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 132]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 165]]
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 165], ["created_at", "2021-06-01 16:58:41.438083"], ["updated_at", "2021-06-01 16:58:41.438083"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"label_attributes"=>{"id"=>"30", "name"=>"can not be updated"}}, "id"=>"165"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "165"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 165]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 165]]
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 165 AND "comprehension_labels"."id" != 30) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f34879bc-b81e-4828-8bf8-7e0db5d59688' AND "comprehension_rules"."id" != 165) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_labels" SET "updated_at" = $1 WHERE "comprehension_labels"."id" = $2  [["updated_at", "2021-06-01 16:58:41.448181"], ["id", 30]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 6ms (ActiveRecord: 1.6ms)
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."id" = $1 LIMIT 1  [["id", 30]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update nested regex rule attributes if present. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 32"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 32"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 170 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 32"], ["name", "MyString 32"], ["target_level", 1], ["parent_activity_id", 170], ["created_at", "2021-06-01 16:58:41.454057"], ["updated_at", "2021-06-01 16:58:41.454057"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 173], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.455864"], ["updated_at", "2021-06-01 16:58:41.455864"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 173], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.455864"], ["updated_at", "2021-06-01 16:58:41.455864"], ["id", 133], ["id", 133]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 133[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 173]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e3100991-2a65-45d7-8bfe-cd049fac9936' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e3100991-2a65-45d7-8bfe-cd049fac9936"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.460990"], ["updated_at", "2021-06-01 16:58:41.460990"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 133], ["rule_id", 166], ["created_at", "2021-06-01 16:58:41.461892"], ["updated_at", "2021-06-01 16:58:41.461892"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 166], ["regex_text", "MyString"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:41.464004"], ["updated_at", "2021-06-01 16:58:41.464004"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"regex_rules_attributes"=>[{"id"=>"33", "regex_text"=>"new regex text"}]}, "id"=>"166"}
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "166"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 166]]
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1 AND "comprehension_regex_rules"."id" = 33  [["rule_id", 166]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'e3100991-2a65-45d7-8bfe-cd049fac9936' AND "comprehension_rules"."id" != 166) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_regex_rules" SET "regex_text" = $1, "updated_at" = $2 WHERE "comprehension_regex_rules"."id" = $3  [["regex_text", "new regex text"], ["updated_at", "2021-06-01 16:58:41.474375"], ["id", 33]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 6ms (ActiveRecord: 1.5ms)
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT  "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."id" = $1 LIMIT 1  [["id", 33]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: show should raise if not found (to be handled by parent app). 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a4fe5ba2-0bf5-44bf-9ad9-b8ea3505d030' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "a4fe5ba2-0bf5-44bf-9ad9-b8ea3505d030"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.478514"], ["updated_at", "2021-06-01 16:58:41.478514"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1[0m  [["uid", "99999"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with rules should return successfully. 
----------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c281599f-bba3-4b7b-b394-6bba413e67b5' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "c281599f-bba3-4b7b-b394-6bba413e67b5"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.486593"], ["updated_at", "2021-06-01 16:58:41.486593"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::RulesController#index as HTML
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules"[0m
  [1m[35m (0.2ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 168]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 168]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 168]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 168]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 168]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should update a valid record with plagiarism_text attributes. 
----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 33"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 33"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 171 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 33"], ["name", "MyString 33"], ["target_level", 1], ["parent_activity_id", 171], ["created_at", "2021-06-01 16:58:41.498988"], ["updated_at", "2021-06-01 16:58:41.498988"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 174], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.501282"], ["updated_at", "2021-06-01 16:58:41.501282"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 174], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.501282"], ["updated_at", "2021-06-01 16:58:41.501282"], ["id", 134], ["id", 134]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.4ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 134[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 174]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '40b865bb-4ae9-4ce5-8e10-4c3aa313790f' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "40b865bb-4ae9-4ce5-8e10-4c3aa313790f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.508075"], ["updated_at", "2021-06-01 16:58:41.508075"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 134], ["rule_id", 169], ["created_at", "2021-06-01 16:58:41.508935"], ["updated_at", "2021-06-01 16:58:41.508935"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"plagiarism_text_attributes"=>{"text"=>"New plagiarism text"}}, "id"=>"169"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "169"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 169]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 169]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '40b865bb-4ae9-4ce5-8e10-4c3aa313790f' AND "comprehension_rules"."id" != 169) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("text", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["text", "New plagiarism text"], ["rule_id", 169], ["created_at", "2021-06-01 16:58:41.516440"], ["updated_at", "2021-06-01 16:58:41.516440"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 4ms (ActiveRecord: 1.1ms)
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 169]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 169]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should create a valid record and return it as json. 
------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 34"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 34"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 172 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 34"], ["name", "MyString 34"], ["target_level", 1], ["parent_activity_id", 172], ["created_at", "2021-06-01 16:58:41.522466"], ["updated_at", "2021-06-01 16:58:41.522466"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 175], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.523736"], ["updated_at", "2021-06-01 16:58:41.523736"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 175], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.523736"], ["updated_at", "2021-06-01 16:58:41.523736"], ["id", 135], ["id", 135]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_rules"[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"ConceptUID", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "state"=>"inactive", "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "prompt_ids"=>[]}}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE 1=0
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '42a6a33e-d9fc-462e-8b62-9a870786e2d6' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["uid", "42a6a33e-d9fc-462e-8b62-9a870786e2d6"], ["created_at", "2021-06-01 16:58:41.533896"], ["updated_at", "2021-06-01 16:58:41.533896"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 170]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 170]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 170]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 170]]
Completed 201 Created in 6ms (Views: 0.1ms | ActiveRecord: 1.6ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_rules"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: create should return an error if regex is invalid. 
----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 35"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 35"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 173 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 35"], ["name", "MyString 35"], ["target_level", 1], ["parent_activity_id", 173], ["created_at", "2021-06-01 16:58:41.541704"], ["updated_at", "2021-06-01 16:58:41.541704"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 176], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.543394"], ["updated_at", "2021-06-01 16:58:41.543394"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 176], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.543394"], ["updated_at", "2021-06-01 16:58:41.543394"], ["id", 136], ["id", 136]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#create as HTML
  Parameters: {"rule"=>{"concept_uid"=>"17c79763-8b6b-471c-b4dd-5bc2032ecbdf", "note"=>"This rule is a test", "name"=>"Test Rule", "optimal"=>false, "suborder"=>"1", "rule_type"=>"rules-based-1", "universal"=>false, "state"=>"inactive", "regex_rules_attributes"=>[{"regex_text"=>"(invalid|", "case_sensitive"=>false}]}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b5727b87-7aa4-434e-a91c-5604c2dac81f' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "17c79763-8b6b-471c-b4dd-5bc2032ecbdf"], ["uid", "b5727b87-7aa4-434e-a91c-5604c2dac81f"], ["created_at", "2021-06-01 16:58:41.551450"], ["updated_at", "2021-06-01 16:58:41.551450"]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.1ms | ActiveRecord: 0.8ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: index with filter params should only get Rules for specified prompt when provided. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 36"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 36"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 174 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 36"], ["name", "MyString 36"], ["target_level", 1], ["parent_activity_id", 174], ["created_at", "2021-06-01 16:58:41.556784"], ["updated_at", "2021-06-01 16:58:41.556784"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 177], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.558295"], ["updated_at", "2021-06-01 16:58:41.558295"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 177], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.558295"], ["updated_at", "2021-06-01 16:58:41.558295"], ["id", 137], ["id", 137]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 37"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 37"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 175 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 37"], ["name", "MyString 37"], ["target_level", 1], ["parent_activity_id", 175], ["created_at", "2021-06-01 16:58:41.562949"], ["updated_at", "2021-06-01 16:58:41.562949"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 178], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.564182"], ["updated_at", "2021-06-01 16:58:41.564182"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 178], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.564182"], ["updated_at", "2021-06-01 16:58:41.564182"], ["id", 138], ["id", 138]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f6a20df7-8335-4278-b76f-9bfd0882e587' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f6a20df7-8335-4278-b76f-9bfd0882e587"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.569941"], ["updated_at", "2021-06-01 16:58:41.569941"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 137], ["rule_id", 172], ["created_at", "2021-06-01 16:58:41.571112"], ["updated_at", "2021-06-01 16:58:41.571112"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'db74d816-c1a1-4520-b0c3-0f797e455072' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "db74d816-c1a1-4520-b0c3-0f797e455072"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.575352"], ["updated_at", "2021-06-01 16:58:41.575352"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 137], ["rule_id", 173], ["created_at", "2021-06-01 16:58:41.576367"], ["updated_at", "2021-06-01 16:58:41.576367"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '38afb3fe-a176-4f06-9f78-4d63ab303959' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "38afb3fe-a176-4f06-9f78-4d63ab303959"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.579801"], ["updated_at", "2021-06-01 16:58:41.579801"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 138], ["rule_id", 174], ["created_at", "2021-06-01 16:58:41.580919"], ["updated_at", "2021-06-01 16:58:41.580919"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2a0bbe26-597a-42f4-b5b5-ad7f1e29c2b8' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "2a0bbe26-597a-42f4-b5b5-ad7f1e29c2b8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "grammar"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.584208"], ["updated_at", "2021-06-01 16:58:41.584208"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 138], ["rule_id", 175], ["created_at", "2021-06-01 16:58:41.585084"], ["updated_at", "2021-06-01 16:58:41.585084"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '785382c0-2bcf-42f6-b696-e8a47decf040' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "785382c0-2bcf-42f6-b696-e8a47decf040"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.588211"], ["updated_at", "2021-06-01 16:58:41.588211"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 137], ["rule_id", 176], ["created_at", "2021-06-01 16:58:41.589034"], ["updated_at", "2021-06-01 16:58:41.589034"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 138], ["rule_id", 176], ["created_at", "2021-06-01 16:58:41.589665"], ["updated_at", "2021-06-01 16:58:41.589665"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#index as HTML
  Parameters: {"prompt_id"=>"137"}
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT DISTINCT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts_rules"."rule_id" = "comprehension_rules"."id" WHERE "comprehension_prompts_rules"."prompt_id" = 137
  [1m[36m (0.2ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 172]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 172]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 172]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 172]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 172]]
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 173]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 173]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 173]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 173]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 173]]
  [1m[36m (0.2ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 176]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 176]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 176]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 176]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 176]]
Completed 200 OK in 9ms (Views: 0.1ms | ActiveRecord: 2.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------
Comprehension::RulesControllerTest: test_: update should return an error if regex is invalid. 
----------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.3ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 38"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 38"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 176 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 38"], ["name", "MyString 38"], ["target_level", 1], ["parent_activity_id", 176], ["created_at", "2021-06-01 16:58:41.609392"], ["updated_at", "2021-06-01 16:58:41.609392"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 179], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.611190"], ["updated_at", "2021-06-01 16:58:41.611190"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 179], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.611190"], ["updated_at", "2021-06-01 16:58:41.611190"], ["id", 139], ["id", 139]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 139
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 179]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f0b3e44a-94ca-4784-84ab-4b2d42e26907' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f0b3e44a-94ca-4784-84ab-4b2d42e26907"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.616737"], ["updated_at", "2021-06-01 16:58:41.616737"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 139], ["rule_id", 177], ["created_at", "2021-06-01 16:58:41.617758"], ["updated_at", "2021-06-01 16:58:41.617758"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 177], ["regex_text", "MyString"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:41.619821"], ["updated_at", "2021-06-01 16:58:41.619821"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::RulesController#update as HTML
  Parameters: {"rule"=>{"regex_rules_attributes"=>[{"id"=>"34", "regex_text"=>"(invalid|"}]}, "id"=>"177"}
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = $1 LIMIT 1  [["uid", "177"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 177]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::RegexRule Load (0.3ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1 AND "comprehension_regex_rules"."id" = 34[0m  [["rule_id", 177]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f0b3e44a-94ca-4784-84ab-4b2d42e26907' AND "comprehension_rules"."id" != 177) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 4ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: update should not update record and return errors as json. 
--------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 39"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 39"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 177 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 39"], ["name", "MyString 39"], ["target_level", 1], ["parent_activity_id", 177], ["created_at", "2021-06-01 16:58:41.646068"], ["updated_at", "2021-06-01 16:58:41.646068"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (2.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '89fae631-0440-42dc-a36f-7ac10e809d9b' LIMIT 1
  [1m[36mSQL (1.8ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 180], ["expires_at", "2021-07-01 16:58:41.648036"], ["uuid", "89fae631-0440-42dc-a36f-7ac10e809d9b"], ["created_at", "2021-06-01 16:58:41.651694"], ["updated_at", "2021-06-01 16:58:41.651694"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#update as HTML
  Parameters: {"turking_round"=>{"activity_id"=>nil, "uuid"=>nil, "expires_at"=>nil}, "id"=>"27"}
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" IS NULL AND "comprehension_turking_rounds"."id" != 27) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 4ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: index with turking_rounds should return successfully. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 40"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 40"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 178 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 40"], ["name", "MyString 40"], ["target_level", 1], ["parent_activity_id", 178], ["created_at", "2021-06-01 16:58:41.668299"], ["updated_at", "2021-06-01 16:58:41.668299"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '1dc295c9-3aa7-4f9e-a45f-8315ac2885b2' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 181], ["expires_at", "2021-07-01 16:58:41.669888"], ["uuid", "1dc295c9-3aa7-4f9e-a45f-8315ac2885b2"], ["created_at", "2021-06-01 16:58:41.671746"], ["updated_at", "2021-06-01 16:58:41.671746"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#index as HTML
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: destroy should destroy record at id. 
----------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 41"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 41"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 179 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 41"], ["name", "MyString 41"], ["target_level", 1], ["parent_activity_id", 179], ["created_at", "2021-06-01 16:58:41.682216"], ["updated_at", "2021-06-01 16:58:41.682216"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'fde34a58-1fcb-43a2-a7df-8152df0bfbd1' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 182], ["expires_at", "2021-07-01 16:58:41.683105"], ["uuid", "fde34a58-1fcb-43a2-a7df-8152df0bfbd1"], ["created_at", "2021-06-01 16:58:41.684134"], ["updated_at", "2021-06-01 16:58:41.684134"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#destroy as HTML
  Parameters: {"id"=>"29"}
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 29]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  DELETE FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1  [["id", 29]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.6ms)
  [1m[35mComprehension::TurkingRound Load (0.2ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 29]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: index should return successfully - no turking_round. 
--------------------------------------------------------------------------------------------------------
Processing by Comprehension::TurkingRoundsController#index as HTML
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds"[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: show should return json if found. 
-------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 42"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 42"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 180 LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 42"], ["name", "MyString 42"], ["target_level", 1], ["parent_activity_id", 180], ["created_at", "2021-06-01 16:58:41.698700"], ["updated_at", "2021-06-01 16:58:41.698700"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'df976213-4adc-424d-a192-5395936c93e6' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 183], ["expires_at", "2021-07-01 16:58:41.700379"], ["uuid", "df976213-4adc-424d-a192-5395936c93e6"], ["created_at", "2021-06-01 16:58:41.702823"], ["updated_at", "2021-06-01 16:58:41.702823"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#show as HTML
  Parameters: {"id"=>"30"}
  [1m[36mComprehension::TurkingRound Load (0.3ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 30]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: create should create a valid record and return it as json. 
--------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 43"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 43"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 181 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 43"], ["name", "MyString 43"], ["target_level", 1], ["parent_activity_id", 181], ["created_at", "2021-06-01 16:58:41.714915"], ["updated_at", "2021-06-01 16:58:41.714915"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#create as HTML
  Parameters: {"turking_round"=>{"activity_id"=>"184", "uuid"=>"65f9003d-04fa-481e-bae7-aa7b295bb31a", "expires_at"=>"2021-07-01T16:58:41.724Z"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '65f9003d-04fa-481e-bae7-aa7b295bb31a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "uuid", "expires_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 184], ["uuid", "65f9003d-04fa-481e-bae7-aa7b295bb31a"], ["expires_at", "2021-07-01 16:58:41.724000"], ["created_at", "2021-06-01 16:58:41.729966"], ["updated_at", "2021-06-01 16:58:41.729966"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 201 Created in 6ms (Views: 3.4ms | ActiveRecord: 0.7ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_turking_rounds"[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: create should not create an invalid record and return errors as json. 
-------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 44"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 44"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 182 LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 44"], ["name", "MyString 44"], ["target_level", 1], ["parent_activity_id", 182], ["created_at", "2021-06-01 16:58:41.741127"], ["updated_at", "2021-06-01 16:58:41.741127"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#create as HTML
  Parameters: {"turking_round"=>{"activity_id"=>nil, "expires_at"=>nil}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '87ae76d7-a2a1-453f-b30e-0de6e1a4578f' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 3ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_turking_rounds"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: show should raise if not found (to be handled by parent app). 
-----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 45"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 45"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 183 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 45"], ["name", "MyString 45"], ["target_level", 1], ["parent_activity_id", 183], ["created_at", "2021-06-01 16:58:41.757470"], ["updated_at", "2021-06-01 16:58:41.757470"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'f42353c6-4b22-4914-ad2b-1e4f075e7f6f' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 186], ["expires_at", "2021-07-01 16:58:41.758518"], ["uuid", "f42353c6-4b22-4914-ad2b-1e4f075e7f6f"], ["created_at", "2021-06-01 16:58:41.759895"], ["updated_at", "2021-06-01 16:58:41.759895"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundsController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::TurkingRound Load (0.3ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundsControllerTest: test_: update should update record if valid, return nothing. 
---------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 46"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 46"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 184 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 46"], ["name", "MyString 46"], ["target_level", 1], ["parent_activity_id", 184], ["created_at", "2021-06-01 16:58:41.770115"], ["updated_at", "2021-06-01 16:58:41.770115"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'd99fff66-a1f5-4d61-ada8-76a49336cf32' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 187], ["expires_at", "2021-07-01 16:58:41.771853"], ["uuid", "d99fff66-a1f5-4d61-ada8-76a49336cf32"], ["created_at", "2021-06-01 16:58:41.773576"], ["updated_at", "2021-06-01 16:58:41.773576"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 47"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 47"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 185 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 47"], ["name", "MyString 47"], ["target_level", 1], ["parent_activity_id", 185], ["created_at", "2021-06-01 16:58:41.778520"], ["updated_at", "2021-06-01 16:58:41.778520"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundsController#update as HTML
  Parameters: {"turking_round"=>{"activity_id"=>"188", "expires_at"=>"2021-06-01T16:58:41+00:00"}, "id"=>"33"}
  [1m[36mComprehension::TurkingRound Load (0.3ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1[0m  [["id", 33]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" = 'd99fff66-a1f5-4d61-ada8-76a49336cf32' AND "comprehension_turking_rounds"."id" != 33) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_turking_rounds" SET "activity_id" = $1, "expires_at" = $2, "updated_at" = $3 WHERE "comprehension_turking_rounds"."id" = $4  [["activity_id", 188], ["expires_at", "2021-06-01 16:58:41.000000"], ["updated_at", "2021-06-01 16:58:41.785670"], ["id", 33]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.0ms)
  [1m[35mComprehension::TurkingRound Load (0.1ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 33]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that :title cannot be empty/falsy. 
---------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 186 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: dependent destroy should destroy dependent passages. 
-----------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 48"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 48"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 187 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 48"], ["name", "MyString 48"], ["target_level", 1], ["parent_activity_id", 187], ["created_at", "2021-06-01 16:58:41.799397"], ["updated_at", "2021-06-01 16:58:41.799397"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (4.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 189], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:41.810315"], ["updated_at", "2021-06-01 16:58:41.810315"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Load (0.2ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1  [["activity_id", 189]]
  [1m[36mComprehension::Passage Load (0.3ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 189]]
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1  [["id", 13]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 189]]
  [1m[35mSQL (0.1ms)[0m  DELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1  [["id", 189]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1 LIMIT 1  [["id", 13]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations parent_activity_id should not be valid if not unique. 
------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.7ms)[0m  INSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"  [["key", "comprehension"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "activities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 188]]
  [1m[36mComprehension::Activity Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 188 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 49"], ["name", "MyString 49"], ["target_level", 1], ["parent_activity_id", 188], ["created_at", "2021-06-01 16:58:41.831685"], ["updated_at", "2021-06-01 16:58:41.831685"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.5ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 188]]
  [1m[36mComprehension::Activity Exists (1.0ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 188 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: create parent activity should set the parent_activity_id if passed in Activity does exist. 
-------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "test name"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 189]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 189 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 51"], ["name", "MyString 51"], ["target_level", 1], ["parent_activity_id", 189], ["created_at", "2021-06-01 16:58:41.845036"], ["updated_at", "2021-06-01 16:58:41.845036"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: create parent activity should create a new LMS activity if the parent_activity_id is not present. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 52"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 52"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 190 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 52"], ["name", "MyString 52"], ["target_level", 1], ["parent_activity_id", 190], ["created_at", "2021-06-01 16:58:41.849493"], ["updated_at", "2021-06-01 16:58:41.849493"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: before_destroy should expire all associated Turking Rounds before destroy. 
---------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 53"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 53"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 191 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 53"], ["name", "MyString 53"], ["target_level", 1], ["parent_activity_id", 191], ["created_at", "2021-06-01 16:58:41.853601"], ["updated_at", "2021-06-01 16:58:41.853601"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '76c3353d-bb03-44e0-b733-1fad86f04c49' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 193], ["expires_at", "2021-07-01 16:58:41.854929"], ["uuid", "76c3353d-bb03-44e0-b733-1fad86f04c49"], ["created_at", "2021-06-01 16:58:41.856326"], ["updated_at", "2021-06-01 16:58:41.856326"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1[0m  [["activity_id", 193]]
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" = '76c3353d-bb03-44e0-b733-1fad86f04c49' AND "comprehension_turking_rounds"."id" != 34) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_turking_rounds" SET "expires_at" = $1, "updated_at" = $2 WHERE "comprehension_turking_rounds"."id" = $3[0m  [["expires_at", "2021-06-01 16:58:41.857890"], ["updated_at", "2021-06-01 16:58:41.858669"], ["id", 34]]
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 193]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 193]]
  [1m[35mSQL (0.1ms)[0m  DELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1  [["id", 193]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Load (0.1ms)[0m  SELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."id" = $1 LIMIT 1  [["id", 34]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: dependent destroy should destroy dependent prompts. 
----------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 54"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 54"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 192 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 54"], ["name", "MyString 54"], ["target_level", 1], ["parent_activity_id", 192], ["created_at", "2021-06-01 16:58:41.865089"], ["updated_at", "2021-06-01 16:58:41.865089"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 194], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.866991"], ["updated_at", "2021-06-01 16:58:41.866991"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 194], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.866991"], ["updated_at", "2021-06-01 16:58:41.866991"], ["id", 140], ["id", 140]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Load (0.4ms)[0m  SELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1  [["activity_id", 194]]
  [1m[36mComprehension::Passage Load (0.2ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 194]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 194]]
  [1m[36mSQL (0.5ms)[0m  [1mDELETE FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1[0m  [["id", 140]]
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1  [["id", 194]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 140]]
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that :target_level looks like an integer greater than or equal to 1 and less than or equal to 12. 
------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 193]]
  [1m[35mComprehension::Activity Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 193 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that :target_level cannot be empty/falsy. 
----------------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.5ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 194 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: associations should have many prompts dependent => destroy. 
------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that :name cannot be empty/falsy. 
--------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.4ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 195 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that the length of :name is between 5 and 100. 
---------------------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.4ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" DEFAULT VALUES RETURNING "id"
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 196 LIMIT 1
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 196]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 196 LIMIT 1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 196]]
  [1m[35mComprehension::Activity Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 196 LIMIT 1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 196]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 196 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: associations should have many passages dependent => destroy. 
-------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that the length of :title is between 5 and 100. 
----------------------------------------------------------------------------------------------------------------
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "xxxx"]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "xxxx"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 197 LIMIT 1
  [1m[36mActivity Load (0.3ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 197]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 197 LIMIT 1
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 197]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 197 LIMIT 1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 197]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 197 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: serializable_hash should fill out hash with all fields. 
--------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.3ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "First Activity"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "First Activity"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 198 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 55"], ["target_level", 8], ["scored_level", "4th grade"], ["parent_activity_id", 198], ["created_at", "2021-06-01 16:58:41.954254"], ["updated_at", "2021-06-01 16:58:41.954254"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 195], ["text", "HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHello"], ["created_at", "2021-06-01 16:58:41.955886"], ["updated_at", "2021-06-01 16:58:41.955886"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 195], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "good work!."], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.957360"], ["updated_at", "2021-06-01 16:58:41.957360"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 195], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "good work!."], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:41.957360"], ["updated_at", "2021-06-01 16:58:41.957360"], ["id", 141], ["id", 141]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 195]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 195]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: create parent activity should set the parent_activity_id to nil if passed in Activity does NOT exist. 
------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 7]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["title", "MyString 55"], ["name", "MyString 56"], ["target_level", 1], ["created_at", "2021-06-01 16:58:41.962973"], ["updated_at", "2021-06-01 16:58:41.962973"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::ActivityTest: test_: validations should validate that the length of :scored_level is at most 100. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.5ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" IS NULL AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "activities" DEFAULT VALUES RETURNING "id"[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Activity Exists (0.9ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 199 LIMIT 1[0m
  [1m[35mActivity Load (0.8ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 199]]
  [1m[36mComprehension::Activity Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 199 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------
Comprehension::LabelTest: test_: relationships should belong to rule. 
----------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should not allow changes to name after creation. 
----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'be0f0060-6718-48b8-ac57-b63c6de30b0d' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "be0f0060-6718-48b8-ac57-b63c6de30b0d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.982473"], ["updated_at", "2021-06-01 16:58:41.982473"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 178 LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.4ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["rule_id", 178]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 178], ["created_at", "2021-06-01 16:58:41.986772"], ["updated_at", "2021-06-01 16:58:41.986772"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 178 AND "comprehension_labels"."id" != 31) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_labels" SET "updated_at" = $1 WHERE "comprehension_labels"."id" = $2[0m  [["updated_at", "2021-06-01 16:58:41.988719"], ["id", 31]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."id" = $1 LIMIT 1[0m  [["id", 31]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should validate that :rule cannot be empty/falsy. 
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '96e5706e-b71e-43f3-9a6b-789141d52bf2' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "96e5706e-b71e-43f3-9a6b-789141d52bf2"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:41.992765"], ["updated_at", "2021-06-01 16:58:41.992765"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 179 LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["rule_id", 179]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 179], ["created_at", "2021-06-01 16:58:41.995813"], ["updated_at", "2021-06-01 16:58:41.995813"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations #name_unique_for_prompt should not allow a label to be created if its name collides with another on the prompt. 
-------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c6fe3144-2cbf-4cc7-9015-4921ce917568' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "c6fe3144-2cbf-4cc7-9015-4921ce917568"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.003933"], ["updated_at", "2021-06-01 16:58:42.003933"]]
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 180 LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.4ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["rule_id", 180]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 180], ["created_at", "2021-06-01 16:58:42.010852"], ["updated_at", "2021-06-01 16:58:42.010852"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 56"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 56"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 200 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 56"], ["name", "MyString 57"], ["target_level", 1], ["parent_activity_id", 200], ["created_at", "2021-06-01 16:58:42.015418"], ["updated_at", "2021-06-01 16:58:42.015418"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 197], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.016928"], ["updated_at", "2021-06-01 16:58:42.016928"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 197], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.016928"], ["updated_at", "2021-06-01 16:58:42.016928"], ["id", 142], ["id", 142]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.4ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 180]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 180], ["prompt_id", 142], ["created_at", "2021-06-01 16:58:42.031245"], ["updated_at", "2021-06-01 16:58:42.031245"]]
  [1m[35mComprehension::Label Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 180 AND "comprehension_labels"."id" != 33) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'c6fe3144-2cbf-4cc7-9015-4921ce917568' AND "comprehension_rules"."id" != 180) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.8ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9b9c05e9-7e18-425b-b252-9e6835860b50' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "9b9c05e9-7e18-425b-b252-9e6835860b50"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.039867"], ["updated_at", "2021-06-01 16:58:42.039867"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 142], ["rule_id", 181], ["created_at", "2021-06-01 16:58:42.041688"], ["updated_at", "2021-06-01 16:58:42.041688"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 181 LIMIT 1
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 142]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 180]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 181]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should validate that :name cannot be empty/falsy. 
-----------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '96d5a23d-5c5c-4ad1-bc11-ee307745160e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "96d5a23d-5c5c-4ad1-bc11-ee307745160e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.049663"], ["updated_at", "2021-06-01 16:58:42.049663"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 182 LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["rule_id", 182]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 182], ["created_at", "2021-06-01 16:58:42.052764"], ["updated_at", "2021-06-01 16:58:42.052764"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::LabelTest: test_: validations should validate that :rule is case-sensitively unique. 
----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '79809ad4-1baf-4a2e-b88b-046681440fa4' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "79809ad4-1baf-4a2e-b88b-046681440fa4"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.058701"], ["updated_at", "2021-06-01 16:58:42.058701"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 183 LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["rule_id", 183]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 183], ["created_at", "2021-06-01 16:58:42.061643"], ["updated_at", "2021-06-01 16:58:42.061643"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Label Load (0.3ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels"  ORDER BY "comprehension_labels"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 183]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 183 LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.5ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["rule_id", 183]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should belong to activity. 
-----------------------------------------------------------------------
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
----------------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should have many automl_models. 
----------------------------------------------------------------------------
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should validate that :conjunction cannot be empty/falsy. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should not duplicate rule assignments if some exist already. 
-------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0608b276-00b3-483b-a3b0-c8ff0aaac118' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "0608b276-00b3-483b-a3b0-c8ff0aaac118"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.083121"], ["updated_at", "2021-06-01 16:58:42.083121"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '0608b276-00b3-483b-a3b0-c8ff0aaac118' AND "comprehension_rules"."id" != 184) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "0608b276-00b3-483b-a3b0-c8ff0aaac118"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.083121"], ["updated_at", "2021-06-01 16:58:42.083121"], ["id", 184], ["id", 184]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e3313000-09c6-475c-b8b6-5cea855bd37a' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "e3313000-09c6-475c-b8b6-5cea855bd37a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.088369"], ["updated_at", "2021-06-01 16:58:42.088369"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'e3313000-09c6-475c-b8b6-5cea855bd37a' AND "comprehension_rules"."id" != 185) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "e3313000-09c6-475c-b8b6-5cea855bd37a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.088369"], ["updated_at", "2021-06-01 16:58:42.088369"], ["id", 185], ["id", 185]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 57"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 57"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 201 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 57"], ["name", "MyString 58"], ["target_level", 1], ["parent_activity_id", 201], ["created_at", "2021-06-01 16:58:42.093749"], ["updated_at", "2021-06-01 16:58:42.093749"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '0608b276-00b3-483b-a3b0-c8ff0aaac118' AND "comprehension_rules"."id" != 184) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 198], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.097124"], ["updated_at", "2021-06-01 16:58:42.097124"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 184], ["prompt_id", 143], ["created_at", "2021-06-01 16:58:42.098209"], ["updated_at", "2021-06-01 16:58:42.098209"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 143], ["rule_id", 185], ["created_at", "2021-06-01 16:58:42.100405"], ["updated_at", "2021-06-01 16:58:42.100405"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 198], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.097124"], ["updated_at", "2021-06-01 16:58:42.097124"], ["id", 143], ["id", 143]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should validate that :max_attempts is either ‹3›, ‹4›, ‹5›, or ‹6›. 
------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should validate that :text cannot be empty/falsy. 
------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should not add non-universal rules. 
------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9b925236-ac78-43cc-8bf4-b9482fbe75fc' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "9b925236-ac78-43cc-8bf4-b9482fbe75fc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.117190"], ["updated_at", "2021-06-01 16:58:42.117190"]]
  [1m[36mComprehension::Prompt Load (0.5ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '9b925236-ac78-43cc-8bf4-b9482fbe75fc' AND "comprehension_rules"."id" != 186) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "9b925236-ac78-43cc-8bf4-b9482fbe75fc"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.117190"], ["updated_at", "2021-06-01 16:58:42.117190"], ["id", 186], ["id", 186]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e81f9510-4b0a-43aa-af58-f950dfc6bb14' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e81f9510-4b0a-43aa-af58-f950dfc6bb14"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.123444"], ["updated_at", "2021-06-01 16:58:42.123444"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 58"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 58"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 202 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 58"], ["name", "MyString 59"], ["target_level", 1], ["parent_activity_id", 202], ["created_at", "2021-06-01 16:58:42.127915"], ["updated_at", "2021-06-01 16:58:42.127915"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 199], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.129328"], ["updated_at", "2021-06-01 16:58:42.129328"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."id" = $2 LIMIT 1[0m  [["prompt_id", 144], ["id", 186]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 144], ["rule_id", 186], ["created_at", "2021-06-01 16:58:42.132535"], ["updated_at", "2021-06-01 16:58:42.132535"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 199], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.129328"], ["updated_at", "2021-06-01 16:58:42.129328"], ["id", 144], ["id", 144]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 144]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should have many rules through prompts_rules. 
------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should validate that the length of :text is between 10 and 255. 
--------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------
Comprehension::PromptTest: test_: relations should have many prompts_rules. 
----------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should validate that :activity cannot be empty/falsy. 
----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: validations should validate that :conjunction is either ‹"because"›, ‹"but"›, or ‹"so"›. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should not remove existing non-universal assignments. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'bdf5e0b9-21c0-49f7-b4bc-01eb470f6bcd' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "bdf5e0b9-21c0-49f7-b4bc-01eb470f6bcd"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.152774"], ["updated_at", "2021-06-01 16:58:42.152774"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'bdf5e0b9-21c0-49f7-b4bc-01eb470f6bcd' AND "comprehension_rules"."id" != 188) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "bdf5e0b9-21c0-49f7-b4bc-01eb470f6bcd"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.152774"], ["updated_at", "2021-06-01 16:58:42.152774"], ["id", 188], ["id", 188]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2cf64d13-1c6d-4a95-9a46-d288cd6cbc4c' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "2cf64d13-1c6d-4a95-9a46-d288cd6cbc4c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.156955"], ["updated_at", "2021-06-01 16:58:42.156955"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 59"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 59"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 203 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 59"], ["name", "MyString 60"], ["target_level", 1], ["parent_activity_id", 203], ["created_at", "2021-06-01 16:58:42.161337"], ["updated_at", "2021-06-01 16:58:42.161337"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '2cf64d13-1c6d-4a95-9a46-d288cd6cbc4c' AND "comprehension_rules"."id" != 189) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 200], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.164774"], ["updated_at", "2021-06-01 16:58:42.164774"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 189], ["prompt_id", 145], ["created_at", "2021-06-01 16:58:42.165852"], ["updated_at", "2021-06-01 16:58:42.165852"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 145], ["rule_id", 188], ["created_at", "2021-06-01 16:58:42.169490"], ["updated_at", "2021-06-01 16:58:42.169490"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 200], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.164774"], ["updated_at", "2021-06-01 16:58:42.164774"], ["id", 145], ["id", 145]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------
Comprehension::PromptTest: test_: #after_create #assign_universal_rules should assign all universal rules to new prompts. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7a64584e-4d6d-485a-a68c-8ab4c08d8b17' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "7a64584e-4d6d-485a-a68c-8ab4c08d8b17"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.176424"], ["updated_at", "2021-06-01 16:58:42.176424"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '7a64584e-4d6d-485a-a68c-8ab4c08d8b17' AND "comprehension_rules"."id" != 190) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "7a64584e-4d6d-485a-a68c-8ab4c08d8b17"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.176424"], ["updated_at", "2021-06-01 16:58:42.176424"], ["id", 190], ["id", 190]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '18f59900-dd67-491d-941e-4b469b71698a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "18f59900-dd67-491d-941e-4b469b71698a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.180633"], ["updated_at", "2021-06-01 16:58:42.180633"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '18f59900-dd67-491d-941e-4b469b71698a' AND "comprehension_rules"."id" != 191) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "18f59900-dd67-491d-941e-4b469b71698a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.180633"], ["updated_at", "2021-06-01 16:58:42.180633"], ["id", 191], ["id", 191]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 60"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 60"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 204 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 60"], ["name", "MyString 61"], ["target_level", 1], ["parent_activity_id", 204], ["created_at", "2021-06-01 16:58:42.186014"], ["updated_at", "2021-06-01 16:58:42.186014"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 201], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.187467"], ["updated_at", "2021-06-01 16:58:42.187467"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."id" = $2 LIMIT 1  [["prompt_id", 146], ["id", 190]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 146], ["rule_id", 190], ["created_at", "2021-06-01 16:58:42.189845"], ["updated_at", "2021-06-01 16:58:42.189845"]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."id" = $2 LIMIT 1  [["prompt_id", 146], ["id", 191]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 146], ["rule_id", 191], ["created_at", "2021-06-01 16:58:42.191398"], ["updated_at", "2021-06-01 16:58:42.191398"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 201], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.187467"], ["updated_at", "2021-06-01 16:58:42.187467"], ["id", 146], ["id", 146]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 146]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #automl should return 404 if prompt has no associated automl_model. 
------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.4ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.5ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 61"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 61"]]
  [1m[36mComprehension::Activity Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 205 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 61"], ["name", "MyString 62"], ["target_level", 1], ["parent_activity_id", 205], ["created_at", "2021-06-01 16:58:42.211826"], ["updated_at", "2021-06-01 16:58:42.211826"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 202], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.214233"], ["updated_at", "2021-06-01 16:58:42.214233"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 202], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.214233"], ["updated_at", "2021-06-01 16:58:42.214233"], ["id", 147], ["id", 147]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6c912aff-c78e-4623-a260-5c3475f9a7a4' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "6c912aff-c78e-4623-a260-5c3475f9a7a4"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.219359"], ["updated_at", "2021-06-01 16:58:42.219359"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c80122a7-d132-4c3e-8e89-9527867dc5cf' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "c80122a7-d132-4c3e-8e89-9527867dc5cf"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.221713"], ["updated_at", "2021-06-01 16:58:42.221713"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 193], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.223385"], ["updated_at", "2021-06-01 16:58:42.223385"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 147], ["rule_id", 192], ["created_at", "2021-06-01 16:58:42.225010"], ["updated_at", "2021-06-01 16:58:42.225010"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 147], ["rule_id", 193], ["created_at", "2021-06-01 16:58:42.226272"], ["updated_at", "2021-06-01 16:58:42.226272"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 192], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.227589"], ["updated_at", "2021-06-01 16:58:42.227589"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 192) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 192], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.229805"], ["updated_at", "2021-06-01 16:58:42.229805"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 192) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 192], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.232103"], ["updated_at", "2021-06-01 16:58:42.232103"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#automl as HTML
  Parameters: {"entry"=>"some text", "prompt_id"=>"147", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 147]]
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 147], ["state", "active"]]
  Rendered text template (0.0ms)
Completed 404 Not Found in 15ms (Views: 11.0ms | ActiveRecord: 0.5ms)
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return successfully when there is regex feedback. 
-------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 62"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 62"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 206 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 62"], ["name", "MyString 63"], ["target_level", 1], ["parent_activity_id", 206], ["created_at", "2021-06-01 16:58:42.258122"], ["updated_at", "2021-06-01 16:58:42.258122"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 203], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.259628"], ["updated_at", "2021-06-01 16:58:42.259628"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 203], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.259628"], ["updated_at", "2021-06-01 16:58:42.259628"], ["id", 148], ["id", 148]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7e7d84a6-facb-44f2-bb9e-7258a566bba7' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "7e7d84a6-facb-44f2-bb9e-7258a566bba7"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.263026"], ["updated_at", "2021-06-01 16:58:42.263026"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0cbafb91-668f-409e-b527-17a310b8ca6b' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "0cbafb91-668f-409e-b527-17a310b8ca6b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.265418"], ["updated_at", "2021-06-01 16:58:42.265418"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 195], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.267863"], ["updated_at", "2021-06-01 16:58:42.267863"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 148], ["rule_id", 194], ["created_at", "2021-06-01 16:58:42.271272"], ["updated_at", "2021-06-01 16:58:42.271272"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 148], ["rule_id", 195], ["created_at", "2021-06-01 16:58:42.273127"], ["updated_at", "2021-06-01 16:58:42.273127"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 194], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.274479"], ["updated_at", "2021-06-01 16:58:42.274479"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 194) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 194], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.276907"], ["updated_at", "2021-06-01 16:58:42.276907"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 194) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 194], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.279591"], ["updated_at", "2021-06-01 16:58:42.279591"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"test regex response", "prompt_id"=>"148", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"rules-based-1"}
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 148]]
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 148], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 195]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1  [["rule_id", 195]]
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 1.1ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: plagiarism should return successfully when there is plagiarism. 
--------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 63"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 63"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 207 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 63"], ["name", "MyString 64"], ["target_level", 1], ["parent_activity_id", 207], ["created_at", "2021-06-01 16:58:42.302018"], ["updated_at", "2021-06-01 16:58:42.302018"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 204], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.304941"], ["updated_at", "2021-06-01 16:58:42.304941"]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 204], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.304941"], ["updated_at", "2021-06-01 16:58:42.304941"], ["id", 149], ["id", 149]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a1247fdf-7167-446d-814e-7a63402a0cd8' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "a1247fdf-7167-446d-814e-7a63402a0cd8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.310430"], ["updated_at", "2021-06-01 16:58:42.310430"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'af643310-5c1f-4887-a98b-398840c94c13' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "af643310-5c1f-4887-a98b-398840c94c13"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.312586"], ["updated_at", "2021-06-01 16:58:42.312586"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 197], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.314219"], ["updated_at", "2021-06-01 16:58:42.314219"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 149], ["rule_id", 196], ["created_at", "2021-06-01 16:58:42.315559"], ["updated_at", "2021-06-01 16:58:42.315559"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 149], ["rule_id", 197], ["created_at", "2021-06-01 16:58:42.316692"], ["updated_at", "2021-06-01 16:58:42.316692"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 196], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.317855"], ["updated_at", "2021-06-01 16:58:42.317855"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 196) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 196], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.320004"], ["updated_at", "2021-06-01 16:58:42.320004"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 196) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 196], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.321878"], ["updated_at", "2021-06-01 16:58:42.321878"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"bla bla bla do not plagiarize this text please there will be consequences", "prompt_id"=>"149", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 149]]
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["prompt_id", 149], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 196]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["prompt_id", 149], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."order" = $2 LIMIT 1[0m  [["rule_id", 196], ["order", 0]]
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 1.3ms)
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"bla bla bla do not plagiarize this text please there will be consequences", "prompt_id"=>"149", "session_id"=>"1", "previous_feedback"=>[{"feedback"=>"here is our first feedback", "feedback_type"=>"plagiarism", "optimal"=>false, "response_id"=>"", "entry"=>"bla bla bla do not plagiarize this text please there will be consequences", "concept_uid"=>"ConceptUID", "rule_uid"=>"a1247fdf-7167-446d-814e-7a63402a0cd8", "highlight"=>[{"type"=>"response", "text"=>"do not plagiarize this text please there will be consequences", "category"=>""}, {"type"=>"passage", "text"=>"do not plagiarize this text please there will be consequences", "category"=>""}]}]}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 149]]
  [1m[36mComprehension::Rule Load (1.0ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["prompt_id", 149], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::PlagiarismText Load (0.4ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 196]]
  [1m[36mComprehension::Rule Load (0.8ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["prompt_id", 149], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Feedback Load (0.4ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."order" = $2 LIMIT 1  [["rule_id", 196], ["order", 1]]
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 4.2ms)
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: plagiarism should return successfully. 
-------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 64"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 64"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 208 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 64"], ["name", "MyString 65"], ["target_level", 1], ["parent_activity_id", 208], ["created_at", "2021-06-01 16:58:42.348595"], ["updated_at", "2021-06-01 16:58:42.348595"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 205], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.349913"], ["updated_at", "2021-06-01 16:58:42.349913"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 205], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.349913"], ["updated_at", "2021-06-01 16:58:42.349913"], ["id", 150], ["id", 150]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fad70939-5247-40ff-b01b-b81c10597ef7' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "fad70939-5247-40ff-b01b-b81c10597ef7"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.353526"], ["updated_at", "2021-06-01 16:58:42.353526"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6b77513a-f9ea-45d9-ba25-b153127f6fc8' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "6b77513a-f9ea-45d9-ba25-b153127f6fc8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.355661"], ["updated_at", "2021-06-01 16:58:42.355661"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 199], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.357251"], ["updated_at", "2021-06-01 16:58:42.357251"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 150], ["rule_id", 198], ["created_at", "2021-06-01 16:58:42.358652"], ["updated_at", "2021-06-01 16:58:42.358652"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 150], ["rule_id", 199], ["created_at", "2021-06-01 16:58:42.359744"], ["updated_at", "2021-06-01 16:58:42.359744"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 198], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.360874"], ["updated_at", "2021-06-01 16:58:42.360874"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 198) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 198], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.362885"], ["updated_at", "2021-06-01 16:58:42.362885"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 198) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 198], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.364974"], ["updated_at", "2021-06-01 16:58:42.364974"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"No plagiarism here.", "prompt_id"=>"150", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.5ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 150]]
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["prompt_id", 150], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::PlagiarismText Load (0.2ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 198]]
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["prompt_id", 150], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND "comprehension_feedbacks"."order" = $2 LIMIT 1[0m  [["rule_id", 198], ["order", 0]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["optimal", "t"], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["optimal", "t"], ["rule_type", "plagiarism"]]
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 2.5ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: plagiarism should return 404 if prompt id does not exist. 
--------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.3ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 65"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 65"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 209 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 65"], ["name", "MyString 66"], ["target_level", 1], ["parent_activity_id", 209], ["created_at", "2021-06-01 16:58:42.386744"], ["updated_at", "2021-06-01 16:58:42.386744"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 206], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.388619"], ["updated_at", "2021-06-01 16:58:42.388619"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 206], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.388619"], ["updated_at", "2021-06-01 16:58:42.388619"], ["id", 151], ["id", 151]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f5e5a816-6b21-48f1-88fc-8cbe81c24e4a' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f5e5a816-6b21-48f1-88fc-8cbe81c24e4a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.392168"], ["updated_at", "2021-06-01 16:58:42.392168"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '984228a2-603f-4815-aed5-adb4fa1839aa' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "984228a2-603f-4815-aed5-adb4fa1839aa"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.394325"], ["updated_at", "2021-06-01 16:58:42.394325"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 201], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.395896"], ["updated_at", "2021-06-01 16:58:42.395896"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 151], ["rule_id", 200], ["created_at", "2021-06-01 16:58:42.397345"], ["updated_at", "2021-06-01 16:58:42.397345"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 151], ["rule_id", 201], ["created_at", "2021-06-01 16:58:42.398585"], ["updated_at", "2021-06-01 16:58:42.398585"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 200], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.400393"], ["updated_at", "2021-06-01 16:58:42.400393"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 200) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 200], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.404319"], ["updated_at", "2021-06-01 16:58:42.404319"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 200) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 200], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.408759"], ["updated_at", "2021-06-01 16:58:42.408759"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#plagiarism as HTML
  Parameters: {"entry"=>"No plagiarism here.", "prompt_id"=>"100", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 100]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #spelling should return 500 if there is an error on the bing API. 
----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 66"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 66"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 210 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 66"], ["name", "MyString 67"], ["target_level", 1], ["parent_activity_id", 210], ["created_at", "2021-06-01 16:58:42.419008"], ["updated_at", "2021-06-01 16:58:42.419008"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 207], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.420292"], ["updated_at", "2021-06-01 16:58:42.420292"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 207], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.420292"], ["updated_at", "2021-06-01 16:58:42.420292"], ["id", 152], ["id", 152]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2db45cd5-fb5a-4e13-ab6e-b21363637c79' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "2db45cd5-fb5a-4e13-ab6e-b21363637c79"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.424559"], ["updated_at", "2021-06-01 16:58:42.424559"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '125b8f70-e643-4ace-b7a5-701a4986f9f9' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "125b8f70-e643-4ace-b7a5-701a4986f9f9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.426925"], ["updated_at", "2021-06-01 16:58:42.426925"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 203], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.428777"], ["updated_at", "2021-06-01 16:58:42.428777"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 152], ["rule_id", 202], ["created_at", "2021-06-01 16:58:42.430222"], ["updated_at", "2021-06-01 16:58:42.430222"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 152], ["rule_id", 203], ["created_at", "2021-06-01 16:58:42.431437"], ["updated_at", "2021-06-01 16:58:42.431437"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 202], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.432510"], ["updated_at", "2021-06-01 16:58:42.432510"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 202) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 202], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.436175"], ["updated_at", "2021-06-01 16:58:42.436175"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 202) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 202], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.441195"], ["updated_at", "2021-06-01 16:58:42.441195"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#spelling as HTML
  Parameters: {"entry"=>"there is no spelling error here", "prompt_id"=>"152", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 152]]
  Rendered text template (0.0ms)
Completed 500 Internal Server Error in 13ms (Views: 0.3ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #spelling should return correct spelling feedback when endpoint returns 200. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 67"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 67"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 211 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 67"], ["name", "MyString 68"], ["target_level", 1], ["parent_activity_id", 211], ["created_at", "2021-06-01 16:58:42.464831"], ["updated_at", "2021-06-01 16:58:42.464831"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 208], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.467108"], ["updated_at", "2021-06-01 16:58:42.467108"]]
  [1m[36mComprehension::Rule Load (0.7ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 208], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.467108"], ["updated_at", "2021-06-01 16:58:42.467108"], ["id", 153], ["id", 153]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cb2a371f-4c55-4622-8143-e0f0574daa02' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "cb2a371f-4c55-4622-8143-e0f0574daa02"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.475442"], ["updated_at", "2021-06-01 16:58:42.475442"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fa020baa-e031-4845-969b-c39e5fedf3bd' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "fa020baa-e031-4845-969b-c39e5fedf3bd"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.477622"], ["updated_at", "2021-06-01 16:58:42.477622"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 205], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.479099"], ["updated_at", "2021-06-01 16:58:42.479099"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 153], ["rule_id", 204], ["created_at", "2021-06-01 16:58:42.480429"], ["updated_at", "2021-06-01 16:58:42.480429"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 153], ["rule_id", 205], ["created_at", "2021-06-01 16:58:42.481592"], ["updated_at", "2021-06-01 16:58:42.481592"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 204], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.482789"], ["updated_at", "2021-06-01 16:58:42.482789"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 204) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 204], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.484796"], ["updated_at", "2021-06-01 16:58:42.484796"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 204) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 204], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.486748"], ["updated_at", "2021-06-01 16:58:42.486748"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#spelling as HTML
  Parameters: {"entry"=>"test spelin error", "prompt_id"=>"153", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 153]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["rule_type", "spelling"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["rule_type", "spelling"]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return 404 if prompt id does not exist. 
---------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 68"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 68"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 212 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 68"], ["name", "MyString 69"], ["target_level", 1], ["parent_activity_id", 212], ["created_at", "2021-06-01 16:58:42.498864"], ["updated_at", "2021-06-01 16:58:42.498864"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 209], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.500555"], ["updated_at", "2021-06-01 16:58:42.500555"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 209], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.500555"], ["updated_at", "2021-06-01 16:58:42.500555"], ["id", 154], ["id", 154]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.7ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fd7003eb-6cd2-4304-bc81-e088ce9b65d9' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "fd7003eb-6cd2-4304-bc81-e088ce9b65d9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.508590"], ["updated_at", "2021-06-01 16:58:42.508590"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9a469d37-c56d-44ea-9233-2fa3bdca76c9' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "9a469d37-c56d-44ea-9233-2fa3bdca76c9"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.512831"], ["updated_at", "2021-06-01 16:58:42.512831"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 207], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.514930"], ["updated_at", "2021-06-01 16:58:42.514930"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 154], ["rule_id", 206], ["created_at", "2021-06-01 16:58:42.516570"], ["updated_at", "2021-06-01 16:58:42.516570"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 154], ["rule_id", 207], ["created_at", "2021-06-01 16:58:42.518062"], ["updated_at", "2021-06-01 16:58:42.518062"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 206], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.519461"], ["updated_at", "2021-06-01 16:58:42.519461"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 206) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 206], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.521590"], ["updated_at", "2021-06-01 16:58:42.521590"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 206) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 206], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.523511"], ["updated_at", "2021-06-01 16:58:42.523511"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"no regex problems here.", "prompt_id"=>"100", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"rules-based-1"}
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 100]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #automl should return 404 if prompt id does not exist. 
-----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 69"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 69"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 213 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 69"], ["name", "MyString 70"], ["target_level", 1], ["parent_activity_id", 213], ["created_at", "2021-06-01 16:58:42.531867"], ["updated_at", "2021-06-01 16:58:42.531867"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 210], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.533466"], ["updated_at", "2021-06-01 16:58:42.533466"]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 210], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.533466"], ["updated_at", "2021-06-01 16:58:42.533466"], ["id", 155], ["id", 155]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8faf6f41-8e88-4c0c-a86a-b93be02ac997' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "8faf6f41-8e88-4c0c-a86a-b93be02ac997"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.539544"], ["updated_at", "2021-06-01 16:58:42.539544"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b692ac02-eedc-4aea-a992-e9e570e62238' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b692ac02-eedc-4aea-a992-e9e570e62238"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.542409"], ["updated_at", "2021-06-01 16:58:42.542409"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 209], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.544668"], ["updated_at", "2021-06-01 16:58:42.544668"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 155], ["rule_id", 208], ["created_at", "2021-06-01 16:58:42.546095"], ["updated_at", "2021-06-01 16:58:42.546095"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 155], ["rule_id", 209], ["created_at", "2021-06-01 16:58:42.547305"], ["updated_at", "2021-06-01 16:58:42.547305"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 208], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.548442"], ["updated_at", "2021-06-01 16:58:42.548442"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 208) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 208], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.550445"], ["updated_at", "2021-06-01 16:58:42.550445"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 208) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 208], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.562383"], ["updated_at", "2021-06-01 16:58:42.562383"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#automl as HTML
  Parameters: {"entry"=>"some text", "prompt_id"=>"1155", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 1155]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.4ms | ActiveRecord: 0.3ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: #automl should return feedback payloads based on the lib matched_rule value. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 70"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 70"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 214 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 70"], ["name", "MyString 71"], ["target_level", 1], ["parent_activity_id", 214], ["created_at", "2021-06-01 16:58:42.575315"], ["updated_at", "2021-06-01 16:58:42.575315"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 211], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.577743"], ["updated_at", "2021-06-01 16:58:42.577743"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 211], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.577743"], ["updated_at", "2021-06-01 16:58:42.577743"], ["id", 156], ["id", 156]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '8ea2b405-79eb-416b-9c6f-3c510b229325' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "8ea2b405-79eb-416b-9c6f-3c510b229325"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.581682"], ["updated_at", "2021-06-01 16:58:42.581682"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '267805fd-e99b-40a5-9573-2ba38e4c27da' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "267805fd-e99b-40a5-9573-2ba38e4c27da"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.584951"], ["updated_at", "2021-06-01 16:58:42.584951"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 211], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.587395"], ["updated_at", "2021-06-01 16:58:42.587395"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 156], ["rule_id", 210], ["created_at", "2021-06-01 16:58:42.588737"], ["updated_at", "2021-06-01 16:58:42.588737"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 156], ["rule_id", 211], ["created_at", "2021-06-01 16:58:42.589855"], ["updated_at", "2021-06-01 16:58:42.589855"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 210], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.591155"], ["updated_at", "2021-06-01 16:58:42.591155"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 210) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 210], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.593141"], ["updated_at", "2021-06-01 16:58:42.593141"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 210) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 210], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.594985"], ["updated_at", "2021-06-01 16:58:42.594985"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#automl as HTML
  Parameters: {"entry"=>"entry", "prompt_id"=>"156", "session_id"=>"1", "previous_feedback"=>[]}
  [1m[36mComprehension::Prompt Load (0.6ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 156]]
  [1m[35mComprehension::AutomlModel Load (0.6ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 156], ["state", "active"]]
  [1m[36mComprehension::Highlight Load (0.5ms)[0m  [1mSELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1[0m  [["feedback_id", 73]]
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.7ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return 404 if rule_type does not exist. 
---------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 71"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 71"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 215 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 71"], ["name", "MyString 72"], ["target_level", 1], ["parent_activity_id", 215], ["created_at", "2021-06-01 16:58:42.610685"], ["updated_at", "2021-06-01 16:58:42.610685"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 212], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.612003"], ["updated_at", "2021-06-01 16:58:42.612003"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 212], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.612003"], ["updated_at", "2021-06-01 16:58:42.612003"], ["id", 157], ["id", 157]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6a6cf0b6-cb7c-4686-9aa8-aa8e58e791aa' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "6a6cf0b6-cb7c-4686-9aa8-aa8e58e791aa"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.615654"], ["updated_at", "2021-06-01 16:58:42.615654"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '32e1b5e2-3bf3-4013-a04a-a0f8567af723' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "32e1b5e2-3bf3-4013-a04a-a0f8567af723"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.617779"], ["updated_at", "2021-06-01 16:58:42.617779"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 213], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.619504"], ["updated_at", "2021-06-01 16:58:42.619504"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 157], ["rule_id", 212], ["created_at", "2021-06-01 16:58:42.620781"], ["updated_at", "2021-06-01 16:58:42.620781"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 157], ["rule_id", 213], ["created_at", "2021-06-01 16:58:42.621904"], ["updated_at", "2021-06-01 16:58:42.621904"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 212], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.623051"], ["updated_at", "2021-06-01 16:58:42.623051"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 212) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 212], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.625080"], ["updated_at", "2021-06-01 16:58:42.625080"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 212) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 212], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.626926"], ["updated_at", "2021-06-01 16:58:42.626926"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"no regex problems here.", "prompt_id"=>"100", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"not-rule-type"}
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1  [["id", 100]]
  Rendered text template (0.0ms)
Filter chain halted as :set_params rendered or redirected
Completed 404 Not Found in 1ms (Views: 0.2ms | ActiveRecord: 0.2ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------
Comprehension::FeedbackControllerTest: test_: regex should return successfully. 
--------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 72"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 72"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 216 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 72"], ["name", "MyString 73"], ["target_level", 1], ["parent_activity_id", 216], ["created_at", "2021-06-01 16:58:42.637893"], ["updated_at", "2021-06-01 16:58:42.637893"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 213], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.639835"], ["updated_at", "2021-06-01 16:58:42.639835"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 213], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.639835"], ["updated_at", "2021-06-01 16:58:42.639835"], ["id", 158], ["id", 158]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fdd62375-abe1-4874-bf0a-61d2b09e266b' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "fdd62375-abe1-4874-bf0a-61d2b09e266b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.644816"], ["updated_at", "2021-06-01 16:58:42.644816"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '95d1913e-4970-4000-ae95-898437349fb1' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "95d1913e-4970-4000-ae95-898437349fb1"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.647323"], ["updated_at", "2021-06-01 16:58:42.647323"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 215], ["regex_text", "^test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.649101"], ["updated_at", "2021-06-01 16:58:42.649101"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 158], ["rule_id", 214], ["created_at", "2021-06-01 16:58:42.650758"], ["updated_at", "2021-06-01 16:58:42.650758"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 158], ["rule_id", 215], ["created_at", "2021-06-01 16:58:42.652147"], ["updated_at", "2021-06-01 16:58:42.652147"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 214], ["text", "do not plagiarize this text please there will be consequences"], ["created_at", "2021-06-01 16:58:42.653441"], ["updated_at", "2021-06-01 16:58:42.653441"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 214) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 214], ["text", "here is our first feedback"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.655496"], ["updated_at", "2021-06-01 16:58:42.655496"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 214) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 214], ["text", "here is our second feedback"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.657324"], ["updated_at", "2021-06-01 16:58:42.657324"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::FeedbackController#regex as HTML
  Parameters: {"entry"=>"no regex problems here.", "prompt_id"=>"158", "session_id"=>"1", "previous_feedback"=>[], "rule_type"=>"rules-based-1"}
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 158]]
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 158], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 215]]
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 158], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.2ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 215]]
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 158], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.3ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 215]]
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 158], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.2ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 215]]
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 2.8ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should include highlight data when the feedback object has highlights. 
-------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 73"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 73"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 217 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 73"], ["name", "MyString 74"], ["target_level", 1], ["parent_activity_id", 217], ["created_at", "2021-06-01 16:58:42.676378"], ["updated_at", "2021-06-01 16:58:42.676378"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 214], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.677950"], ["updated_at", "2021-06-01 16:58:42.677950"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 214], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.677950"], ["updated_at", "2021-06-01 16:58:42.677950"], ["id", 159], ["id", 159]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '66b906a1-6089-4778-a718-c64799b43c4c' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "66b906a1-6089-4778-a718-c64799b43c4c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.681881"], ["updated_at", "2021-06-01 16:58:42.681881"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 159], ["rule_id", 216], ["created_at", "2021-06-01 16:58:42.682776"], ["updated_at", "2021-06-01 16:58:42.682776"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 216 LIMIT 1
  [1m[36mComprehension::Rule Load (0.7ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 159]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 216]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 216], ["created_at", "2021-06-01 16:58:42.687599"], ["updated_at", "2021-06-01 16:58:42.687599"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 11 AND "comprehension_feedbacks"."rule_id" = 216) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 216], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 11], ["created_at", "2021-06-01 16:58:42.690137"], ["updated_at", "2021-06-01 16:58:42.690137"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 159], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 216]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-12' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-12"], ["name", "AutoML-Model-Name"], ["prompt_id", 159], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-06-01 16:58:42.694230"], ["updated_at", "2021-06-01 16:58:42.694230"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_highlights" ("feedback_id", "text", "highlight_type", "starting_index", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["feedback_id", 79], ["text", "Highlight me"], ["highlight_type", "passage"], ["starting_index", 0], ["created_at", "2021-06-01 16:58:42.695869"], ["updated_at", "2021-06-01 16:58:42.695869"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 159], ["state", "active"]]
  [1m[36mComprehension::Rule Load (0.7ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_labels" ON "comprehension_labels"."rule_id" = "comprehension_rules"."id" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_labels"."name" = 'some label name' LIMIT 1[0m  [["prompt_id", 159]]
  [1m[35mComprehension::Feedback Load (0.3ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND (1=1)  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1  [["rule_id", 216]]
  [1m[36mComprehension::Highlight Load (0.2ms)[0m  [1mSELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1[0m  [["feedback_id", 79]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should return nil if there is no automl_model associated with the provided prompt. 
-------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.3ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 74"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 74"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 218 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 74"], ["name", "MyString 75"], ["target_level", 1], ["parent_activity_id", 218], ["created_at", "2021-06-01 16:58:42.707727"], ["updated_at", "2021-06-01 16:58:42.707727"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 215], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.709443"], ["updated_at", "2021-06-01 16:58:42.709443"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 215], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.709443"], ["updated_at", "2021-06-01 16:58:42.709443"], ["id", 160], ["id", 160]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0163f2b6-02df-4a36-870d-a9ac93ce694c' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "0163f2b6-02df-4a36-870d-a9ac93ce694c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.714426"], ["updated_at", "2021-06-01 16:58:42.714426"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 160], ["rule_id", 217], ["created_at", "2021-06-01 16:58:42.715320"], ["updated_at", "2021-06-01 16:58:42.715320"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 217 LIMIT 1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 160]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 217]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 217], ["created_at", "2021-06-01 16:58:42.718729"], ["updated_at", "2021-06-01 16:58:42.718729"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 12 AND "comprehension_feedbacks"."rule_id" = 217) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 217], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 12], ["created_at", "2021-06-01 16:58:42.720675"], ["updated_at", "2021-06-01 16:58:42.720675"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 160], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 217]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-13' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-13"], ["name", "AutoML-Model-Name"], ["prompt_id", 160], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-06-01 16:58:42.724058"], ["updated_at", "2021-06-01 16:58:42.724058"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1  [["id", 50]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 160], ["state", "active"]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should return nil if there is no matched rule. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 75"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 75"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 219 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 75"], ["name", "MyString 76"], ["target_level", 1], ["parent_activity_id", 219], ["created_at", "2021-06-01 16:58:42.730180"], ["updated_at", "2021-06-01 16:58:42.730180"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 216], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.732056"], ["updated_at", "2021-06-01 16:58:42.732056"]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 216], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.732056"], ["updated_at", "2021-06-01 16:58:42.732056"], ["id", 161], ["id", 161]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '85758f4c-05d4-4a50-aab9-6b5076377121' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "85758f4c-05d4-4a50-aab9-6b5076377121"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.740295"], ["updated_at", "2021-06-01 16:58:42.740295"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 161], ["rule_id", 218], ["created_at", "2021-06-01 16:58:42.741453"], ["updated_at", "2021-06-01 16:58:42.741453"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 218 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 161]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 218]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "some label name"], ["rule_id", 218], ["created_at", "2021-06-01 16:58:42.744761"], ["updated_at", "2021-06-01 16:58:42.744761"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 13 AND "comprehension_feedbacks"."rule_id" = 218) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 218], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 13], ["created_at", "2021-06-01 16:58:42.746740"], ["updated_at", "2021-06-01 16:58:42.746740"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 161], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 218]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-14' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-14"], ["name", "AutoML-Model-Name"], ["prompt_id", 161], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-06-01 16:58:42.750029"], ["updated_at", "2021-06-01 16:58:42.750029"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.2ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1  [["prompt_id", 161], ["state", "active"]]
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_labels" ON "comprehension_labels"."rule_id" = "comprehension_rules"."id" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_labels"."name" = 'NOTsome label name' LIMIT 1[0m  [["prompt_id", 161]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #initialize should should have working accessor methods for all initialized fields. 
---------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 76"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 76"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 220 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 76"], ["name", "MyString 77"], ["target_level", 1], ["parent_activity_id", 220], ["created_at", "2021-06-01 16:58:42.756004"], ["updated_at", "2021-06-01 16:58:42.756004"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 217], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.757244"], ["updated_at", "2021-06-01 16:58:42.757244"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 217], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.757244"], ["updated_at", "2021-06-01 16:58:42.757244"], ["id", 162], ["id", 162]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'bf474e99-99af-4f2a-8357-7ff5f58d4bee' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "bf474e99-99af-4f2a-8357-7ff5f58d4bee"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.761245"], ["updated_at", "2021-06-01 16:58:42.761245"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 162], ["rule_id", 219], ["created_at", "2021-06-01 16:58:42.762238"], ["updated_at", "2021-06-01 16:58:42.762238"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 219 LIMIT 1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 162]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 219]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 219], ["created_at", "2021-06-01 16:58:42.765802"], ["updated_at", "2021-06-01 16:58:42.765802"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.7ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 14 AND "comprehension_feedbacks"."rule_id" = 219) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 219], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 14], ["created_at", "2021-06-01 16:58:42.771086"], ["updated_at", "2021-06-01 16:58:42.771086"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.7ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 162], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 219]]
  [1m[35mComprehension::AutomlModel Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-15' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-15"], ["name", "AutoML-Model-Name"], ["prompt_id", 162], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-06-01 16:58:42.779030"], ["updated_at", "2021-06-01 16:58:42.779030"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m  [["prompt_id", 162], ["state", "active"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlCheckTest: test_: #feedback_object should return the feedback payload when there is a label match. 
------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 77"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 77"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 221 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 77"], ["name", "MyString 78"], ["target_level", 1], ["parent_activity_id", 221], ["created_at", "2021-06-01 16:58:42.784452"], ["updated_at", "2021-06-01 16:58:42.784452"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 218], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.785845"], ["updated_at", "2021-06-01 16:58:42.785845"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 218], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.785845"], ["updated_at", "2021-06-01 16:58:42.785845"], ["id", 163], ["id", 163]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ac06721b-2bbc-43c6-baa1-2edc0329b21d' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "ac06721b-2bbc-43c6-baa1-2edc0329b21d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.789877"], ["updated_at", "2021-06-01 16:58:42.789877"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 163], ["rule_id", 220], ["created_at", "2021-06-01 16:58:42.790741"], ["updated_at", "2021-06-01 16:58:42.790741"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 220 LIMIT 1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 163]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 220]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "some label name"], ["rule_id", 220], ["created_at", "2021-06-01 16:58:42.793899"], ["updated_at", "2021-06-01 16:58:42.793899"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 15 AND "comprehension_feedbacks"."rule_id" = 220) LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 220], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 15], ["created_at", "2021-06-01 16:58:42.795854"], ["updated_at", "2021-06-01 16:58:42.795854"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 163], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 220]]
  [1m[35mComprehension::AutomlModel Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-16' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-16"], ["name", "AutoML-Model-Name"], ["prompt_id", 163], ["state", "active"], ["labels", "{\"some label name\"}"], ["created_at", "2021-06-01 16:58:42.800869"], ["updated_at", "2021-06-01 16:58:42.800869"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.2ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND "comprehension_automl_models"."state" = $2  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m  [["prompt_id", 163], ["state", "active"]]
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_labels" ON "comprehension_labels"."rule_id" = "comprehension_rules"."id" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_labels"."name" = 'some label name' LIMIT 1  [["prompt_id", 163]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND (1=1)  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1[0m  [["rule_id", 220]]
  [1m[35mComprehension::Highlight Load (0.1ms)[0m  SELECT "comprehension_highlights".* FROM "comprehension_highlights" WHERE "comprehension_highlights"."feedback_id" = $1  [["feedback_id", 83]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #non_optimal_feedback_string should use the fallback feedback if there is no spelling Rule with feedback. 
---------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["rule_type", "spelling"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #feedback_object should return appropriate feedback attributes if there is a spelling error. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["rule_type", "spelling"]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["rule_type", "spelling"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #non_optimal_feedback_string should use the feedback from the spelling rule if it is available. 
-----------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9e4954d3-d466-4010-9d58-e7436c75f4cb' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "9e4954d3-d466-4010-9d58-e7436c75f4cb"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "spelling"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.822247"], ["updated_at", "2021-06-01 16:58:42.822247"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 16 AND "comprehension_feedbacks"."rule_id" = 221) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 221], ["text", "Here is some test feedback."], ["description", "Test description for test feedback record."], ["order", 16], ["created_at", "2021-06-01 16:58:42.824494"], ["updated_at", "2021-06-01 16:58:42.824494"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["rule_type", "spelling"]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1[0m  [["rule_id", 221]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #feedback_object should return appropriate error if the endpoint returns an error. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------
Comprehension::SpellingCheckTest: test_: #feedback_object should return appropriate feedback attributes if there is no spelling error. 
---------------------------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."rule_type" = $1  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["rule_type", "spelling"]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should validate that :highlight_type cannot be empty/falsy. 
-------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should validate that :highlight_type is either ‹"passage"›, ‹"response"›, or ‹"prompt"›. 
------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should validate that :text cannot be empty/falsy. 
---------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should validate that the length of :text is between 1 and 5000. 
-----------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: relationships should belong to feedback. 
------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::HighlightTest: test_: validations should validate that :starting_index looks like an integer greater than or equal to 0. 
----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be true if sequence_type is incorrect and entry does not match the regex text. 
----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '756cab8e-4ba0-4d05-8c98-21cf7ac29338' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "756cab8e-4ba0-4d05-8c98-21cf7ac29338"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.851771"], ["updated_at", "2021-06-01 16:58:42.851771"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 222], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.853504"], ["updated_at", "2021-06-01 16:58:42.853504"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 222]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have one plagiarism_text. 
-------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :name cannot be empty/falsy. 
----------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '13f7d1e9-ca2e-4612-9cf2-d0d10a69cf3d' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :uid is case-sensitively unique. 
--------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules"  ORDER BY "comprehension_rules"."id" ASC LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "66f9fb00-bad6-4b91-9bd1-5a681147a93d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.861385"], ["updated_at", "2021-06-01 16:58:42.861385"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '66f9fb00-bad6-4b91-9bd1-5a681147a93d' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '66F9FB00-BAD6-4B91-9BD1-5A681147A93D' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: before_validation assign_uid_if_missing should set new uid if missing. 
-------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6c309285-8fac-4bc0-9ba7-4aed9a2144be' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should does not create plagiarism rule if plagiarism rule already exists for prompt. 
-----------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 78"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 78"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 222 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 78"], ["name", "MyString 79"], ["target_level", 1], ["parent_activity_id", 222], ["created_at", "2021-06-01 16:58:42.871889"], ["updated_at", "2021-06-01 16:58:42.871889"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 219], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.873304"], ["updated_at", "2021-06-01 16:58:42.873304"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 219], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.873304"], ["updated_at", "2021-06-01 16:58:42.873304"], ["id", 164], ["id", 164]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 79"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 79"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 223 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 79"], ["name", "MyString 80"], ["target_level", 1], ["parent_activity_id", 223], ["created_at", "2021-06-01 16:58:42.877471"], ["updated_at", "2021-06-01 16:58:42.877471"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 220], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.878881"], ["updated_at", "2021-06-01 16:58:42.878881"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 220], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.878881"], ["updated_at", "2021-06-01 16:58:42.878881"], ["id", 165], ["id", 165]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 164[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 164], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 219]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '190a0259-bbab-4565-bce9-d6d7ba5ef9ff' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "190a0259-bbab-4565-bce9-d6d7ba5ef9ff"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.885006"], ["updated_at", "2021-06-01 16:58:42.885006"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 164], ["rule_id", 224], ["created_at", "2021-06-01 16:58:42.885898"], ["updated_at", "2021-06-01 16:58:42.885898"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 164[0m
  [1m[35mComprehension::Rule Load (0.4ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 164], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 219]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cba36f71-aab5-432e-a145-22d9b20baab5' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #determine_feedback_from_history should fetch lowest order feedback with text not matched from history. 
----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7eb90cc2-ca60-4fe7-8e8f-f3f4269e5f0a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "7eb90cc2-ca60-4fe7-8e8f-f3f4269e5f0a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.892542"], ["updated_at", "2021-06-01 16:58:42.892542"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 225) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 225], ["text", "Example feedback 1"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.894832"], ["updated_at", "2021-06-01 16:58:42.894832"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 225) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 225], ["text", "Example feedback 2"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.897095"], ["updated_at", "2021-06-01 16:58:42.897095"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" = 225) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 225], ["text", "Example feedback 3"], ["description", "Test description for test feedback record."], ["order", 2], ["created_at", "2021-06-01 16:58:42.899637"], ["updated_at", "2021-06-01 16:58:42.899637"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND ("comprehension_feedbacks"."text" != 'Example feedback 1')  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1[0m  [["rule_id", 225]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: before_validation assign_uid_if_missing should keep existing uid if already set. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '09a57466-7b73-4f03-b7c8-fa7b952ca2dd' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: display_name should correspond to the correct display name. 
--------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7eef6a6f-1d55-440e-9d35-945c1dddaa86' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "7eef6a6f-1d55-440e-9d35-945c1dddaa86"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-2"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.905724"], ["updated_at", "2021-06-01 16:58:42.905724"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #after_create #assign_to_all_prompts should not assign newly created rules to prompts that somehow already have them assigned. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 80"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 80"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 224 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 80"], ["name", "MyString 81"], ["target_level", 1], ["parent_activity_id", 224], ["created_at", "2021-06-01 16:58:42.909659"], ["updated_at", "2021-06-01 16:58:42.909659"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 221], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.910920"], ["updated_at", "2021-06-01 16:58:42.910920"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 221], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.910920"], ["updated_at", "2021-06-01 16:58:42.910920"], ["id", 166], ["id", 166]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1f78931b-d009-44e8-adf5-dee4d078e208' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "1f78931b-d009-44e8-adf5-dee4d078e208"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.914814"], ["updated_at", "2021-06-01 16:58:42.914814"]]
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts"
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '1f78931b-d009-44e8-adf5-dee4d078e208' AND "comprehension_rules"."id" != 227) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13  [["uid", "1f78931b-d009-44e8-adf5-dee4d078e208"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.914814"], ["updated_at", "2021-06-01 16:58:42.914814"], ["id", 227], ["id", 227]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 166], ["rule_id", 227], ["created_at", "2021-06-01 16:58:42.917578"], ["updated_at", "2021-06-01 16:58:42.917578"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 166]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be true if entry does not match the regex text. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f033dcae-857a-4a0f-a95b-446981063313' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f033dcae-857a-4a0f-a95b-446981063313"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.921155"], ["updated_at", "2021-06-01 16:58:42.921155"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 228], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:42.922751"], ["updated_at", "2021-06-01 16:58:42.922751"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 228]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #determine_feedback_from_history should fetch highest order if all feedbacks have text matched from history. 
---------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b3e3edfc-b315-441f-8c92-7506ae53250a' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b3e3edfc-b315-441f-8c92-7506ae53250a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.925972"], ["updated_at", "2021-06-01 16:58:42.925972"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 229) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 229], ["text", "Example feedback 1"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:42.928259"], ["updated_at", "2021-06-01 16:58:42.928259"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 229) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 229], ["text", "Example feedback 2"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:42.930253"], ["updated_at", "2021-06-01 16:58:42.930253"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" = 229) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 229], ["text", "Example feedback 3"], ["description", "Test description for test feedback record."], ["order", 2], ["created_at", "2021-06-01 16:58:42.932585"], ["updated_at", "2021-06-01 16:58:42.932585"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.4ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND ("comprehension_feedbacks"."text" NOT IN ('Example feedback 1', 'Example feedback 2', 'Example feedback 3'))  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1  [["rule_id", 229]]
  [1m[36mComprehension::Feedback Load (0.2ms)[0m  [1mSELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."order" DESC LIMIT 1[0m  [["rule_id", 229]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have one label. 
---------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many feedbacks. 
--------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #after_create #assign_to_all_prompts should assign newly created rule to all prompts if the rule is universal. 
-----------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 81"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 81"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 225 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 81"], ["name", "MyString 82"], ["target_level", 1], ["parent_activity_id", 225], ["created_at", "2021-06-01 16:58:42.941198"], ["updated_at", "2021-06-01 16:58:42.941198"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 222], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.942746"], ["updated_at", "2021-06-01 16:58:42.942746"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 222], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.942746"], ["updated_at", "2021-06-01 16:58:42.942746"], ["id", 167], ["id", 167]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'faff0331-19e8-496c-9ee1-9def84109525' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "faff0331-19e8-496c-9ee1-9def84109525"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.946571"], ["updated_at", "2021-06-01 16:58:42.946571"]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts"[0m
  [1m[35mComprehension::Prompt Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1 AND "comprehension_prompts"."id" = $2 LIMIT 1  [["rule_id", 230], ["id", 167]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("rule_id", "prompt_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["rule_id", 230], ["prompt_id", 167], ["created_at", "2021-06-01 16:58:42.949320"], ["updated_at", "2021-06-01 16:58:42.949320"]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'faff0331-19e8-496c-9ee1-9def84109525' AND "comprehension_rules"."id" != 230) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "uid" = $1, "name" = $2, "note" = $3, "universal" = $4, "rule_type" = $5, "optimal" = $6, "state" = $7, "suborder" = $8, "concept_uid" = $9, "created_at" = $10, "updated_at" = $11, "id" = $12 WHERE "comprehension_rules"."id" = $13[0m  [["uid", "faff0331-19e8-496c-9ee1-9def84109525"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "t"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.946571"], ["updated_at", "2021-06-01 16:58:42.946571"], ["id", 230], ["id", 230]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 167]]
  [1m[35mComprehension::Prompt Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1 AND "comprehension_prompts"."id" = $2 LIMIT 1  [["rule_id", 230], ["id", 167]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many prompts_rules. 
------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :rule_type is either ‹"autoML"›, ‹"grammar"›, ‹"opinion"›, ‹"plagiarism"›, ‹"rules-based-1"›, ‹"rules-based-2"›, ‹"rules-based-3"›, or ‹"spelling"›. 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '1a02b71e-f5fb-4d30-80c2-7ae3b236264e' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should creates plagiarism rule if first rule for prompt. 
-------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 82"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 82"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 226 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 82"], ["name", "MyString 83"], ["target_level", 1], ["parent_activity_id", 226], ["created_at", "2021-06-01 16:58:42.966936"], ["updated_at", "2021-06-01 16:58:42.966936"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 223], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.968525"], ["updated_at", "2021-06-01 16:58:42.968525"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 223], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.968525"], ["updated_at", "2021-06-01 16:58:42.968525"], ["id", 168], ["id", 168]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 83"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 83"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 227 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 83"], ["name", "MyString 84"], ["target_level", 1], ["parent_activity_id", 227], ["created_at", "2021-06-01 16:58:42.973435"], ["updated_at", "2021-06-01 16:58:42.973435"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 224], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.974803"], ["updated_at", "2021-06-01 16:58:42.974803"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 224], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.974803"], ["updated_at", "2021-06-01 16:58:42.974803"], ["id", 169], ["id", 169]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.3ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 168
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 168], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 223]]
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3c405b61-56c1-472d-b318-e66e831e2a84' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "3c405b61-56c1-472d-b318-e66e831e2a84"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:42.988981"], ["updated_at", "2021-06-01 16:58:42.988981"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 168], ["rule_id", 231], ["created_at", "2021-06-01 16:58:42.989905"], ["updated_at", "2021-06-01 16:58:42.989905"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '3c405b61-56c1-472d-b318-e66e831e2a84' AND "comprehension_rules"."id" != 231) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should create a different type of rule if it is not plagiarism. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 84"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 84"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 228 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 84"], ["name", "MyString 85"], ["target_level", 1], ["parent_activity_id", 228], ["created_at", "2021-06-01 16:58:42.994740"], ["updated_at", "2021-06-01 16:58:42.994740"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 225], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.996240"], ["updated_at", "2021-06-01 16:58:42.996240"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 225], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:42.996240"], ["updated_at", "2021-06-01 16:58:42.996240"], ["id", 170], ["id", 170]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 85"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 85"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 229 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 85"], ["name", "MyString 86"], ["target_level", 1], ["parent_activity_id", 229], ["created_at", "2021-06-01 16:58:43.001500"], ["updated_at", "2021-06-01 16:58:43.001500"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 226], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.003017"], ["updated_at", "2021-06-01 16:58:43.003017"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 226], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.003017"], ["updated_at", "2021-06-01 16:58:43.003017"], ["id", 171], ["id", 171]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 170[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 170], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 225]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ed3594cd-e48a-40d0-9d4f-d105446bf965' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "ed3594cd-e48a-40d0-9d4f-d105446bf965"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.009405"], ["updated_at", "2021-06-01 16:58:43.009405"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 170], ["rule_id", 232], ["created_at", "2021-06-01 16:58:43.010289"], ["updated_at", "2021-06-01 16:58:43.010289"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 170[0m
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 225]]
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3fe3a6ae-44d0-44e1-bc63-0ec2d97337b6' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be false if sequence_type is required and entry does not match regex text. 
------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b2e2e852-f680-4719-9c19-0a08e581a072' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b2e2e852-f680-4719-9c19-0a08e581a072"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.015945"], ["updated_at", "2021-06-01 16:58:43.015945"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 233], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:43.017575"], ["updated_at", "2021-06-01 16:58:43.017575"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "sequence_type", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 233], ["regex_text", "you need this sequence"], ["case_sensitive", "f"], ["sequence_type", "required"], ["created_at", "2021-06-01 16:58:43.018946"], ["updated_at", "2021-06-01 16:58:43.018946"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 233]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that the length of :name is at most 250. 
-----------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ddff4d14-a7a5-4ea7-96bd-dd155800ac56' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ddff4d14-a7a5-4ea7-96bd-dd155800ac56' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :optimal is either ‹true› or ‹false›. 
-------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f4d4e6b8-daf9-49d1-b227-2ae75731d722' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f4d4e6b8-daf9-49d1-b227-2ae75731d722' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: serializable_hash should fill out hash with all fields. 
----------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 86"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 86"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 230 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 86"], ["name", "MyString 87"], ["target_level", 1], ["parent_activity_id", 230], ["created_at", "2021-06-01 16:58:43.031349"], ["updated_at", "2021-06-01 16:58:43.031349"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 227], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.033283"], ["updated_at", "2021-06-01 16:58:43.033283"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 227], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.033283"], ["updated_at", "2021-06-01 16:58:43.033283"], ["id", 172], ["id", 172]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '70f10c7d-7b22-46c1-a19e-aa5e54c955d3' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "70f10c7d-7b22-46c1-a19e-aa5e54c955d3"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.036915"], ["updated_at", "2021-06-01 16:58:43.036915"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 172], ["rule_id", 234], ["created_at", "2021-06-01 16:58:43.038687"], ["updated_at", "2021-06-01 16:58:43.038687"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1  [["rule_id", 234]]
  [1m[36mComprehension::PlagiarismText Load (0.1ms)[0m  [1mSELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 234]]
  [1m[35mComprehension::Feedback Load (0.1ms)[0m  SELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  [["rule_id", 234]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 234]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 234]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 234]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #after_create #assign_to_all_prompts should not assign newly created rule to all prompts if the rule is not universal. 
-------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 87"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 87"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 231 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 87"], ["name", "MyString 88"], ["target_level", 1], ["parent_activity_id", 231], ["created_at", "2021-06-01 16:58:43.044886"], ["updated_at", "2021-06-01 16:58:43.044886"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 228], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.046146"], ["updated_at", "2021-06-01 16:58:43.046146"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 228], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.046146"], ["updated_at", "2021-06-01 16:58:43.046146"], ["id", 173], ["id", 173]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd18db43f-4628-4324-a3a5-8730dd498f2d' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "d18db43f-4628-4324-a3a5-8730dd498f2d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.049471"], ["updated_at", "2021-06-01 16:58:43.049471"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 173]]
  [1m[36mComprehension::Prompt Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1 AND "comprehension_prompts"."id" = $2 LIMIT 1[0m  [["rule_id", 235], ["id", 173]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: #determine_feedback_from_history should fetch lowest order feedback if feedback history is empty. 
----------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3c2681d5-fd60-49b3-85d0-ee9201dfb0d6' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "3c2681d5-fd60-49b3-85d0-ee9201dfb0d6"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.053865"], ["updated_at", "2021-06-01 16:58:43.053865"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 0 AND "comprehension_feedbacks"."rule_id" = 236) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 236], ["text", "Example feedback 1"], ["description", "Test description for test feedback record."], ["order", 0], ["created_at", "2021-06-01 16:58:43.056433"], ["updated_at", "2021-06-01 16:58:43.056433"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 1 AND "comprehension_feedbacks"."rule_id" = 236) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 236], ["text", "Example feedback 2"], ["description", "Test description for test feedback record."], ["order", 1], ["created_at", "2021-06-01 16:58:43.058805"], ["updated_at", "2021-06-01 16:58:43.058805"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 2 AND "comprehension_feedbacks"."rule_id" = 236) LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 236], ["text", "Example feedback 3"], ["description", "Test description for test feedback record."], ["order", 2], ["created_at", "2021-06-01 16:58:43.060946"], ["updated_at", "2021-06-01 16:58:43.060946"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1 AND (1=1)  ORDER BY "comprehension_feedbacks"."order" ASC LIMIT 1  [["rule_id", 236]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many prompts through prompts_rules. 
----------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: relationships should have many regex_rules dependent => destroy. 
-------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :suborder looks like an integer greater than or equal to 0 as long as it is not nil. 
------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2983d524-a088-4dc0-8a03-29f558d86856' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2983d524-a088-4dc0-8a03-29f558d86856' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2983d524-a088-4dc0-8a03-29f558d86856' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2983d524-a088-4dc0-8a03-29f558d86856' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2983d524-a088-4dc0-8a03-29f558d86856' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '2983d524-a088-4dc0-8a03-29f558d86856' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :universal is either ‹true› or ‹false›. 
---------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd7817f2d-c142-479e-a60b-621641bc8580' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'd7817f2d-c142-479e-a60b-621641bc8580' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be false if sequence_type is incorrect and entry matches regex text. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e5678013-734d-4bff-8b19-1721f7b977e8' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e5678013-734d-4bff-8b19-1721f7b977e8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.076648"], ["updated_at", "2021-06-01 16:58:43.076648"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 237], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:43.078275"], ["updated_at", "2021-06-01 16:58:43.078275"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 237]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: one_plagiarism_per_prompt should creates subsequent plagiarism rule for different prompt. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 88"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 88"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 232 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 88"], ["name", "MyString 89"], ["target_level", 1], ["parent_activity_id", 232], ["created_at", "2021-06-01 16:58:43.082736"], ["updated_at", "2021-06-01 16:58:43.082736"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 229], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.084129"], ["updated_at", "2021-06-01 16:58:43.084129"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 229], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.084129"], ["updated_at", "2021-06-01 16:58:43.084129"], ["id", 174], ["id", 174]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 89"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 89"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 233 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 89"], ["name", "MyString 90"], ["target_level", 1], ["parent_activity_id", 233], ["created_at", "2021-06-01 16:58:43.088431"], ["updated_at", "2021-06-01 16:58:43.088431"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 230], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.089634"], ["updated_at", "2021-06-01 16:58:43.089634"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 230], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.089634"], ["updated_at", "2021-06-01 16:58:43.089634"], ["id", 175], ["id", 175]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 174[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1[0m  [["prompt_id", 174], ["rule_type", "plagiarism"]]
  [1m[35mComprehension::Activity Load (0.1ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 229]]
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cc58adb1-08ce-4d80-ad67-be4d1ce3f1b8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "cc58adb1-08ce-4d80-ad67-be4d1ce3f1b8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.095497"], ["updated_at", "2021-06-01 16:58:43.095497"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 174], ["rule_id", 238], ["created_at", "2021-06-01 16:58:43.096405"], ["updated_at", "2021-06-01 16:58:43.096405"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Prompt Load (0.3ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = 175[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."id" ASC LIMIT 1  [["prompt_id", 175], ["rule_type", "plagiarism"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 230]]
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '16b2a883-66b2-440d-8729-ccee2177757d' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: validations should validate that :state is either ‹"active"› or ‹"inactive"›. 
--------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '706949b9-eb2b-4796-807e-0778da14d670' LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '706949b9-eb2b-4796-807e-0778da14d670' LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '706949b9-eb2b-4796-807e-0778da14d670' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::RuleTest: test_: regex_is_passing? should be true if sequence_type is required and entry matches regex text. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a31021c9-4338-4b54-82a1-cdad27fffe65' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "a31021c9-4338-4b54-82a1-cdad27fffe65"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.109062"], ["updated_at", "2021-06-01 16:58:43.109062"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 239], ["regex_text", "^Hello"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:43.110899"], ["updated_at", "2021-06-01 16:58:43.110899"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "sequence_type", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 239], ["regex_text", "you need this sequence"], ["case_sensitive", "f"], ["sequence_type", "required"], ["created_at", "2021-06-01 16:58:43.112655"], ["updated_at", "2021-06-01 16:58:43.112655"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 239]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------
Comprehension::PassageTest: test_: relations should belong to activity. 
------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------
Comprehension::PassageTest: test_: validations should validate that the length of :text is at least 50. 
--------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------
Comprehension::PassageTest: test_: validations should validate that :activity cannot be empty/falsy. 
-----------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------
Comprehension::PassageTest: test_: validations should validate that :text cannot be empty/falsy. 
-------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: serializable_hash should fill out hash with all fields. 
--------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'cb2f054d-0786-4fd6-a708-210f884d2b79' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "cb2f054d-0786-4fd6-a708-210f884d2b79"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.123347"], ["updated_at", "2021-06-01 16:58:43.123347"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_plagiarism_texts" ("rule_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["rule_id", 240], ["text", "This is the passage of text that we want to use to check for plagiarism."], ["created_at", "2021-06-01 16:58:43.124724"], ["updated_at", "2021-06-01 16:58:43.124724"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: relations should belong to rule. 
---------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: validations should validate that :rule cannot be empty/falsy. 
--------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismTextTest: test_: validations should validate that :text cannot be empty/falsy. 
--------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: rules should return rules. 
---------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 90"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 90"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 234 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 90"], ["name", "MyString 91"], ["target_level", 1], ["parent_activity_id", 234], ["created_at", "2021-06-01 16:58:43.141401"], ["updated_at", "2021-06-01 16:58:43.141401"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 231], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.143032"], ["updated_at", "2021-06-01 16:58:43.143032"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 231], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.143032"], ["updated_at", "2021-06-01 16:58:43.143032"], ["id", 176], ["id", 176]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '5e64007c-946f-439d-be1f-d67a32f9ea96' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "5e64007c-946f-439d-be1f-d67a32f9ea96"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.147392"], ["updated_at", "2021-06-01 16:58:43.147392"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 176], ["rule_id", 241], ["created_at", "2021-06-01 16:58:43.148539"], ["updated_at", "2021-06-01 16:58:43.148539"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 231], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.150284"], ["updated_at", "2021-06-01 16:58:43.150284"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#rules as HTML
  Parameters: {"id"=>"231"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 231]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 231]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 176]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 241]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 241]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 241]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 241]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 241]]
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: index with activities where one has an archived parent should return with only the unarchived activity. 
--------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name", "flags") VALUES ($1, $2) RETURNING "id"[0m  [["name", "Archived Activity"], ["flags", "{archived}"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "Unarchived Activity"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 235]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 235 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 92"], ["target_level", 8], ["parent_activity_id", 235], ["created_at", "2021-06-01 16:58:43.163866"], ["updated_at", "2021-06-01 16:58:43.163866"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 236]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 236 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "Second Activity"], ["name", "MyString 93"], ["target_level", 5], ["parent_activity_id", 236], ["created_at", "2021-06-01 16:58:43.166730"], ["updated_at", "2021-06-01 16:58:43.166730"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#index as HTML
  [1m[35mComprehension::Activity Load (0.6ms)[0m  SELECT "comprehension_activities".* FROM "comprehension_activities" LEFT JOIN activities ON comprehension_activities.parent_activity_id = activities.id WHERE (parent_activity_id IS NULL OR NOT 'archived' = ANY(activities.flags))  ORDER BY "comprehension_activities"."name" ASC
  [1m[36mComprehension::Passage Load (0.2ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1[0m  [["activity_id", 233]]
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 233]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: show should return json if found. 
----------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 94"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.176101"], ["updated_at", "2021-06-01 16:58:43.176101"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 234], ["text", "HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHello"], ["created_at", "2021-06-01 16:58:43.177853"], ["updated_at", "2021-06-01 16:58:43.177853"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 234], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.180215"], ["updated_at", "2021-06-01 16:58:43.180215"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 234], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.180215"], ["updated_at", "2021-06-01 16:58:43.180215"], ["id", 177], ["id", 177]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#show as HTML
  Parameters: {"id"=>"234"}
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 234]]
  [1m[35mComprehension::Passage Load (0.3ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 234]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 234]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a valid record with passage attributes. 
-------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1", "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity - Name", "passages_attributes"=>[{"text"=>"Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello "}]}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity - Name"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.205789"], ["updated_at", "2021-06-01 16:58:43.205789"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_passages" ("text", "activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["text", "Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello Hello "], ["activity_id", 235], ["created_at", "2021-06-01 16:58:43.206699"], ["updated_at", "2021-06-01 16:58:43.206699"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 235]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 235]]
Completed 201 Created in 6ms (Views: 0.1ms | ActiveRecord: 1.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_activities"
  [1m[36mComprehension::Activity Load (0.3ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 235]]
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT  "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  ORDER BY "comprehension_passages"."id" ASC LIMIT 1  [["activity_id", 235]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: destroy should destroy record at id. 
-------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 91"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 91"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 237 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 91"], ["name", "MyString 95"], ["target_level", 1], ["parent_activity_id", 237], ["created_at", "2021-06-01 16:58:43.216664"], ["updated_at", "2021-06-01 16:58:43.216664"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 236], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.218072"], ["updated_at", "2021-06-01 16:58:43.218072"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#destroy as HTML
  Parameters: {"id"=>"236"}
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 236]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.2ms)[0m  [1mSELECT "comprehension_turking_rounds".* FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."activity_id" = $1[0m  [["activity_id", 236]]
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 236]]
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1[0m  [["id", 18]]
  [1m[35mComprehension::Prompt Load (0.1ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 236]]
  [1m[36mSQL (0.1ms)[0m  [1mDELETE FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1[0m  [["id", 236]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 3ms (ActiveRecord: 1.1ms)
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 236]]
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT  "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1 LIMIT 1  [["id", 18]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should update passage if valid, return nothing. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "MyString 96"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.228439"], ["updated_at", "2021-06-01 16:58:43.228439"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 237], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.230279"], ["updated_at", "2021-06-01 16:58:43.230279"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 237], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.232183"], ["updated_at", "2021-06-01 16:58:43.232183"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 237], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.232183"], ["updated_at", "2021-06-01 16:58:43.232183"], ["id", 178], ["id", 178]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"passages_attributes"=>[{"id"=>"19", "text"=>"GoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbye"}]}, "id"=>"237"}
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 237]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Passage Load (0.2ms)[0m  [1mSELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1 AND "comprehension_passages"."id" = 19[0m  [["activity_id", 237]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_passages" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_passages"."id" = $3  [["text", "GoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbyeGoodbye"], ["updated_at", "2021-06-01 16:58:43.240716"], ["id", 19]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 0.7ms)
  [1m[35mComprehension::Passage Load (0.2ms)[0m  SELECT  "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."id" = $1 LIMIT 1  [["id", 19]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should not create an invalid record and return errors as json. 
----------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"  [["key", "comprehension"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_activities"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should update record if valid, return nothing. 
------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 97"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.252564"], ["updated_at", "2021-06-01 16:58:43.252564"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 238], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.254035"], ["updated_at", "2021-06-01 16:58:43.254035"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 238], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.255279"], ["updated_at", "2021-06-01 16:58:43.255279"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 238], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.255279"], ["updated_at", "2021-06-01 16:58:43.255279"], ["id", 179], ["id", 179]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"2", "scored_level"=>"5th grade", "target_level"=>"9", "title"=>"New title"}, "id"=>"238"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 238]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE ("comprehension_activities"."parent_activity_id" = 2 AND "comprehension_activities"."id" != 238) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_activities" SET "title" = $1, "parent_activity_id" = $2, "target_level" = $3, "scored_level" = $4, "updated_at" = $5 WHERE "comprehension_activities"."id" = $6[0m  [["title", "New title"], ["parent_activity_id", 2], ["target_level", 9], ["scored_level", "5th grade"], ["updated_at", "2021-06-01 16:58:43.262192"], ["id", 238]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 3ms (ActiveRecord: 0.9ms)
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1[0m  [["id", 238]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a valid record with prompt attributes. 
------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"[0m  [["key", "comprehension"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1", "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity - Name", "prompts_attributes"=>[{"text"=>"meat is bad for you.", "conjunction"=>"because"}]}}
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity - Name"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.275300"], ["updated_at", "2021-06-01 16:58:43.275300"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("conjunction", "text", "max_attempts", "activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 239], ["created_at", "2021-06-01 16:58:43.276202"], ["updated_at", "2021-06-01 16:58:43.276202"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "conjunction" = $1, "text" = $2, "max_attempts" = $3, "activity_id" = $4, "created_at" = $5, "updated_at" = $6, "id" = $7 WHERE "comprehension_prompts"."id" = $8  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 239], ["created_at", "2021-06-01 16:58:43.276202"], ["updated_at", "2021-06-01 16:58:43.276202"], ["id", 180], ["id", 180]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 239]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 239]]
Completed 201 Created in 8ms (Views: 0.1ms | ActiveRecord: 1.5ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_activities"
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  [["activity_id", 239]]
  [1m[36mComprehension::Activity Load (0.2ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities"  ORDER BY "comprehension_activities"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1  ORDER BY "comprehension_prompts"."id" ASC LIMIT 1  [["activity_id", 239]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a valid record and return it as json. 
-----------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"  [["key", "comprehension"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"1", "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity - Name"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "First Activity - Name"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.289891"], ["updated_at", "2021-06-01 16:58:43.289891"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 240]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 240]]
Completed 201 Created in 3ms (Views: 0.1ms | ActiveRecord: 0.8ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_activities"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: index should return successfully - no activities. 
--------------------------------------------------------------------------------------------------
Processing by Comprehension::ActivitiesController#index as HTML
  [1m[36mComprehension::Activity Load (0.5ms)[0m  [1mSELECT "comprehension_activities".* FROM "comprehension_activities" LEFT JOIN activities ON comprehension_activities.parent_activity_id = activities.id WHERE (parent_activity_id IS NULL OR NOT 'archived' = ANY(activities.flags))  ORDER BY "comprehension_activities"."name" ASC[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: rules should 404 if activity is invalid. 
-----------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 92"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 92"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 238 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 92"], ["name", "MyString 98"], ["target_level", 1], ["parent_activity_id", 238], ["created_at", "2021-06-01 16:58:43.302254"], ["updated_at", "2021-06-01 16:58:43.302254"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 241], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.303941"], ["updated_at", "2021-06-01 16:58:43.303941"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 241], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.303941"], ["updated_at", "2021-06-01 16:58:43.303941"], ["id", 181], ["id", 181]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '3d6640ab-8ed0-4c8c-862f-376247658406' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "3d6640ab-8ed0-4c8c-862f-376247658406"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.308249"], ["updated_at", "2021-06-01 16:58:43.308249"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 181], ["rule_id", 242], ["created_at", "2021-06-01 16:58:43.309118"], ["updated_at", "2021-06-01 16:58:43.309118"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["activity_id", 241], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.310793"], ["updated_at", "2021-06-01 16:58:43.310793"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#rules as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 0ms (ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: index with actitivites should return successfully. 
---------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "First Activity"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "First Activity"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 239 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "Name 1"], ["target_level", 8], ["parent_activity_id", 239], ["created_at", "2021-06-01 16:58:43.318920"], ["updated_at", "2021-06-01 16:58:43.318920"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "Second Activity"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "Second Activity"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 240 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "Second Activity"], ["name", "Name 2"], ["target_level", 5], ["parent_activity_id", 240], ["created_at", "2021-06-01 16:58:43.322763"], ["updated_at", "2021-06-01 16:58:43.322763"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::ActivitiesController#index as HTML
  [1m[36mComprehension::Activity Load (0.5ms)[0m  [1mSELECT "comprehension_activities".* FROM "comprehension_activities" LEFT JOIN activities ON comprehension_activities.parent_activity_id = activities.id WHERE (parent_activity_id IS NULL OR NOT 'archived' = ANY(activities.flags))  ORDER BY "comprehension_activities"."name" ASC[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 242]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 242]]
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 243]]
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 243]]
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should update prompt if valid, return nothing. 
------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 99"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.332432"], ["updated_at", "2021-06-01 16:58:43.332432"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 244], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.334150"], ["updated_at", "2021-06-01 16:58:43.334150"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 244], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.335845"], ["updated_at", "2021-06-01 16:58:43.335845"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 244], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.335845"], ["updated_at", "2021-06-01 16:58:43.335845"], ["id", 182], ["id", 182]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"prompts_attributes"=>[{"id"=>"182", "text"=>"this is a good thing."}]}, "id"=>"244"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 244]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Prompt Load (0.2ms)[0m  SELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1 AND "comprehension_prompts"."id" = 182  [["activity_id", 244]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "text" = $1, "updated_at" = $2 WHERE "comprehension_prompts"."id" = $3[0m  [["text", "this is a good thing."], ["updated_at", "2021-06-01 16:58:43.343817"], ["id", 182]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 204 No Content in 3ms (ActiveRecord: 0.7ms)
  [1m[36mComprehension::Prompt Load (0.1ms)[0m  [1mSELECT  "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."id" = $1 LIMIT 1[0m  [["id", 182]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: update should not update record and return errors as json. 
-----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 100"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.347331"], ["updated_at", "2021-06-01 16:58:43.347331"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 245], ["text", "The beginning of a wonderful passage. And more information goes here."], ["created_at", "2021-06-01 16:58:43.348713"], ["updated_at", "2021-06-01 16:58:43.348713"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 245], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.350050"], ["updated_at", "2021-06-01 16:58:43.350050"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 245], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.350050"], ["updated_at", "2021-06-01 16:58:43.350050"], ["id", 183], ["id", 183]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#update as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>"2", "scored_level"=>"5th grade", "target_level"=>"99999999", "title"=>"New title"}, "id"=>"245"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 245]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE ("comprehension_activities"."parent_activity_id" = 2 AND "comprehension_activities"."id" != 245) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: show should raise if not found (to be handled by parent app). 
--------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."id" = $1 LIMIT 1[0m  [["id", 1]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "First Activity"], ["name", "MyString 101"], ["target_level", 8], ["scored_level", "4th grade"], ["created_at", "2021-06-01 16:58:43.359447"], ["updated_at", "2021-06-01 16:58:43.359447"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_passages" ("activity_id", "text", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["activity_id", 246], ["text", "HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHello"], ["created_at", "2021-06-01 16:58:43.361160"], ["updated_at", "2021-06-01 16:58:43.361160"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 246], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.362873"], ["updated_at", "2021-06-01 16:58:43.362873"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 246], ["conjunction", "because"], ["text", "it is good."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.362873"], ["updated_at", "2021-06-01 16:58:43.362873"], ["id", 184], ["id", 184]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::Activity Load (0.2ms)[0m  SELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::ActivitiesControllerTest: test_: create should create a new parent activity and activity if no parent_activity_id is passed. 
--------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activity_classifications" ("key") VALUES ($1) RETURNING "id"  [["key", "comprehension"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::ActivitiesController#create as HTML
  Parameters: {"activity"=>{"parent_activity_id"=>nil, "scored_level"=>"4th grade", "target_level"=>"8", "title"=>"First Activity", "name"=>"First Activity", "prompts_attributes"=>[{"text"=>"meat is bad for you.", "conjunction"=>"because"}]}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" = $2 LIMIT 1  [["name", "First Activity"], ["activity_classification_id", 12]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name", "activity_classification_id") VALUES ($1, $2) RETURNING "id"[0m  [["name", "First Activity"], ["activity_classification_id", 12]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 241 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "scored_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["title", "First Activity"], ["name", "First Activity"], ["target_level", 8], ["scored_level", "4th grade"], ["parent_activity_id", 241], ["created_at", "2021-06-01 16:58:43.378478"], ["updated_at", "2021-06-01 16:58:43.378478"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("conjunction", "text", "max_attempts", "activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 247], ["created_at", "2021-06-01 16:58:43.379252"], ["updated_at", "2021-06-01 16:58:43.379252"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "conjunction" = $1, "text" = $2, "max_attempts" = $3, "activity_id" = $4, "created_at" = $5, "updated_at" = $6, "id" = $7 WHERE "comprehension_prompts"."id" = $8  [["conjunction", "because"], ["text", "meat is bad for you."], ["max_attempts", 5], ["activity_id", 247], ["created_at", "2021-06-01 16:58:43.379252"], ["updated_at", "2021-06-01 16:58:43.379252"], ["id", 185], ["id", 185]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Passage Load (0.1ms)[0m  SELECT "comprehension_passages".* FROM "comprehension_passages" WHERE "comprehension_passages"."activity_id" = $1  [["activity_id", 247]]
  [1m[36mComprehension::Prompt Load (0.2ms)[0m  [1mSELECT "comprehension_prompts".* FROM "comprehension_prompts" WHERE "comprehension_prompts"."activity_id" = $1[0m  [["activity_id", 247]]
Completed 201 Created in 8ms (Views: 0.1ms | ActiveRecord: 1.7ms)
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 LIMIT 1  [["name", "First Activity"]]
  [1m[36mComprehension::Activity Load (0.1ms)[0m  [1mSELECT  "comprehension_activities".* FROM "comprehension_activities" WHERE "comprehension_activities"."title" = $1 LIMIT 1[0m  [["title", "First Activity"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should set a default uuid when creating a new record. 
----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 93"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 93"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 242 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 93"], ["name", "MyString 102"], ["target_level", 1], ["parent_activity_id", 242], ["created_at", "2021-06-01 16:58:43.387874"], ["updated_at", "2021-06-01 16:58:43.387874"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '08aef652-a070-4087-94cd-a736147fb780' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 248], ["expires_at", "2021-07-01 16:58:43.388738"], ["uuid", "08aef652-a070-4087-94cd-a736147fb780"], ["created_at", "2021-06-01 16:58:43.389851"], ["updated_at", "2021-06-01 16:58:43.389851"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 94"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 94"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 243 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 94"], ["name", "MyString 103"], ["target_level", 1], ["parent_activity_id", 243], ["created_at", "2021-06-01 16:58:43.392886"], ["updated_at", "2021-06-01 16:58:43.392886"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '3c94978c-3596-4b73-93f4-427022ab4858' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 249], ["expires_at", "2021-07-01 16:58:43.393712"], ["uuid", "3c94978c-3596-4b73-93f4-427022ab4858"], ["created_at", "2021-06-01 16:58:43.394698"], ["updated_at", "2021-06-01 16:58:43.394698"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should ensure expires_at is a future date on create. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 95"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 95"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 244 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 95"], ["name", "MyString 104"], ["target_level", 1], ["parent_activity_id", 244], ["created_at", "2021-06-01 16:58:43.398374"], ["updated_at", "2021-06-01 16:58:43.398374"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '212c2658-db19-440c-a732-8dc3fd7f7d6d' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 250], ["expires_at", "2021-07-01 16:58:43.399705"], ["uuid", "212c2658-db19-440c-a732-8dc3fd7f7d6d"], ["created_at", "2021-06-01 16:58:43.401337"], ["updated_at", "2021-06-01 16:58:43.401337"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '3aa1e0cf-9482-4590-8cda-9f27a659464f' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: relationships should belong to activity. 
---------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should validate that :expires_at cannot be empty/falsy. 
------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 97"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 97"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 245 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 97"], ["name", "MyString 106"], ["target_level", 1], ["parent_activity_id", 245], ["created_at", "2021-06-01 16:58:43.410479"], ["updated_at", "2021-06-01 16:58:43.410479"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'f1d923d5-eeea-4a16-aa45-6c7e95260129' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 251], ["expires_at", "2021-07-01 16:58:43.411518"], ["uuid", "f1d923d5-eeea-4a16-aa45-6c7e95260129"], ["created_at", "2021-06-01 16:58:43.412710"], ["updated_at", "2021-06-01 16:58:43.412710"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '3d901a44-6647-4216-b26e-93533e56a8a1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should validate presence of uuid on any update call. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 98"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 98"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 246 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 98"], ["name", "MyString 107"], ["target_level", 1], ["parent_activity_id", 246], ["created_at", "2021-06-01 16:58:43.418816"], ["updated_at", "2021-06-01 16:58:43.418816"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '7f33a54d-e643-4c6e-9e1b-31fe50e02168' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 252], ["expires_at", "2021-07-01 16:58:43.419688"], ["uuid", "7f33a54d-e643-4c6e-9e1b-31fe50e02168"], ["created_at", "2021-06-01 16:58:43.420797"], ["updated_at", "2021-06-01 16:58:43.420797"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 99"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 99"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 247 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 99"], ["name", "MyString 108"], ["target_level", 1], ["parent_activity_id", 247], ["created_at", "2021-06-01 16:58:43.423895"], ["updated_at", "2021-06-01 16:58:43.423895"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'c5208179-d7a0-4b44-a522-4858779d7a42' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 253], ["expires_at", "2021-07-01 16:58:43.424729"], ["uuid", "c5208179-d7a0-4b44-a522-4858779d7a42"], ["created_at", "2021-06-01 16:58:43.425726"], ["updated_at", "2021-06-01 16:58:43.425726"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" IS NULL AND "comprehension_turking_rounds"."id" != 40) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should make uuid read-only. 
--------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 100"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 100"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 248 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 100"], ["name", "MyString 109"], ["target_level", 1], ["parent_activity_id", 248], ["created_at", "2021-06-01 16:58:43.430455"], ["updated_at", "2021-06-01 16:58:43.430455"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '0b1728d7-6995-4850-a7ff-9dc20ea8f4db' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 254], ["expires_at", "2021-07-01 16:58:43.431467"], ["uuid", "0b1728d7-6995-4850-a7ff-9dc20ea8f4db"], ["created_at", "2021-06-01 16:58:43.432952"], ["updated_at", "2021-06-01 16:58:43.432952"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should validate that :activity_id cannot be empty/falsy. 
-------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 101"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 101"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 249 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 101"], ["name", "MyString 110"], ["target_level", 1], ["parent_activity_id", 249], ["created_at", "2021-06-01 16:58:43.437134"], ["updated_at", "2021-06-01 16:58:43.437134"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '82b4237d-ad48-4d91-af91-0dd1c5f53ae9' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 255], ["expires_at", "2021-07-01 16:58:43.438570"], ["uuid", "82b4237d-ad48-4d91-af91-0dd1c5f53ae9"], ["created_at", "2021-06-01 16:58:43.440033"], ["updated_at", "2021-06-01 16:58:43.440033"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'b2c8daa6-5794-4fbc-a3f1-337c273567a4' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should validate that :uuid is case-insensitively unique. 
-------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 102"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 102"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 250 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 102"], ["name", "MyString 111"], ["target_level", 1], ["parent_activity_id", 250], ["created_at", "2021-06-01 16:58:43.454943"], ["updated_at", "2021-06-01 16:58:43.454943"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'fc8c88ce-69e2-44a2-853d-2beb5e2f4c64' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 256], ["expires_at", "2021-07-01 16:58:43.455949"], ["uuid", "fc8c88ce-69e2-44a2-853d-2beb5e2f4c64"], ["created_at", "2021-06-01 16:58:43.457107"], ["updated_at", "2021-06-01 16:58:43.457107"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Load (0.9ms)[0m  [1mSELECT  "comprehension_turking_rounds".* FROM "comprehension_turking_rounds"  ORDER BY "comprehension_turking_rounds"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'fc8c88ce-69e2-44a2-853d-2beb5e2f4c64' LIMIT 1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'FC8C88CE-69E2-44A2-853D-2BEB5E2F4C64' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundTest: test_: validations should allow updates to expires_at to be in the past even though creates should not. 
-----------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 103"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 103"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 251 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 103"], ["name", "MyString 112"], ["target_level", 1], ["parent_activity_id", 251], ["created_at", "2021-06-01 16:58:43.465895"], ["updated_at", "2021-06-01 16:58:43.465895"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '38353a50-ce62-4e11-8717-472d55445044' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 257], ["expires_at", "2021-07-01 16:58:43.466959"], ["uuid", "38353a50-ce62-4e11-8717-472d55445044"], ["created_at", "2021-06-01 16:58:43.468190"], ["updated_at", "2021-06-01 16:58:43.468190"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 104"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 104"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 252 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 104"], ["name", "MyString 113"], ["target_level", 1], ["parent_activity_id", 252], ["created_at", "2021-06-01 16:58:43.471914"], ["updated_at", "2021-06-01 16:58:43.471914"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '2bb839c2-ee89-42ec-afdb-cf2a66d236c6' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 258], ["expires_at", "2021-07-01 16:58:43.472853"], ["uuid", "2bb839c2-ee89-42ec-afdb-cf2a66d236c6"], ["created_at", "2021-06-01 16:58:43.473959"], ["updated_at", "2021-06-01 16:58:43.473959"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE ("comprehension_turking_rounds"."uuid" = '2bb839c2-ee89-42ec-afdb-cf2a66d236c6' AND "comprehension_turking_rounds"."id" != 45) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------
Comprehension::PromptsRuleTest: test_: relationships should belong to prompt. 
------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------
Comprehension::PromptsRuleTest: test_: relationships should belong to rule. 
----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------
ComprehensionTest: test_: Comprehension should be a module. 
------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: relationships should belong to turking_round. 
-----------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: validations should validate that :activity_session_uid is case-sensitively unique. 
------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::TurkingRoundActivitySession Load (2.3ms)[0m  [1mSELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions"  ORDER BY "comprehension_turking_round_activity_sessions"."id" ASC LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.4ms)[0m  [1mINSERT INTO "comprehension_turking_round_activity_sessions" ("created_at", "updated_at") VALUES ($1, $2) RETURNING "id"[0m  [["created_at", "2021-06-01 16:58:43.487541"], ["updated_at", "2021-06-01 16:58:43.487541"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_turking_round_activity_sessions" SET "activity_session_uid" = $1, "updated_at" = $2 WHERE "comprehension_turking_round_activity_sessions"."id" = $3  [["activity_session_uid", "dummy value"], ["updated_at", "2021-06-01 16:58:43.490331"], ["id", 9]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'dummy value' LIMIT 1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'DUMMY VALUE' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: validations should validate that :turking_round_id cannot be empty/falsy. 
---------------------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionTest: test_: validations should validate that :activity_session_uid cannot be empty/falsy. 
-------------------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: show should return json if found. 
----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 105"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 105"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 253 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 105"], ["name", "MyString 114"], ["target_level", 1], ["parent_activity_id", 253], ["created_at", "2021-06-01 16:58:43.511538"], ["updated_at", "2021-06-01 16:58:43.511538"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '18b638be-59d7-47b8-8063-ae6b063e3c8f' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 259], ["expires_at", "2021-07-01 16:58:43.512585"], ["uuid", "18b638be-59d7-47b8-8063-ae6b063e3c8f"], ["created_at", "2021-06-01 16:58:43.513685"], ["updated_at", "2021-06-01 16:58:43.513685"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '0092d54a-a4ab-4f83-8232-9bd4e3900416' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["turking_round_id", 46], ["activity_session_uid", "0092d54a-a4ab-4f83-8232-9bd4e3900416"], ["created_at", "2021-06-01 16:58:43.515368"], ["updated_at", "2021-06-01 16:58:43.515368"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundActivitySessionsController#show as HTML
  Parameters: {"id"=>"10"}
  [1m[36mComprehension::TurkingRoundActivitySession Load (0.2ms)[0m  [1mSELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1[0m  [["id", 10]]
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: create should not create an invalid record and return errors as json. 
----------------------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::TurkingRoundActivitySessionsController#create as HTML
  Parameters: {"turking_round_activity_session"=>{"activity_session_uid"=>nil}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_turking_round_activity_sessions"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: update should update record if valid, return nothing. 
------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 107"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 107"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 254 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 107"], ["name", "MyString 116"], ["target_level", 1], ["parent_activity_id", 254], ["created_at", "2021-06-01 16:58:43.533193"], ["updated_at", "2021-06-01 16:58:43.533193"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'd3218709-43e6-4060-ac50-bc5c0fc8e1e9' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 260], ["expires_at", "2021-07-01 16:58:43.534885"], ["uuid", "d3218709-43e6-4060-ac50-bc5c0fc8e1e9"], ["created_at", "2021-06-01 16:58:43.536868"], ["updated_at", "2021-06-01 16:58:43.536868"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '01ecef1e-cdd3-491d-871b-6fe5eda22607' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["turking_round_id", 47], ["activity_session_uid", "01ecef1e-cdd3-491d-871b-6fe5eda22607"], ["created_at", "2021-06-01 16:58:43.539411"], ["updated_at", "2021-06-01 16:58:43.539411"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundActivitySessionsController#update as HTML
  Parameters: {"turking_round_activity_session"=>{"activity_session_uid"=>"98a5749e-defe-4273-ae7a-2b5f549ed090"}, "id"=>"11"}
  [1m[36mComprehension::TurkingRoundActivitySession Load (0.4ms)[0m  [1mSELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1[0m  [["id", 11]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE ("comprehension_turking_round_activity_sessions"."activity_session_uid" = '98a5749e-defe-4273-ae7a-2b5f549ed090' AND "comprehension_turking_round_activity_sessions"."id" != 11) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_turking_round_activity_sessions" SET "activity_session_uid" = $1, "updated_at" = $2 WHERE "comprehension_turking_round_activity_sessions"."id" = $3  [["activity_session_uid", "98a5749e-defe-4273-ae7a-2b5f549ed090"], ["updated_at", "2021-06-01 16:58:43.546863"], ["id", 11]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.0ms)
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.2ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 11]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: index with turking_round_activity_sessions should return successfully. 
-----------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 108"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 108"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 255 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 108"], ["name", "MyString 117"], ["target_level", 1], ["parent_activity_id", 255], ["created_at", "2021-06-01 16:58:43.552417"], ["updated_at", "2021-06-01 16:58:43.552417"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '46e60d7c-3e09-47e2-9e07-3ba47e796881' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 261], ["expires_at", "2021-07-01 16:58:43.553294"], ["uuid", "46e60d7c-3e09-47e2-9e07-3ba47e796881"], ["created_at", "2021-06-01 16:58:43.554328"], ["updated_at", "2021-06-01 16:58:43.554328"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'b834fab3-470a-4ca2-a4ae-34e02d1e99f9' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 48], ["activity_session_uid", "b834fab3-470a-4ca2-a4ae-34e02d1e99f9"], ["created_at", "2021-06-01 16:58:43.556129"], ["updated_at", "2021-06-01 16:58:43.556129"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#index as HTML
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions"
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: index should return successfully - no turking_round_activity_session. 
----------------------------------------------------------------------------------------------------------------------------------------
Processing by Comprehension::TurkingRoundActivitySessionsController#index as HTML
  [1m[36mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  [1mSELECT "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions"[0m
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: update should not update record and return errors as json. 
-----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.3ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 109"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 109"]]
  [1m[35mComprehension::Activity Exists (1.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 256 LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 109"], ["name", "MyString 118"], ["target_level", 1], ["parent_activity_id", 256], ["created_at", "2021-06-01 16:58:43.575376"], ["updated_at", "2021-06-01 16:58:43.575376"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRound Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '87c65f0e-e7d5-48eb-b429-ae6cd5762103' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["activity_id", 262], ["expires_at", "2021-07-01 16:58:43.578791"], ["uuid", "87c65f0e-e7d5-48eb-b429-ae6cd5762103"], ["created_at", "2021-06-01 16:58:43.581281"], ["updated_at", "2021-06-01 16:58:43.581281"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'a69de654-b36f-4515-bbf7-4ae3c8d4f6b3' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["turking_round_id", 49], ["activity_session_uid", "a69de654-b36f-4515-bbf7-4ae3c8d4f6b3"], ["created_at", "2021-06-01 16:58:43.584445"], ["updated_at", "2021-06-01 16:58:43.584445"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Comprehension::TurkingRoundActivitySessionsController#update as HTML
  Parameters: {"turking_round_activity_session"=>{"activity_session_uid"=>nil}, "id"=>"13"}
  [1m[36mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  [1mSELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE ("comprehension_turking_round_activity_sessions"."activity_session_uid" IS NULL AND "comprehension_turking_round_activity_sessions"."id" != 13) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Completed 422 Unprocessable Entity in 2ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: destroy should destroy record at id. 
-------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 110"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 110"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 257 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 110"], ["name", "MyString 119"], ["target_level", 1], ["parent_activity_id", 257], ["created_at", "2021-06-01 16:58:43.594799"], ["updated_at", "2021-06-01 16:58:43.594799"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = 'f7bfb054-3adf-47eb-8044-e3c911e4f1ea' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 263], ["expires_at", "2021-07-01 16:58:43.595831"], ["uuid", "f7bfb054-3adf-47eb-8044-e3c911e4f1ea"], ["created_at", "2021-06-01 16:58:43.596994"], ["updated_at", "2021-06-01 16:58:43.596994"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '5c10c22f-bc82-4462-899e-b8356fd8ea94' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 50], ["activity_session_uid", "5c10c22f-bc82-4462-899e-b8356fd8ea94"], ["created_at", "2021-06-01 16:58:43.599224"], ["updated_at", "2021-06-01 16:58:43.599224"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#destroy as HTML
  Parameters: {"id"=>"14"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.7ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1  [["id", 14]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 3ms (ActiveRecord: 1.2ms)
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: create should create a valid record and return it as json. 
-----------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 112"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 112"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 258 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 112"], ["name", "MyString 121"], ["target_level", 1], ["parent_activity_id", 258], ["created_at", "2021-06-01 16:58:43.615090"], ["updated_at", "2021-06-01 16:58:43.615090"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '770ff8d5-ce6b-42f9-bb73-92c7cab33d30' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 264], ["expires_at", "2021-07-01 16:58:43.616168"], ["uuid", "770ff8d5-ce6b-42f9-bb73-92c7cab33d30"], ["created_at", "2021-06-01 16:58:43.617406"], ["updated_at", "2021-06-01 16:58:43.617406"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#create as HTML
  Parameters: {"turking_round_activity_session"=>{"turking_round_id"=>"51", "activity_session_uid"=>"0c5f2d0b-06df-4602-aef6-99184260d65e"}}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = '0c5f2d0b-06df-4602-aef6-99184260d65e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 51], ["activity_session_uid", "0c5f2d0b-06df-4602-aef6-99184260d65e"], ["created_at", "2021-06-01 16:58:43.623763"], ["updated_at", "2021-06-01 16:58:43.623763"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 3ms (Views: 0.1ms | ActiveRecord: 0.9ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_turking_round_activity_sessions"
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------
Comprehension::TurkingRoundActivitySessionsControllerTest: test_: show should raise if not found (to be handled by parent app). 
--------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 113"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 113"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 259 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 113"], ["name", "MyString 122"], ["target_level", 1], ["parent_activity_id", 259], ["created_at", "2021-06-01 16:58:43.629597"], ["updated_at", "2021-06-01 16:58:43.629597"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRound Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_rounds" WHERE "comprehension_turking_rounds"."uuid" = '6e318d1e-cc92-426c-ac19-b233853717ac' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_turking_rounds" ("activity_id", "expires_at", "uuid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["activity_id", 265], ["expires_at", "2021-07-01 16:58:43.630772"], ["uuid", "6e318d1e-cc92-426c-ac19-b233853717ac"], ["created_at", "2021-06-01 16:58:43.632221"], ["updated_at", "2021-06-01 16:58:43.632221"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::TurkingRoundActivitySession Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."activity_session_uid" = 'bb9297f1-e2a3-45a1-8429-261c94bac5f6' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_turking_round_activity_sessions" ("turking_round_id", "activity_session_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["turking_round_id", 52], ["activity_session_uid", "bb9297f1-e2a3-45a1-8429-261c94bac5f6"], ["created_at", "2021-06-01 16:58:43.635243"], ["updated_at", "2021-06-01 16:58:43.635243"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Comprehension::TurkingRoundActivitySessionsController#show as HTML
  Parameters: {"id"=>"99999"}
  [1m[35mComprehension::TurkingRoundActivitySession Load (0.3ms)[0m  SELECT  "comprehension_turking_round_activity_sessions".* FROM "comprehension_turking_round_activity_sessions" WHERE "comprehension_turking_round_activity_sessions"."id" = $1 LIMIT 1  [["id", 99999]]
Completed 404 Not Found in 1ms (ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should set previously active model and unassociated rules to state inactive. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 114"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 114"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 260 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 114"], ["name", "MyString 123"], ["target_level", 1], ["parent_activity_id", 260], ["created_at", "2021-06-01 16:58:43.647366"], ["updated_at", "2021-06-01 16:58:43.647366"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 266], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.648809"], ["updated_at", "2021-06-01 16:58:43.648809"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 266], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.648809"], ["updated_at", "2021-06-01 16:58:43.648809"], ["id", 186], ["id", 186]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f267f9f9-5b2d-4744-87cc-4966210357e8' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "f267f9f9-5b2d-4744-87cc-4966210357e8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.652727"], ["updated_at", "2021-06-01 16:58:43.652727"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 186], ["rule_id", 243], ["created_at", "2021-06-01 16:58:43.653597"], ["updated_at", "2021-06-01 16:58:43.653597"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a8c9b521-d4be-4453-9b7e-a64f2a05689c' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "a8c9b521-d4be-4453-9b7e-a64f2a05689c"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.657143"], ["updated_at", "2021-06-01 16:58:43.657143"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 186], ["rule_id", 244], ["created_at", "2021-06-01 16:58:43.658029"], ["updated_at", "2021-06-01 16:58:43.658029"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c168ebaf-e107-4e47-8198-973127ff420b' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "c168ebaf-e107-4e47-8198-973127ff420b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.660874"], ["updated_at", "2021-06-01 16:58:43.660874"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 186], ["rule_id", 245], ["created_at", "2021-06-01 16:58:43.661964"], ["updated_at", "2021-06-01 16:58:43.661964"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 243 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 186]]
  [1m[36mComprehension::Label Load (0.4ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 243]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 244]]
  [1m[36mComprehension::Label Load (0.3ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 245]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 243], ["created_at", "2021-06-01 16:58:43.670842"], ["updated_at", "2021-06-01 16:58:43.670842"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 244 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label2"], ["rule_id", 244], ["created_at", "2021-06-01 16:58:43.675274"], ["updated_at", "2021-06-01 16:58:43.675274"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 245 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label3"], ["rule_id", 245], ["created_at", "2021-06-01 16:58:43.678673"], ["updated_at", "2021-06-01 16:58:43.678673"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 243 AND "comprehension_labels"."id" != 41) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f267f9f9-5b2d-4744-87cc-4966210357e8' AND "comprehension_rules"."id" != 243) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.681930"], ["id", 243]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 244 AND "comprehension_labels"."id" != 42) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'a8c9b521-d4be-4453-9b7e-a64f2a05689c' AND "comprehension_rules"."id" != 244) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.684700"], ["id", 244]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 186], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 243]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 244]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 245]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-17' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-17"], ["name", "AutoML-Model-Name"], ["prompt_id", 186], ["state", "active"], ["labels", "{label1,label2}"], ["created_at", "2021-06-01 16:58:43.689331"], ["updated_at", "2021-06-01 16:58:43.689331"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-18' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-18"], ["name", "AutoML-Model-Name"], ["prompt_id", 186], ["state", "inactive"], ["labels", "{label2,label3}"], ["created_at", "2021-06-01 16:58:43.691376"], ["updated_at", "2021-06-01 16:58:43.691376"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 186], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 243]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 244]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 245]]
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-17' AND "comprehension_automl_models"."id" != 54) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1  [["prompt_id", 186]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 186], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 243]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 244]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 245]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-18' AND "comprehension_automl_models"."id" != 55) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_automl_models" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_automl_models"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.698682"], ["id", 55]]
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 186], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 243]]
  [1m[36mComprehension::Label Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 243 AND "comprehension_labels"."id" != 41) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'f267f9f9-5b2d-4744-87cc-4966210357e8' AND "comprehension_rules"."id" != 243) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "inactive"], ["updated_at", "2021-06-01 16:58:43.705788"], ["id", 243]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 244]]
  [1m[36mComprehension::Label Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 244 AND "comprehension_labels"."id" != 42) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'a8c9b521-d4be-4453-9b7e-a64f2a05689c' AND "comprehension_rules"."id" != 244) LIMIT 1
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 245]]
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 245 AND "comprehension_labels"."id" != 43) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'c168ebaf-e107-4e47-8198-973127ff420b' AND "comprehension_rules"."id" != 245) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.714607"], ["id", 245]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.1ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 54]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 243]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 244]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations shoulda matchers should validate that :name cannot be empty/falsy. 
----------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 115"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 115"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 261 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 115"], ["name", "MyString 124"], ["target_level", 1], ["parent_activity_id", 261], ["created_at", "2021-06-01 16:58:43.721511"], ["updated_at", "2021-06-01 16:58:43.721511"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 267], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.723112"], ["updated_at", "2021-06-01 16:58:43.723112"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 267], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.723112"], ["updated_at", "2021-06-01 16:58:43.723112"], ["id", 187], ["id", 187]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-19' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-19"], ["name", "AutoML-Model-Name"], ["prompt_id", 187], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.726560"], ["updated_at", "2021-06-01 16:58:43.726560"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #older_models should be 1 if there is a single previous model for the prompt. 
---------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.3ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 116"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 116"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 262 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 116"], ["name", "MyString 125"], ["target_level", 1], ["parent_activity_id", 262], ["created_at", "2021-06-01 16:58:43.747402"], ["updated_at", "2021-06-01 16:58:43.747402"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 268], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.748987"], ["updated_at", "2021-06-01 16:58:43.748987"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 268], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.748987"], ["updated_at", "2021-06-01 16:58:43.748987"], ["id", 188], ["id", 188]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-20' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-20"], ["name", "AutoML-Model-Name"], ["prompt_id", 188], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.752449"], ["updated_at", "2021-06-01 16:58:43.752449"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-21' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-21"], ["name", "AutoML-Model-Name"], ["prompt_id", 188], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.754417"], ["updated_at", "2021-06-01 16:58:43.754417"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:43.752449')  [["prompt_id", 188]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:43.754417')[0m  [["prompt_id", 188]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should be valid if labels is an array. 
----------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-22' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should return false and not activate if the active state can not be validated because of labels without corresponding rules. 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 118"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 118"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 263 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 118"], ["name", "MyString 127"], ["target_level", 1], ["parent_activity_id", 263], ["created_at", "2021-06-01 16:58:43.763219"], ["updated_at", "2021-06-01 16:58:43.763219"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 269], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.765464"], ["updated_at", "2021-06-01 16:58:43.765464"]]
  [1m[35mComprehension::Rule Load (0.5ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 269], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.765464"], ["updated_at", "2021-06-01 16:58:43.765464"], ["id", 189], ["id", 189]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ef7cf64a-f690-4d0e-b4ab-90e159b04ad6' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "ef7cf64a-f690-4d0e-b4ab-90e159b04ad6"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.775234"], ["updated_at", "2021-06-01 16:58:43.775234"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 189], ["rule_id", 246], ["created_at", "2021-06-01 16:58:43.776675"], ["updated_at", "2021-06-01 16:58:43.776675"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4de77959-de11-4fe0-9aa0-5ac65ab8bdb6' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "4de77959-de11-4fe0-9aa0-5ac65ab8bdb6"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.779972"], ["updated_at", "2021-06-01 16:58:43.779972"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 189], ["rule_id", 247], ["created_at", "2021-06-01 16:58:43.780930"], ["updated_at", "2021-06-01 16:58:43.780930"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7271b87c-8c5b-48df-af45-4acf6d9525f4' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "7271b87c-8c5b-48df-af45-4acf6d9525f4"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.784408"], ["updated_at", "2021-06-01 16:58:43.784408"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 189], ["rule_id", 248], ["created_at", "2021-06-01 16:58:43.785348"], ["updated_at", "2021-06-01 16:58:43.785348"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 246 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 189]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 246]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 247]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 248]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 246], ["created_at", "2021-06-01 16:58:43.789824"], ["updated_at", "2021-06-01 16:58:43.789824"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 247 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label2"], ["rule_id", 247], ["created_at", "2021-06-01 16:58:43.792529"], ["updated_at", "2021-06-01 16:58:43.792529"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 248 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label3"], ["rule_id", 248], ["created_at", "2021-06-01 16:58:43.794667"], ["updated_at", "2021-06-01 16:58:43.794667"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-23' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-23"], ["name", "AutoML-Model-Name"], ["prompt_id", 189], ["state", "inactive"], ["labels", "{no_rule_for_label}"], ["created_at", "2021-06-01 16:58:43.796728"], ["updated_at", "2021-06-01 16:58:43.796728"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1[0m  [["prompt_id", 189]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 189], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.6ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 246]]
  [1m[35mComprehension::Label Load (0.3ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 247]]
  [1m[36mComprehension::Label Load (0.3ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 248]]
  [1m[35mComprehension::AutomlModel Exists (1.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-23' AND "comprehension_automl_models"."id" != 59) LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.5ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 59]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should return self and be valid with state active if this item is already the active model. 
---------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 119"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 119"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 264 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 119"], ["name", "MyString 128"], ["target_level", 1], ["parent_activity_id", 264], ["created_at", "2021-06-01 16:58:43.817463"], ["updated_at", "2021-06-01 16:58:43.817463"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 270], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.818812"], ["updated_at", "2021-06-01 16:58:43.818812"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 270], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.818812"], ["updated_at", "2021-06-01 16:58:43.818812"], ["id", 190], ["id", 190]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '9b355c69-0125-42b7-a34a-a09fa9b929bb' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "9b355c69-0125-42b7-a34a-a09fa9b929bb"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.823025"], ["updated_at", "2021-06-01 16:58:43.823025"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 190], ["rule_id", 249], ["created_at", "2021-06-01 16:58:43.824174"], ["updated_at", "2021-06-01 16:58:43.824174"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '7a98ef70-bcaa-4750-8f32-6099b95fd59d' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "7a98ef70-bcaa-4750-8f32-6099b95fd59d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.827241"], ["updated_at", "2021-06-01 16:58:43.827241"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 190], ["rule_id", 250], ["created_at", "2021-06-01 16:58:43.828121"], ["updated_at", "2021-06-01 16:58:43.828121"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '70bdd8c5-b793-4ba4-b668-0b9198ebf5c0' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "70bdd8c5-b793-4ba4-b668-0b9198ebf5c0"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.831685"], ["updated_at", "2021-06-01 16:58:43.831685"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 190], ["rule_id", 251], ["created_at", "2021-06-01 16:58:43.832810"], ["updated_at", "2021-06-01 16:58:43.832810"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 249 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 190]]
  [1m[36mComprehension::Label Load (0.3ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 249]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 250]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 251]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 249], ["created_at", "2021-06-01 16:58:43.840466"], ["updated_at", "2021-06-01 16:58:43.840466"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 250 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label2"], ["rule_id", 250], ["created_at", "2021-06-01 16:58:43.843237"], ["updated_at", "2021-06-01 16:58:43.843237"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 251 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label3"], ["rule_id", 251], ["created_at", "2021-06-01 16:58:43.846078"], ["updated_at", "2021-06-01 16:58:43.846078"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 190], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 249]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 250]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 251]]
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-24' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-24"], ["name", "AutoML-Model-Name"], ["prompt_id", 190], ["state", "active"], ["labels", "{label1,label2}"], ["created_at", "2021-06-01 16:58:43.850334"], ["updated_at", "2021-06-01 16:58:43.850334"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 190], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 249]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 250]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 251]]
  [1m[35mComprehension::AutomlModel Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-24' AND "comprehension_automl_models"."id" != 60) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1  [["prompt_id", 190]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 190], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 249]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 250]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 251]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-24' AND "comprehension_automl_models"."id" != 60) LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 190], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 249]]
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 249 AND "comprehension_labels"."id" != 47) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '9b355c69-0125-42b7-a34a-a09fa9b929bb' AND "comprehension_rules"."id" != 249) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.861370"], ["id", 249]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 250]]
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 250 AND "comprehension_labels"."id" != 48) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '7a98ef70-bcaa-4750-8f32-6099b95fd59d' AND "comprehension_rules"."id" != 250) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.864792"], ["id", 250]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 251]]
  [1m[35mComprehension::Label Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 251 AND "comprehension_labels"."id" != 49) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '70bdd8c5-b793-4ba4-b668-0b9198ebf5c0' AND "comprehension_rules"."id" != 251) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.5ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 190], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.3ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 249]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 250]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 251]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-24' AND "comprehension_automl_models"."id" != 60) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #forbid_name_change should not allow name to change after create. 
---------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 120"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 120"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 265 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 120"], ["name", "MyString 129"], ["target_level", 1], ["parent_activity_id", 265], ["created_at", "2021-06-01 16:58:43.880098"], ["updated_at", "2021-06-01 16:58:43.880098"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 271], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.881462"], ["updated_at", "2021-06-01 16:58:43.881462"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 271], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.881462"], ["updated_at", "2021-06-01 16:58:43.881462"], ["id", 191], ["id", 191]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-25' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-25"], ["name", "name"], ["prompt_id", 191], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.884286"], ["updated_at", "2021-06-01 16:58:43.884286"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-25' AND "comprehension_automl_models"."id" != 61) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2  [["updated_at", "2021-06-01 16:58:43.885775"], ["id", 61]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.1ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 61]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should be valid if labels has at least one item in it. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-26' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #populate_from_automl_model_id should set name, labels, and state when called. 
----------------------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'Test-ID' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations shoulda matchers should validate that :automl_model_id is case-sensitively unique. 
--------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 122"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 122"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 266 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 122"], ["name", "MyString 131"], ["target_level", 1], ["parent_activity_id", 266], ["created_at", "2021-06-01 16:58:43.893648"], ["updated_at", "2021-06-01 16:58:43.893648"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 272], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.895226"], ["updated_at", "2021-06-01 16:58:43.895226"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 272], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.895226"], ["updated_at", "2021-06-01 16:58:43.895226"], ["id", 192], ["id", 192]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-27' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-27"], ["name", "AutoML-Model-Name"], ["prompt_id", 192], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.898754"], ["updated_at", "2021-06-01 16:58:43.898754"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.6ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models"  ORDER BY "comprehension_automl_models"."id" ASC LIMIT 1[0m
  [1m[35mComprehension::AutomlModel Exists (0.7ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-27' LIMIT 1
  [1m[36mComprehension::AutomlModel Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'model-id-27' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations shoulda matchers should validate that :automl_model_id cannot be empty/falsy. 
---------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 123"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 123"]]
  [1m[35mComprehension::Activity Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 267 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 123"], ["name", "MyString 132"], ["target_level", 1], ["parent_activity_id", 267], ["created_at", "2021-06-01 16:58:43.911447"], ["updated_at", "2021-06-01 16:58:43.911447"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 273], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.913116"], ["updated_at", "2021-06-01 16:58:43.913116"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 273], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.913116"], ["updated_at", "2021-06-01 16:58:43.913116"], ["id", 193], ["id", 193]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-28' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-28"], ["name", "AutoML-Model-Name"], ["prompt_id", 193], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.916357"], ["updated_at", "2021-06-01 16:58:43.916357"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #labels_have_associated_rules? should be false if there are missing labels from the referenced prompt. 
----------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 124"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 124"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 268 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 124"], ["name", "MyString 133"], ["target_level", 1], ["parent_activity_id", 268], ["created_at", "2021-06-01 16:58:43.923327"], ["updated_at", "2021-06-01 16:58:43.923327"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 274], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.924641"], ["updated_at", "2021-06-01 16:58:43.924641"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 274], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.924641"], ["updated_at", "2021-06-01 16:58:43.924641"], ["id", 194], ["id", 194]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-29' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-29"], ["name", "AutoML-Model-Name"], ["prompt_id", 194], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.927406"], ["updated_at", "2021-06-01 16:58:43.927406"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 194], ["rule_type", "autoML"]]
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-29' AND "comprehension_automl_models"."id" != 64) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #fetch_automl_label should return the highest score label display_name. 
---------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 125"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 125"]]
  [1m[36mComprehension::Activity Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 269 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 125"], ["name", "MyString 134"], ["target_level", 1], ["parent_activity_id", 269], ["created_at", "2021-06-01 16:58:43.934245"], ["updated_at", "2021-06-01 16:58:43.934245"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 275], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.937213"], ["updated_at", "2021-06-01 16:58:43.937213"]]
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 275], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.937213"], ["updated_at", "2021-06-01 16:58:43.937213"], ["id", 195], ["id", 195]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-30' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-30"], ["name", "AutoML-Model-Name"], ["prompt_id", 195], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:43.942226"], ["updated_at", "2021-06-01 16:58:43.942226"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should not be valid if labels is not an array. 
------------------------------------------------------------------------------------------------------------------
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-31' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should set model and associated rules to state active if valid. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 127"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 127"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 270 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 127"], ["name", "MyString 136"], ["target_level", 1], ["parent_activity_id", 270], ["created_at", "2021-06-01 16:58:43.949373"], ["updated_at", "2021-06-01 16:58:43.949373"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 276], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.950629"], ["updated_at", "2021-06-01 16:58:43.950629"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 276], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:43.950629"], ["updated_at", "2021-06-01 16:58:43.950629"], ["id", 196], ["id", 196]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a30e7e21-51e1-46c3-bc1d-b2ea8c585491' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "a30e7e21-51e1-46c3-bc1d-b2ea8c585491"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.955189"], ["updated_at", "2021-06-01 16:58:43.955189"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 196], ["rule_id", 252], ["created_at", "2021-06-01 16:58:43.956208"], ["updated_at", "2021-06-01 16:58:43.956208"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'dc4c6eaa-2927-4402-97ff-94131de32022' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "dc4c6eaa-2927-4402-97ff-94131de32022"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.959873"], ["updated_at", "2021-06-01 16:58:43.959873"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 196], ["rule_id", 253], ["created_at", "2021-06-01 16:58:43.960791"], ["updated_at", "2021-06-01 16:58:43.960791"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'acecc55c-ecf7-430a-a9b8-ef3fc9991e55' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "acecc55c-ecf7-430a-a9b8-ef3fc9991e55"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:43.964038"], ["updated_at", "2021-06-01 16:58:43.964038"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 196], ["rule_id", 254], ["created_at", "2021-06-01 16:58:43.965042"], ["updated_at", "2021-06-01 16:58:43.965042"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 252 LIMIT 1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1[0m  [["prompt_id", 196]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 252]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 253]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 254]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label1"], ["rule_id", 252], ["created_at", "2021-06-01 16:58:43.971658"], ["updated_at", "2021-06-01 16:58:43.971658"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 253 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label2"], ["rule_id", 253], ["created_at", "2021-06-01 16:58:43.982446"], ["updated_at", "2021-06-01 16:58:43.982446"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 254 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "label3"], ["rule_id", 254], ["created_at", "2021-06-01 16:58:43.984650"], ["updated_at", "2021-06-01 16:58:43.984650"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-32' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-32"], ["name", "AutoML-Model-Name"], ["prompt_id", 196], ["state", "inactive"], ["labels", "{label1,label2}"], ["created_at", "2021-06-01 16:58:43.986531"], ["updated_at", "2021-06-01 16:58:43.986531"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1  [["prompt_id", 196]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 196], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 252]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 253]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 254]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-32' AND "comprehension_automl_models"."id" != 66) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_automl_models" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_automl_models"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.990557"], ["id", 66]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 196], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 252]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 252 AND "comprehension_labels"."id" != 50) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'a30e7e21-51e1-46c3-bc1d-b2ea8c585491' AND "comprehension_rules"."id" != 252) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.994178"], ["id", 252]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 253]]
  [1m[36mComprehension::Label Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 253 AND "comprehension_labels"."id" != 51) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'dc4c6eaa-2927-4402-97ff-94131de32022' AND "comprehension_rules"."id" != 253) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-06-01 16:58:43.997587"], ["id", 253]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 254]]
  [1m[36mComprehension::Label Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 254 AND "comprehension_labels"."id" != 52) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'acecc55c-ecf7-430a-a9b8-ef3fc9991e55' AND "comprehension_rules"."id" != 254) LIMIT 1
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 252]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 253]]
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 196], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.2ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 252]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 253]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 254]]
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-32' AND "comprehension_automl_models"."id" != 66) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #activate should not change state of anything if activate fails. 
--------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 128"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 128"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 271 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 128"], ["name", "MyString 137"], ["target_level", 1], ["parent_activity_id", 271], ["created_at", "2021-06-01 16:58:44.011511"], ["updated_at", "2021-06-01 16:58:44.011511"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 277], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.012833"], ["updated_at", "2021-06-01 16:58:44.012833"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 277], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.012833"], ["updated_at", "2021-06-01 16:58:44.012833"], ["id", 197], ["id", 197]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '0b763593-477e-4f8f-9570-5051c8f2a066' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "0b763593-477e-4f8f-9570-5051c8f2a066"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.016845"], ["updated_at", "2021-06-01 16:58:44.016845"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 197], ["rule_id", 255], ["created_at", "2021-06-01 16:58:44.017720"], ["updated_at", "2021-06-01 16:58:44.017720"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'fc0180a3-de4d-491a-85ca-b7eb24e4a7cb' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "fc0180a3-de4d-491a-85ca-b7eb24e4a7cb"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.020730"], ["updated_at", "2021-06-01 16:58:44.020730"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 197], ["rule_id", 256], ["created_at", "2021-06-01 16:58:44.021572"], ["updated_at", "2021-06-01 16:58:44.021572"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'e0450cb9-bf51-4051-96fa-53e2a72a1c9e' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "e0450cb9-bf51-4051-96fa-53e2a72a1c9e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.024425"], ["updated_at", "2021-06-01 16:58:44.024425"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 197], ["rule_id", 257], ["created_at", "2021-06-01 16:58:44.025284"], ["updated_at", "2021-06-01 16:58:44.025284"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 255 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 197]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 255]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 256]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 257]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 255], ["created_at", "2021-06-01 16:58:44.029014"], ["updated_at", "2021-06-01 16:58:44.029014"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 256 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label2"], ["rule_id", 256], ["created_at", "2021-06-01 16:58:44.031336"], ["updated_at", "2021-06-01 16:58:44.031336"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 257 LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label3"], ["rule_id", 257], ["created_at", "2021-06-01 16:58:44.034315"], ["updated_at", "2021-06-01 16:58:44.034315"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 255 AND "comprehension_labels"."id" != 53) LIMIT 1[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = '0b763593-477e-4f8f-9570-5051c8f2a066' AND "comprehension_rules"."id" != 255) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3[0m  [["state", "active"], ["updated_at", "2021-06-01 16:58:44.038805"], ["id", 255]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Label Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_labels" WHERE ("comprehension_labels"."rule_id" = 256 AND "comprehension_labels"."id" != 54) LIMIT 1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE ("comprehension_rules"."uid" = 'fc0180a3-de4d-491a-85ca-b7eb24e4a7cb' AND "comprehension_rules"."id" != 256) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "comprehension_rules" SET "state" = $1, "updated_at" = $2 WHERE "comprehension_rules"."id" = $3  [["state", "active"], ["updated_at", "2021-06-01 16:58:44.041743"], ["id", 256]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.4ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2[0m  [["prompt_id", 197], ["rule_type", "autoML"]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 255]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 256]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 257]]
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-33' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-33"], ["name", "AutoML-Model-Name"], ["prompt_id", 197], ["state", "active"], ["labels", "{label1,label2}"], ["created_at", "2021-06-01 16:58:44.048349"], ["updated_at", "2021-06-01 16:58:44.048349"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-34' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-34"], ["name", "AutoML-Model-Name"], ["prompt_id", 197], ["state", "inactive"], ["labels", "{no_rule_for_label}"], ["created_at", "2021-06-01 16:58:44.050775"], ["updated_at", "2021-06-01 16:58:44.050775"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_automl_models" SET "state" = 'inactive' WHERE "comprehension_automl_models"."prompt_id" = $1[0m  [["prompt_id", 197]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 197], ["rule_type", "autoML"]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 255]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 256]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 257]]
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-34' AND "comprehension_automl_models"."id" != 68) LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.1ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 67]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1[0m  [["id", 255]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."id" = $1 LIMIT 1  [["id", 256]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #forbid_automl_model_id_change should not allow automl_model_id to change after create. 
-------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 129"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 129"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 272 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 129"], ["name", "MyString 138"], ["target_level", 1], ["parent_activity_id", 272], ["created_at", "2021-06-01 16:58:44.060830"], ["updated_at", "2021-06-01 16:58:44.060830"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 278], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.062409"], ["updated_at", "2021-06-01 16:58:44.062409"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 278], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.062409"], ["updated_at", "2021-06-01 16:58:44.062409"], ["id", 198], ["id", 198]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'automl_id' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "automl_id"], ["name", "AutoML-Model-Name"], ["prompt_id", 198], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.066151"], ["updated_at", "2021-06-01 16:58:44.066151"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'some new value' AND "comprehension_automl_models"."id" != 69) LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2[0m  [["updated_at", "2021-06-01 16:58:44.069293"], ["id", 69]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Load (0.3ms)[0m  [1mSELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1[0m  [["id", 69]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #forbid_labels_change should not allow labels to change after create. 
-------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 130"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 130"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 273 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 130"], ["name", "MyString 139"], ["target_level", 1], ["parent_activity_id", 273], ["created_at", "2021-06-01 16:58:44.077056"], ["updated_at", "2021-06-01 16:58:44.077056"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 279], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.079361"], ["updated_at", "2021-06-01 16:58:44.079361"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 279], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.079361"], ["updated_at", "2021-06-01 16:58:44.079361"], ["id", 199], ["id", 199]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-35' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-35"], ["name", "AutoML-Model-Name"], ["prompt_id", 199], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.082626"], ["updated_at", "2021-06-01 16:58:44.082626"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-35' AND "comprehension_automl_models"."id" != 70) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_automl_models" SET "updated_at" = $1 WHERE "comprehension_automl_models"."id" = $2  [["updated_at", "2021-06-01 16:58:44.084139"], ["id", 70]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Load (0.1ms)[0m  SELECT  "comprehension_automl_models".* FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."id" = $1 LIMIT 1  [["id", 70]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #state_can_be_active should validate state = active if labels_have_associated_rules is true. 
------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 131"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 131"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 274 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 131"], ["name", "MyString 140"], ["target_level", 1], ["parent_activity_id", 274], ["created_at", "2021-06-01 16:58:44.089027"], ["updated_at", "2021-06-01 16:58:44.089027"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 280], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.090312"], ["updated_at", "2021-06-01 16:58:44.090312"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 280], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.090312"], ["updated_at", "2021-06-01 16:58:44.090312"], ["id", 200], ["id", 200]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-36' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-36"], ["name", "AutoML-Model-Name"], ["prompt_id", 200], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.093430"], ["updated_at", "2021-06-01 16:58:44.093430"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-36' AND "comprehension_automl_models"."id" != 71) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations validate labels should not be valid if labels is empty. 
-----------------------------------------------------------------------------------------------------------
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-37' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #labels_have_associated_rules? should be true if there are matching labels tied to the same prompt as the automl_model. 
---------------------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.2ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.2ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 133"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 133"]]
  [1m[36mComprehension::Activity Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 275 LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 133"], ["name", "MyString 142"], ["target_level", 1], ["parent_activity_id", 275], ["created_at", "2021-06-01 16:58:44.106141"], ["updated_at", "2021-06-01 16:58:44.106141"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 281], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.108341"], ["updated_at", "2021-06-01 16:58:44.108341"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 281], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.108341"], ["updated_at", "2021-06-01 16:58:44.108341"], ["id", 201], ["id", 201]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-38' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-38"], ["name", "AutoML-Model-Name"], ["prompt_id", 201], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.111636"], ["updated_at", "2021-06-01 16:58:44.111636"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 134"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 134"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 276 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 134"], ["name", "MyString 143"], ["target_level", 1], ["parent_activity_id", 276], ["created_at", "2021-06-01 16:58:44.115190"], ["updated_at", "2021-06-01 16:58:44.115190"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 282], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.116447"], ["updated_at", "2021-06-01 16:58:44.116447"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 282], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.116447"], ["updated_at", "2021-06-01 16:58:44.116447"], ["id", 202], ["id", 202]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '900093dd-2630-4b3e-aef5-c36fd0318944' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "900093dd-2630-4b3e-aef5-c36fd0318944"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "autoML"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.120694"], ["updated_at", "2021-06-01 16:58:44.120694"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 202], ["rule_id", 258], ["created_at", "2021-06-01 16:58:44.121629"], ["updated_at", "2021-06-01 16:58:44.121629"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Label Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = 258 LIMIT 1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1  [["prompt_id", 202]]
  [1m[36mComprehension::Label Load (0.1ms)[0m  [1mSELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1[0m  [["rule_id", 258]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_labels" ("name", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["name", "label1"], ["rule_id", 258], ["created_at", "2021-06-01 16:58:44.124751"], ["updated_at", "2021-06-01 16:58:44.124751"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  [["prompt_id", 201], ["rule_type", "autoML"]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #serializable_hash should serialize into the expected shape. 
----------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 135"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 135"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 277 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 135"], ["name", "MyString 144"], ["target_level", 1], ["parent_activity_id", 277], ["created_at", "2021-06-01 16:58:44.129857"], ["updated_at", "2021-06-01 16:58:44.129857"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 283], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.131488"], ["updated_at", "2021-06-01 16:58:44.131488"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 283], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.131488"], ["updated_at", "2021-06-01 16:58:44.131488"], ["id", 203], ["id", 203]]
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.7ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-39' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-39"], ["name", "AutoML-Model-Name"], ["prompt_id", 203], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.139262"], ["updated_at", "2021-06-01 16:58:44.139262"]]
  [1m[35m (0.5ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:44.139262')[0m  [["prompt_id", 203]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: relationships should belong to prompt. 
------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #older_models should be 0 if there are no previous models for the prompt. 
-----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 136"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 136"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 278 LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 136"], ["name", "MyString 145"], ["target_level", 1], ["parent_activity_id", 278], ["created_at", "2021-06-01 16:58:44.152339"], ["updated_at", "2021-06-01 16:58:44.152339"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 284], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.153653"], ["updated_at", "2021-06-01 16:58:44.153653"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.1ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 284], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.153653"], ["updated_at", "2021-06-01 16:58:44.153653"], ["id", 204], ["id", 204]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-40' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-40"], ["name", "AutoML-Model-Name"], ["prompt_id", 204], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.156408"], ["updated_at", "2021-06-01 16:58:44.156408"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."prompt_id" = $1 AND (created_at < '2021-06-01 16:58:44.156408')  [["prompt_id", 204]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: validations #state_can_be_active should not validate state = active if labels_have_associated_rules is false. 
-----------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 137"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 137"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 279 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 137"], ["name", "MyString 146"], ["target_level", 1], ["parent_activity_id", 279], ["created_at", "2021-06-01 16:58:44.161507"], ["updated_at", "2021-06-01 16:58:44.161507"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 285], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.162915"], ["updated_at", "2021-06-01 16:58:44.162915"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 285], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.162915"], ["updated_at", "2021-06-01 16:58:44.162915"], ["id", 205], ["id", 205]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::AutomlModel Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-41' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["automl_model_id", "MODEL-ID-41"], ["name", "AutoML-Model-Name"], ["prompt_id", 205], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.166942"], ["updated_at", "2021-06-01 16:58:44.166942"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE ("comprehension_automl_models"."automl_model_id" = 'MODEL-ID-41' AND "comprehension_automl_models"."id" != 75) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------------------------------------------------------------------------------
Comprehension::AutomlModelTest: test_: #automl_model_full_id should call model_path on the automl_client with specified values. 
--------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 138"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 138"]]
  [1m[35mComprehension::Activity Exists (0.6ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 280 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 138"], ["name", "MyString 147"], ["target_level", 1], ["parent_activity_id", 280], ["created_at", "2021-06-01 16:58:44.176641"], ["updated_at", "2021-06-01 16:58:44.176641"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 286], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.178885"], ["updated_at", "2021-06-01 16:58:44.178885"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 286], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.178885"], ["updated_at", "2021-06-01 16:58:44.178885"], ["id", 206], ["id", 206]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::AutomlModel Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_automl_models" WHERE "comprehension_automl_models"."automl_model_id" = 'MODEL-ID-42' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_automl_models" ("automl_model_id", "name", "prompt_id", "state", "labels", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["automl_model_id", "MODEL-ID-42"], ["name", "AutoML-Model-Name"], ["prompt_id", 206], ["state", "inactive"], ["labels", "{label1}"], ["created_at", "2021-06-01 16:58:44.182155"], ["updated_at", "2021-06-01 16:58:44.182155"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should validate that :case_sensitive is either ‹true› or ‹false›. 
-------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should validate that :regex_text cannot be empty/falsy. 
---------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should validate that the length of :regex_text is at most 200. 
----------------------------------------------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should validate that :sequence_type is either ‹"incorrect"› or ‹"required"›. 
------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: validations should validate that :rule cannot be empty/falsy. 
---------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: custom validations should validate the presence of "case_sensitive". 
----------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'abcf0787-a94e-4039-b16e-56bc1b56aca8' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "abcf0787-a94e-4039-b16e-56bc1b56aca8"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.197825"], ["updated_at", "2021-06-01 16:58:44.197825"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 259], ["regex_text", "test regex"], ["case_sensitive", "t"], ["created_at", "2021-06-01 16:58:44.200233"], ["updated_at", "2021-06-01 16:58:44.200233"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: custom validations should not override a "case_sensitive" with the default if one is provided. 
------------------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'a91ff9a4-dea9-411a-bf94-e460a8534963' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "a91ff9a4-dea9-411a-bf94-e460a8534963"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.215746"], ["updated_at", "2021-06-01 16:58:44.215746"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 260], ["regex_text", "test regex"], ["case_sensitive", "t"], ["created_at", "2021-06-01 16:58:44.217273"], ["updated_at", "2021-06-01 16:58:44.217273"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 260], ["regex_text", "test regex"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:44.218534"], ["updated_at", "2021-06-01 16:58:44.218534"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: relationships should belong to rule. 
--------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------------------------------------------
Comprehension::RegexRuleTest: test_: custom validations should provide a default value for "case_sensitive". 
-------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ce21a9eb-258e-4a30-8541-ef44863d2c44' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "ce21a9eb-258e-4a30-8541-ef44863d2c44"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.221934"], ["updated_at", "2021-06-01 16:58:44.221934"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 261], ["regex_text", "test regex"], ["case_sensitive", "t"], ["created_at", "2021-06-01 16:58:44.223893"], ["updated_at", "2021-06-01 16:58:44.223893"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismCheckTest: test_: #feedback_object should return appropriate feedback when there is no plagiarism. 
----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'ca430e67-00a6-4442-b9ef-1dd0896a39ee' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "ca430e67-00a6-4442-b9ef-1dd0896a39ee"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.227779"], ["updated_at", "2021-06-01 16:58:44.227779"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '91c4a935-101e-472c-a9e7-3cd616f9557d' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "91c4a935-101e-472c-a9e7-3cd616f9557d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "t"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.231316"], ["updated_at", "2021-06-01 16:58:44.231316"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.3ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["optimal", "t"], ["rule_type", "plagiarism"]]
  [1m[36m (0.3ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 263]]
  [1m[35mComprehension::PlagiarismText Load (0.2ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 263]]
  [1m[36mComprehension::Feedback Load (0.3ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 263]]
  [1m[35mComprehension::Label Load (0.2ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 263]]
  [1m[36mComprehension::RegexRule Load (0.4ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 263]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismCheckTest: test_: #feedback_object should return appropriate feedback attributes if there is plagiarism. 
----------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4c14c35c-300b-4dcf-be66-0cf14840dc5b' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "4c14c35c-300b-4dcf-be66-0cf14840dc5b"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.243185"], ["updated_at", "2021-06-01 16:58:44.243185"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------------------------------------------------------
Comprehension::PlagiarismCheckTest: test_: #feedback_object should not be plagiarized if the plagiarism word phrase is under the match minimum. 
------------------------------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'df7e27ab-c3dd-416c-af0a-68fe8a3e7321' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "df7e27ab-c3dd-416c-af0a-68fe8a3e7321"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.247603"], ["updated_at", "2021-06-01 16:58:44.247603"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b78e3143-03ae-4ff2-98e2-52c7e7d9dd60' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "b78e3143-03ae-4ff2-98e2-52c7e7d9dd60"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "plagiarism"], ["optimal", "t"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.250559"], ["updated_at", "2021-06-01 16:58:44.250559"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1  [["optimal", "t"], ["rule_type", "plagiarism"]]
  [1m[36m (0.1ms)[0m  [1mSELECT "comprehension_prompts".id FROM "comprehension_prompts" INNER JOIN "comprehension_prompts_rules" ON "comprehension_prompts"."id" = "comprehension_prompts_rules"."prompt_id" WHERE "comprehension_prompts_rules"."rule_id" = $1[0m  [["rule_id", 266]]
  [1m[35mComprehension::PlagiarismText Load (0.1ms)[0m  SELECT  "comprehension_plagiarism_texts".* FROM "comprehension_plagiarism_texts" WHERE "comprehension_plagiarism_texts"."rule_id" = $1 LIMIT 1  [["rule_id", 266]]
  [1m[36mComprehension::Feedback Load (0.1ms)[0m  [1mSELECT "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1[0m  [["rule_id", 266]]
  [1m[35mComprehension::Label Load (0.1ms)[0m  SELECT  "comprehension_labels".* FROM "comprehension_labels" WHERE "comprehension_labels"."rule_id" = $1 LIMIT 1  [["rule_id", 266]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 266]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #feedback_object should be false when there is a regex match. 
----------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.1ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.1ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 139"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 139"]]
  [1m[35mComprehension::Activity Exists (0.2ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 281 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 139"], ["name", "MyString 148"], ["target_level", 1], ["parent_activity_id", 281], ["created_at", "2021-06-01 16:58:44.258936"], ["updated_at", "2021-06-01 16:58:44.258936"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 287], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.260378"], ["updated_at", "2021-06-01 16:58:44.260378"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 287], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.260378"], ["updated_at", "2021-06-01 16:58:44.260378"], ["id", 207], ["id", 207]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6cf9d40e-f80b-45ab-99a3-32195f35f653' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "6cf9d40e-f80b-45ab-99a3-32195f35f653"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.265423"], ["updated_at", "2021-06-01 16:58:44.265423"]]
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 207], ["rule_id", 267], ["created_at", "2021-06-01 16:58:44.267127"], ["updated_at", "2021-06-01 16:58:44.267127"]]
  [1m[35m (0.5ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 267], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:44.273913"], ["updated_at", "2021-06-01 16:58:44.273913"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 17 AND "comprehension_feedbacks"."rule_id" = 267) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 267], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 17], ["created_at", "2021-06-01 16:58:44.280989"], ["updated_at", "2021-06-01 16:58:44.280989"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.6ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 207], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 267]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1  [["rule_id", 267]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #feedback_object should return optimal blank feedback when there is no regex match. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 140"]]
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 140"]]
  [1m[36mComprehension::Activity Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 282 LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 140"], ["name", "MyString 149"], ["target_level", 1], ["parent_activity_id", 282], ["created_at", "2021-06-01 16:58:44.289763"], ["updated_at", "2021-06-01 16:58:44.289763"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 288], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.291056"], ["updated_at", "2021-06-01 16:58:44.291056"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 288], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.291056"], ["updated_at", "2021-06-01 16:58:44.291056"], ["id", 208], ["id", 208]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '6c71820f-ed09-4e36-ac06-26549baa3b0a' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "6c71820f-ed09-4e36-ac06-26549baa3b0a"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.295315"], ["updated_at", "2021-06-01 16:58:44.295315"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 208], ["rule_id", 268], ["created_at", "2021-06-01 16:58:44.296359"], ["updated_at", "2021-06-01 16:58:44.296359"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 268], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:44.298446"], ["updated_at", "2021-06-01 16:58:44.298446"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.4ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 18 AND "comprehension_feedbacks"."rule_id" = 268) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 268], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 18], ["created_at", "2021-06-01 16:58:44.302067"], ["updated_at", "2021-06-01 16:58:44.302067"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.5ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = '4a2774eb-5a5c-4c90-a0ca-760a6be6f34f' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "4a2774eb-5a5c-4c90-a0ca-760a6be6f34f"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "t"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.308122"], ["updated_at", "2021-06-01 16:58:44.308122"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Load (0.3ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 208], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.2ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 268]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 208], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 268]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 208], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 268]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC[0m  [["prompt_id", 208], ["rule_type", "rules-based-1"]]
  [1m[35mComprehension::RegexRule Load (0.1ms)[0m  SELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1  [["rule_id", 268]]
  [1m[36mComprehension::Rule Load (0.2ms)[0m  [1mSELECT  "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."optimal" = $1 AND "comprehension_rules"."rule_type" = $2 LIMIT 1[0m  [["optimal", "t"], ["rule_type", "rules-based-1"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #feedback_object should return the highest priority feedback when two feedbacks exist. 
-----------------------------------------------------------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mActivityClassification Load (0.2ms)[0m  [1mSELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1[0m  [["key", "comprehension"]]
  [1m[35mActivity Load (0.2ms)[0m  SELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1  [["name", "MyString 141"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"[0m  [["name", "MyString 141"]]
  [1m[35mComprehension::Activity Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 283 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["title", "MyString 141"], ["name", "MyString 150"], ["target_level", 1], ["parent_activity_id", 283], ["created_at", "2021-06-01 16:58:44.321640"], ["updated_at", "2021-06-01 16:58:44.321640"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["activity_id", 289], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.323242"], ["updated_at", "2021-06-01 16:58:44.323242"]]
  [1m[36mComprehension::Rule Load (0.1ms)[0m  [1mSELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1[0m  [["universal", "t"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9  [["activity_id", 289], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.323242"], ["updated_at", "2021-06-01 16:58:44.323242"], ["id", 209], ["id", 209]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'c7d8c280-d89b-4023-8040-122c4b8c0e2e' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "c7d8c280-d89b-4023-8040-122c4b8c0e2e"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.328160"], ["updated_at", "2021-06-01 16:58:44.328160"]]
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 209], ["rule_id", 270], ["created_at", "2021-06-01 16:58:44.329187"], ["updated_at", "2021-06-01 16:58:44.329187"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 270], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:44.331014"], ["updated_at", "2021-06-01 16:58:44.331014"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Feedback Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 19 AND "comprehension_feedbacks"."rule_id" = 270) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["rule_id", 270], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 19], ["created_at", "2021-06-01 16:58:44.334373"], ["updated_at", "2021-06-01 16:58:44.334373"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mComprehension::Rule Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'f3a91e71-a58f-445d-8465-acf44cbc5e51' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["uid", "f3a91e71-a58f-445d-8465-acf44cbc5e51"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 1], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.340905"], ["updated_at", "2021-06-01 16:58:44.340905"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["prompt_id", 209], ["rule_id", 271], ["created_at", "2021-06-01 16:58:44.342558"], ["updated_at", "2021-06-01 16:58:44.342558"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["rule_id", 271], ["regex_text", "^Testing"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:44.345500"], ["updated_at", "2021-06-01 16:58:44.345500"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Load (0.2ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" INNER JOIN "comprehension_prompts_rules" ON "comprehension_rules"."id" = "comprehension_prompts_rules"."rule_id" WHERE "comprehension_prompts_rules"."prompt_id" = $1 AND "comprehension_rules"."rule_type" = $2  ORDER BY "comprehension_rules"."suborder" ASC  [["prompt_id", 209], ["rule_type", "rules-based-1"]]
  [1m[36mComprehension::RegexRule Load (0.1ms)[0m  [1mSELECT "comprehension_regex_rules".* FROM "comprehension_regex_rules" WHERE "comprehension_regex_rules"."rule_id" = $1[0m  [["rule_id", 270]]
  [1m[35mComprehension::Feedback Load (0.2ms)[0m  SELECT  "comprehension_feedbacks".* FROM "comprehension_feedbacks" WHERE "comprehension_feedbacks"."rule_id" = $1  ORDER BY "comprehension_feedbacks"."id" ASC LIMIT 1  [["rule_id", 270]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------------------------------------------------------------------------
Comprehension::RegexCheckTest: test_: #initialize should should have working accessor methods for all initialized fields. 
--------------------------------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mActivityClassification Load (0.1ms)[0m  SELECT  "activity_classifications".* FROM "activity_classifications" WHERE "activity_classifications"."key" = $1 LIMIT 1  [["key", "comprehension"]]
  [1m[36mActivity Load (0.1ms)[0m  [1mSELECT  "activities".* FROM "activities" WHERE "activities"."name" = $1 AND "activities"."activity_classification_id" IS NULL LIMIT 1[0m  [["name", "MyString 142"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "activities" ("name") VALUES ($1) RETURNING "id"  [["name", "MyString 142"]]
  [1m[36mComprehension::Activity Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "comprehension_activities" WHERE "comprehension_activities"."parent_activity_id" = 284 LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "comprehension_activities" ("title", "name", "target_level", "parent_activity_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["title", "MyString 142"], ["name", "MyString 151"], ["target_level", 1], ["parent_activity_id", 284], ["created_at", "2021-06-01 16:58:44.352284"], ["updated_at", "2021-06-01 16:58:44.352284"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "comprehension_prompts" ("activity_id", "conjunction", "text", "max_attempts_feedback", "max_attempts", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["activity_id", 290], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.353660"], ["updated_at", "2021-06-01 16:58:44.353660"]]
  [1m[35mComprehension::Rule Load (0.1ms)[0m  SELECT "comprehension_rules".* FROM "comprehension_rules" WHERE "comprehension_rules"."universal" = $1  [["universal", "t"]]
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "comprehension_prompts" SET "activity_id" = $1, "conjunction" = $2, "text" = $3, "max_attempts_feedback" = $4, "max_attempts" = $5, "created_at" = $6, "updated_at" = $7, "id" = $8 WHERE "comprehension_prompts"."id" = $9[0m  [["activity_id", 290], ["conjunction", "because"], ["text", "my text would go here."], ["max_attempts_feedback", "MyText"], ["max_attempts", 5], ["created_at", "2021-06-01 16:58:44.353660"], ["updated_at", "2021-06-01 16:58:44.353660"], ["id", 210], ["id", 210]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Rule Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_rules" WHERE "comprehension_rules"."uid" = 'b7fd0e20-2f73-4003-a70a-86c6472c194d' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_rules" ("uid", "name", "note", "universal", "rule_type", "optimal", "state", "suborder", "concept_uid", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["uid", "b7fd0e20-2f73-4003-a70a-86c6472c194d"], ["name", "Test Rule"], ["note", "This rule is a test"], ["universal", "f"], ["rule_type", "rules-based-1"], ["optimal", "f"], ["state", "inactive"], ["suborder", 0], ["concept_uid", "ConceptUID"], ["created_at", "2021-06-01 16:58:44.357892"], ["updated_at", "2021-06-01 16:58:44.357892"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "comprehension_prompts_rules" ("prompt_id", "rule_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["prompt_id", 210], ["rule_id", 272], ["created_at", "2021-06-01 16:58:44.359107"], ["updated_at", "2021-06-01 16:58:44.359107"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "comprehension_regex_rules" ("rule_id", "regex_text", "case_sensitive", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["rule_id", 272], ["regex_text", "^Test"], ["case_sensitive", "f"], ["created_at", "2021-06-01 16:58:44.361357"], ["updated_at", "2021-06-01 16:58:44.361357"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mComprehension::Feedback Exists (0.3ms)[0m  SELECT  1 AS one FROM "comprehension_feedbacks" WHERE ("comprehension_feedbacks"."order" = 20 AND "comprehension_feedbacks"."rule_id" = 272) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "comprehension_feedbacks" ("rule_id", "text", "description", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["rule_id", 272], ["text", "This string begins with the word Test!"], ["description", "Test description for test feedback record."], ["order", 20], ["created_at", "2021-06-01 16:58:44.363912"], ["updated_at", "2021-06-01 16:58:44.363912"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
